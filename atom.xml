<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>托尼的技术博客</title>
  
  
  <link href="https://xqtony.github.io/atom.xml" rel="self"/>
  
  <link href="https://xqtony.github.io/"/>
  <updated>2023-05-26T00:31:07.034Z</updated>
  <id>https://xqtony.github.io/</id>
  
  <author>
    <name>Tony Kong</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>区分几个reverse方法</title>
    <link href="https://xqtony.github.io/2023/05/26/reverses/"/>
    <id>https://xqtony.github.io/2023/05/26/reverses/</id>
    <published>2023-05-25T23:24:08.374Z</published>
    <updated>2023-05-26T00:31:07.034Z</updated>
    
    <content type="html"><![CDATA[<p>下列的几个<code>reverse</code>你能分清楚吗？</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Comparator.reversed();</span><br><span class="line">Comparator.reverseOrder();</span><br><span class="line">Collections.reverse();</span><br><span class="line">Collections.reverseOrder();</span><br></pre></td></tr></table></figure><span id="more"></span><p>来看看源码：</p><ol><li><p><code>Comparator.reversed()</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">default</span> Comparator&lt;T&gt; <span class="title function_">reversed</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.reverseOrder(<span class="built_in">this</span>);</span><br></pre></td></tr></table></figure><p>返回一个比较器，强制该比较器的相反顺序。</p></li><li><p><code>Comparator.reverseOrder</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;? <span class="built_in">super</span> T&gt;&gt; Comparator&lt;T&gt; <span class="title function_">reverseOrder</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> Collections.reverseOrder();</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>返回一个与 自然排序相反的比较器。</p></li><li><p><code>Collections.reverse()</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(List&lt;?&gt; list)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> list.size();</span><br><span class="line">    <span class="keyword">if</span> (size &lt; REVERSE_THRESHOLD || list <span class="keyword">instanceof</span> RandomAccess) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>, mid=size&gt;&gt;<span class="number">1</span>, j=size-<span class="number">1</span>; i&lt;mid; i++, j--)</span><br><span class="line">            swap(list, i, j);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">ListIterator</span> <span class="variable">fwd</span> <span class="operator">=</span> list.listIterator();</span><br><span class="line">        <span class="type">ListIterator</span> <span class="variable">rev</span> <span class="operator">=</span> list.listIterator(size);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>, mid=list.size()&gt;&gt;<span class="number">1</span>; i&lt;mid; i++) &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">tmp</span> <span class="operator">=</span> fwd.next();</span><br><span class="line">            fwd.set(rev.previous());</span><br><span class="line">            rev.set(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(List&lt;?&gt; list, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">List</span> <span class="variable">l</span> <span class="operator">=</span> list;</span><br><span class="line">    l.set(i, l.set(j, l.get(i)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此方法反转指定列表中元素的顺序。</p></li><li><p><code>Collections.reverseOrder()</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Comparator&lt;T&gt; <span class="title function_">reverseOrder</span><span class="params">(Comparator&lt;T&gt; cmp)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (cmp == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (Comparator&lt;T&gt;) ReverseComparator.REVERSE_ORDER;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmp == ReverseComparator.REVERSE_ORDER) &#123;</span><br><span class="line">            <span class="keyword">return</span> (Comparator&lt;T&gt;) Comparators.NaturalOrderComparator.INSTANCE;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmp == Comparators.NaturalOrderComparator.INSTANCE) &#123;</span><br><span class="line">            <span class="keyword">return</span> (Comparator&lt;T&gt;) ReverseComparator.REVERSE_ORDER;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmp <span class="keyword">instanceof</span> ReverseComparator2) &#123;</span><br><span class="line">            <span class="keyword">return</span> ((ReverseComparator2&lt;T&gt;) cmp).cmp;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ReverseComparator2</span>&lt;&gt;(cmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>此方法返回一个比较器，它强制指定比较器的反向排序。当不指定比较器的时候，返回<code>ReverseComparator.REVERSE_ORDER</code>。那顺便看下<code>ReverseComparator</code>的实现：</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ReverseComparator</span></span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Comparable&lt;Object&gt;&gt;, Serializable &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@java</span>.io.Serial</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">7207038068494060240L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">ReverseComparator</span> <span class="variable">REVERSE_ORDER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReverseComparator</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Comparable&lt;Object&gt; c1, Comparable&lt;Object&gt; c2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> c2.compareTo(c1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@java</span>.io.Serial</span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span> &#123; <span class="keyword">return</span> Collections.reverseOrder(); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Comparator&lt;Comparable&lt;Object&gt;&gt; <span class="title function_">reversed</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Comparator.naturalOrder();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>可见<code>ReverseComparator.REVERSE_ORDER</code>排序的顺序与自然排序刚好相反。</p><p>总结：</p><ul><li><code>Comparator.reversed()</code>: 无参数。底层调用<code>Collections.reverseOrder(this)</code>。返回一个与调用者比较器相反顺序的新的比较器。</li><li><code>Comparator.reverseOrder()</code>: 无参数。底层调用<code>Collections.reverseOrder()</code>。返回一个与<em>自然排序</em>相反的比较器。</li><li><code>Collections.reverse()</code>: 接受一个List类型参数，反转该List。无返回值。</li><li><code>Collections.reverseOrder()</code>: 无参调用时，返回一个与自然排序相反的比较器；有参调用时，返回与参数相反的比较器。</li></ul><p>参考：</p><p><a href="https://blog.csdn.net/Madoka_Homura/article/details/107382799">Java Comparator使用指南 —- 看这一篇就够了</a><br><a href="https://blog.csdn.net/qq_31635851/article/details/120285642">Java 8 新特性】Java Comparator.reverseOrder | 倒序排序-静态方法</a><br><a href="https://blog.csdn.net/qq_35029061/article/details/86655957">深入学习java源码之Comparator.reverseOrder()与Comparator.compare ()</a><br><a href="https://w3schools.cn/javautil/java_util_collections.html">Java.util.Collections 类</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;下列的几个&lt;code&gt;reverse&lt;/code&gt;你能分清楚吗？&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Comparator.reversed();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Comparator.reverseOrder();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Collections.reverse();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Collections.reverseOrder();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Java高级特性和类库" scheme="https://xqtony.github.io/categories/Java%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E5%92%8C%E7%B1%BB%E5%BA%93/"/>
    
    
    <category term="Java" scheme="https://xqtony.github.io/tags/Java/"/>
    
    <category term="原创" scheme="https://xqtony.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
    <category term="Collections" scheme="https://xqtony.github.io/tags/Collections/"/>
    
    <category term="Comparator" scheme="https://xqtony.github.io/tags/Comparator/"/>
    
    <category term="reverse" scheme="https://xqtony.github.io/tags/reverse/"/>
    
  </entry>
  
  <entry>
    <title>Lambda中比较器Comparator的使用</title>
    <link href="https://xqtony.github.io/2023/05/26/lambda%20in%20Comparator/"/>
    <id>https://xqtony.github.io/2023/05/26/lambda%20in%20Comparator/</id>
    <published>2023-05-25T22:15:31.551Z</published>
    <updated>2023-05-25T23:25:00.229Z</updated>
    
    <content type="html"><![CDATA[<p>如果你赶时间：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list.sort((Developer o1, Developer o2) -&gt; Integer.compare(o1.getAge(), o2.getAge()));   <span class="comment">// 显式类型</span></span><br><span class="line">listDevs.sort((o1, o2) -&gt; Integer.compare(o1.getAge(), o2.getAge()));                   <span class="comment">// 隐式类型，效果一致</span></span><br></pre></td></tr></table></figure><span id="more"></span><h1 id="一、概念"><a href="#一、概念" class="headerlink" title="一、概念"></a>一、概念</h1><p>先来看下典型的比较器示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Developer&gt; byName = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.getName().compareTo(o2.getName()); <span class="comment">// name是String类型</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Java8</code>中引入了<code>Lambda</code>表达式，比较器可以改成下面这样：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Developer&gt; byName = (Developer o1, Developer o2) -&gt; o1.getName().compareTo(o2.getName());</span><br></pre></td></tr></table></figure><p>对于<em>数组</em>，<code>Arrays.sort()</code>提供了传入比较器的重载方法，对于<em>列表</em>，<code>Collections.sort()</code>也提供了传入比较器的重载方法。</p><h1 id="二、使用实例"><a href="#二、使用实例" class="headerlink" title="二、使用实例"></a>二、使用实例</h1><h2 id="2-1-通过new-新建比较器"><a href="#2-1-通过new-新建比较器" class="headerlink" title="2.1 通过new 新建比较器"></a>2.1 通过<code>new</code> 新建比较器</h2><p>假如我们要通过Developer 对象的年龄进行排序，通常情况下我们使用Collections.sort，new个匿名Comparator 类，类似下面这种：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSorting</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Developer&gt; listDevs = getDevelopers();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Before Sort&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Developer developer : listDevs) &#123;</span><br><span class="line">            System.out.println(developer);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//sort by age</span></span><br><span class="line">        Collections.sort(listDevs, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">                <span class="comment">// return o1.getAge() - o2.getAge();</span></span><br><span class="line">                <span class="keyword">return</span> Integer.compare(o1.getAge(), o2.getAge());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;After Sort&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Developer developer : listDevs) &#123;</span><br><span class="line">            System.out.println(developer);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Developer&gt; <span class="title function_">getDevelopers</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Developer&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Developer&gt;();</span><br><span class="line"></span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">Developer</span>(<span class="string">&quot;ricky&quot;</span>, <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;70000&quot;</span>), <span class="number">33</span>));</span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">Developer</span>(<span class="string">&quot;alvin&quot;</span>, <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;80000&quot;</span>), <span class="number">20</span>));</span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">Developer</span>(<span class="string">&quot;jason&quot;</span>, <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;100000&quot;</span>), <span class="number">10</span>));</span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">Developer</span>(<span class="string">&quot;iris&quot;</span>, <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;170000&quot;</span>), <span class="number">55</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Before Sort</span><br><span class="line">Developer [name=ricky, salary=70000, age=33]</span><br><span class="line">Developer [name=alvin, salary=80000, age=20]</span><br><span class="line">Developer [name=jason, salary=100000, age=10]</span><br><span class="line">Developer [name=iris, salary=170000, age=55]</span><br><span class="line"></span><br><span class="line">After Sort</span><br><span class="line">Developer [name=jason, salary=100000, age=10]</span><br><span class="line">Developer [name=alvin, salary=80000, age=20]</span><br><span class="line">Developer [name=ricky, salary=70000, age=33]</span><br><span class="line">Developer [name=iris, salary=170000, age=55]</span><br></pre></td></tr></table></figure><p>当比较规则发生变化时，你需要再次new个匿名Comparator 类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sort by age</span></span><br><span class="line">Collections.sort(listDevs, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">        <span class="comment">// Tony updated: 尽管几乎不可能溢出，但存在这种可能性</span></span><br><span class="line">        <span class="comment">// return o1.getAge() - o2.getAge();</span></span><br><span class="line">        <span class="comment">// 参考这篇博客：https://xqtony.github.io/2023/05/26/compareTo/</span></span><br><span class="line">        <span class="comment">// 应该使用下面的实现方法：</span></span><br><span class="line">        <span class="keyword">return</span> Integer.compare(o1.getAget(), o2.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//sort by name</span></span><br><span class="line">Collections.sort(listDevs, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.getName().compareTo(o2.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//sort by salary</span></span><br><span class="line">Collections.sort(listDevs, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.getSalary().compareTo(o2.getSalary());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>这样也可以，不过你会不会觉得这样有点怪，因为其实不同的只有一行代码而已，但是却需要重复写很多代码？</p><h2 id="2-2-通过Lambda表达式新建比较器"><a href="#2-2-通过Lambda表达式新建比较器" class="headerlink" title="2.2 通过Lambda表达式新建比较器"></a>2.2 通过Lambda表达式新建比较器</h2><p>在<code>java8</code>中，<code>List</code>接口直接提供了排序方法， 所以你不需要使用<code>Collections.sort：</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//List.sort() since Java 8</span></span><br><span class="line">listDevs.sort(<span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">        <span class="comment">// Tony：原文中存在两个问题：</span></span><br><span class="line">        <span class="comment">// 1. 溢出风险</span></span><br><span class="line">        <span class="comment">// 2. 顺序写反了</span></span><br><span class="line">        <span class="comment">// return o2.getAge() - o1.getAge();</span></span><br><span class="line">        <span class="comment">// Tony:</span></span><br><span class="line">        <span class="keyword">return</span> Integer.compare(o1.getAget(), o2.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>Lambda</code>改写：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSorting</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Developer&gt; listDevs = getDevelopers();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Before Sort&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Developer developer : listDevs) &#123;</span><br><span class="line">            System.out.println(developer);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;After Sort&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Tony： 原文使用了下面的实现</span></span><br><span class="line">        <span class="comment">// listDevs.sort((Developer o1, Developer o2)-&gt;o1.getAge()-o2.getAge());</span></span><br><span class="line">        listDevs.sort((Developer o1, Developer o2) -&gt; Integer.compare(o1.getAge(), o2.getAge()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//java 8 lambda feature</span></span><br><span class="line">        listDevs.forEach((developer)-&gt;System.out.println(developer));</span><br><span class="line">        <span class="comment">// Tony注：</span></span><br><span class="line">        <span class="comment">// listDevs.forEach(System.out::println);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Developer&gt; <span class="title function_">getDevelopers</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Developer&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Developer&gt;();</span><br><span class="line"></span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">Developer</span>(<span class="string">&quot;ricky&quot;</span>, <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;70000&quot;</span>), <span class="number">33</span>));</span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">Developer</span>(<span class="string">&quot;alvin&quot;</span>, <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;80000&quot;</span>), <span class="number">20</span>));</span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">Developer</span>(<span class="string">&quot;jason&quot;</span>, <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;100000&quot;</span>), <span class="number">10</span>));</span><br><span class="line">        result.add(<span class="keyword">new</span> <span class="title class_">Developer</span>(<span class="string">&quot;iris&quot;</span>, <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;170000&quot;</span>), <span class="number">55</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Before Sort</span><br><span class="line">Developer [name=ricky, salary=70000, age=33]</span><br><span class="line">Developer [name=alvin, salary=80000, age=20]</span><br><span class="line">Developer [name=jason, salary=100000, age=10]</span><br><span class="line">Developer [name=iris, salary=170000, age=55]</span><br><span class="line"></span><br><span class="line">After Sort</span><br><span class="line">Developer [name=jason, salary=100000, age=10]</span><br><span class="line">Developer [name=alvin, salary=80000, age=20]</span><br><span class="line">Developer [name=ricky, salary=70000, age=33]</span><br><span class="line">Developer [name=iris, salary=170000, age=55]</span><br></pre></td></tr></table></figure><h2 id="2-3-更多的例子"><a href="#2-3-更多的例子" class="headerlink" title="2.3 更多的例子"></a>2.3 更多的例子</h2><p>根据年龄：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//sort by age</span></span><br><span class="line">Collections.sort(listDevs, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">        <span class="comment">// return o1.getAge() - o2.getAge();</span></span><br><span class="line">        <span class="keyword">return</span> Integer.compare(o1.getAget(), o2.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambda</span></span><br><span class="line"><span class="comment">// Tony 注：同样的问题</span></span><br><span class="line"><span class="comment">// listDevs.sort((Developer o1, Developer o2)-&gt;o1.getAge()-o2.getAge());</span></span><br><span class="line">listDevs.sort((Developer o1, Developer o2) -&gt; Integer.compare(o1.getAge(), o2.getAge()));</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambda, valid, parameter type is optional</span></span><br><span class="line"><span class="comment">// Tony 注：同样的问题</span></span><br><span class="line"><span class="comment">// listDevs.sort((o1, o2)-&gt;o1.getAge()-o2.getAge());</span></span><br><span class="line">listDevs.sort((o1, o2) -&gt; Integer.compare(o1.getAge(), o2.getAge()));</span><br></pre></td></tr></table></figure><p>根据名字：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sort by name</span></span><br><span class="line">Collections.sort(listDevs, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.getName().compareTo(o2.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambda</span></span><br><span class="line">listDevs.sort((Developer o1, Developer o2)-&gt;o1.getName().compareTo(o2.getName()));</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambda</span></span><br><span class="line">listDevs.sort((o1, o2)-&gt;o1.getName().compareTo(o2.getName()));</span><br></pre></td></tr></table></figure><p>根据薪水：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sort by salary</span></span><br><span class="line">Collections.sort(listDevs, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Developer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Developer o1, Developer o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.getSalary().compareTo(o2.getSalary());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambda</span></span><br><span class="line"><span class="comment">// Tony注：使用compareTo()同样可以，本质上底层还是在调用compare()方法</span></span><br><span class="line">listDevs.sort((Developer o1, Developer o2)-&gt;o1.getSalary().compareTo(o2.getSalary()));</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambda</span></span><br><span class="line">listDevs.sort((o1, o2)-&gt;o1.getSalary().compareTo(o2.getSalary()))</span><br></pre></td></tr></table></figure><p>从小到大排序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Developer&gt; salaryComparator = (o1, o2)-&gt;o1.getSalary().compareTo(o2.getSalary());</span><br><span class="line">listDevs.sort(salaryComparator);</span><br></pre></td></tr></table></figure><p>从大到小倒序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Developer&gt; salaryComparator = (o1, o2)-&gt;o1.getSalary().compareTo(o2.getSalary());</span><br><span class="line">listDevs.sort(salaryComparator.reversed());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tony 注：掘金版本给出了下面的实现：</span></span><br><span class="line"><span class="comment">// Comparator&lt;Developer&gt; salaryComparator = (o1, o2)-&gt;o2.getSalary().compareTo(o1.getSalary());</span></span><br><span class="line"><span class="comment">// 但是实际上根据Comparator接口中compare函数的定义，当o1的值小于o2，应该返回负值。因此上面这行的实现违反设计原则的，并不推荐。</span></span><br></pre></td></tr></table></figure><p>本文虽然大部分是转载，但关于<code>Integer</code>类型的数值比较防止溢出问题，以及对<code>compare()</code>方法的设计均有重要注解，因此归类为二创。</p><p>参考：<br><a href="https://blog.csdn.net/u014042066/article/details/76248692">java8-Lambda中比较器Comparator的使用 - CSDN</a><br><a href="https://juejin.cn/post/6898898464252690446">java8-Lambda中比较器Comparator的使用 - 掘金</a><br><a href="https://blog.csdn.net/y506798278/article/details/104503588">Java8 Lambda表达式（二）System.out::println与Lambda表达式</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;如果你赶时间：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;list.sort((Developer o1, Developer o2) -&amp;gt; Integer.compare(o1.getAge(), o2.getAge()));   &lt;span class=&quot;comment&quot;&gt;// 显式类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;listDevs.sort((o1, o2) -&amp;gt; Integer.compare(o1.getAge(), o2.getAge()));                   &lt;span class=&quot;comment&quot;&gt;// 隐式类型，效果一致&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Java高级特性和类库" scheme="https://xqtony.github.io/categories/Java%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E5%92%8C%E7%B1%BB%E5%BA%93/"/>
    
    
    <category term="compare" scheme="https://xqtony.github.io/tags/compare/"/>
    
    <category term="Java" scheme="https://xqtony.github.io/tags/Java/"/>
    
    <category term="二创" scheme="https://xqtony.github.io/tags/%E4%BA%8C%E5%88%9B/"/>
    
    <category term="Comparator" scheme="https://xqtony.github.io/tags/Comparator/"/>
    
    <category term="Lambda" scheme="https://xqtony.github.io/tags/Lambda/"/>
    
  </entry>
  
  <entry>
    <title>比较Collections.sort()与Arrays.sort()</title>
    <link href="https://xqtony.github.io/2023/05/26/two%20sort/"/>
    <id>https://xqtony.github.io/2023/05/26/two%20sort/</id>
    <published>2023-05-25T22:04:40.531Z</published>
    <updated>2023-05-25T23:23:52.420Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Collections-sort-与-Arrays-sort-的异同？"><a href="#Collections-sort-与-Arrays-sort-的异同？" class="headerlink" title="Collections.sort() 与 Arrays.sort() 的异同？"></a><code>Collections.sort()</code> 与 <code>Arrays.sort()</code> 的异同？</h1><p><code>Collections.sort()</code> 和 <code>Arrays.sort()</code> 都是 Java 中用于排序的方法，它们的异同如下：</p><span id="more"></span><ol><li><p>参数类型不同：<code>Collections.sort()</code> 方法接受 List 类型的参数，而 <code>Arrays.sort()</code> 方法接受数组类型的参数。</p></li><li><p>底层实现不同：<code>Collections.sort()</code> 方法使用的是归并排序（Merge Sort）算法，而 <code>Arrays.sort()</code> 方法使用的是快速排序（Quick Sort）算法。</p></li><li><p>排序稳定性不同：<code>Collections.sort()</code> 方法是稳定排序，即对于相等的元素，排序前后它们的相对位置不会发生改变。而 <code>Arrays.sort()</code> 方法是不稳定排序，即对于相等的元素，排序前后它们的相对位置可能会发生改变。</p></li><li><p>性能表现不同：<code>Arrays.sort()</code> 方法在大多数情况下比 <code>Collections.sort()</code> 方法性能更好，因为它对原始数据进行排序，不需要进行额外的包装和拆包操作。</p></li></ol><p>综上所述，如果需要对 List 进行排序，应该使用 <code>Collections.sort()</code> 方法；而如果需要对数组进行排序，应该使用 <code>Arrays.sort()</code> 方法。</p><p>但需要注意的是，<code>Arrays.sort()</code> 方法和<code>Collections.sort()</code> 方法在排序时都可能会改变原始对象内元素的顺序，所以在使用前需要备份。</p><p>另外注意，使用<code>Collections.sort()</code>时，被排序列表中的元素必须实现<code>Comparable</code>接口中的<code>compareTo</code>方法。</p><p>参考：<br><a href="https://blog.csdn.net/qq_23179075/article/details/78753136">Java中Collections.sort()的使用!</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Collections-sort-与-Arrays-sort-的异同？&quot;&gt;&lt;a href=&quot;#Collections-sort-与-Arrays-sort-的异同？&quot; class=&quot;headerlink&quot; title=&quot;Collections.sort() 与 Arrays.sort() 的异同？&quot;&gt;&lt;/a&gt;&lt;code&gt;Collections.sort()&lt;/code&gt; 与 &lt;code&gt;Arrays.sort()&lt;/code&gt; 的异同？&lt;/h1&gt;&lt;p&gt;&lt;code&gt;Collections.sort()&lt;/code&gt; 和 &lt;code&gt;Arrays.sort()&lt;/code&gt; 都是 Java 中用于排序的方法，它们的异同如下：&lt;/p&gt;</summary>
    
    
    
    <category term="Java高级特性和类库" scheme="https://xqtony.github.io/categories/Java%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E5%92%8C%E7%B1%BB%E5%BA%93/"/>
    
    
    <category term="Java" scheme="https://xqtony.github.io/tags/Java/"/>
    
    <category term="Collections" scheme="https://xqtony.github.io/tags/Collections/"/>
    
    <category term="Arrays" scheme="https://xqtony.github.io/tags/Arrays/"/>
    
    <category term="sort" scheme="https://xqtony.github.io/tags/sort/"/>
    
    <category term="AI辅助创作" scheme="https://xqtony.github.io/tags/AI%E8%BE%85%E5%8A%A9%E5%88%9B%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>比较Comparator与Comparable接口</title>
    <link href="https://xqtony.github.io/2023/05/26/comparable%20vs%20comparator/"/>
    <id>https://xqtony.github.io/2023/05/26/comparable%20vs%20comparator/</id>
    <published>2023-05-25T21:54:15.297Z</published>
    <updated>2023-05-25T23:34:57.709Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简单比较下Comparator与Comparable接口"><a href="#简单比较下Comparator与Comparable接口" class="headerlink" title="简单比较下Comparator与Comparable接口"></a>简单比较下<code>Comparator</code>与<code>Comparable</code>接口</h2><p><code>Comparator</code> 和 <code>Comparable</code> 都是 <code>Java</code> 中用于比较对象大小的接口，但它们有以下区别：</p><span id="more"></span><ul><li><p>接口位置不同：<code>Comparable</code> 接口位于 <code>java.lang</code> 包中，而 <code>Comparator</code> 接口位于 <code>java.util</code> 包中。</p></li><li><p>实现方式不同：实现 <code>Comparable</code> 接口的类需要重写 <code>compareTo()</code> 方法，而实现 <code>Comparator</code> 接口的类需要重写 <code>compare()</code> 方法。</p></li><li><p>使用场景不同：实现 <code>Comparable</code> 接口的类通常用于已经有一定顺序的情况下，例如对整数或字符串进行排序。而实现 <code>Comparator</code> 接口的类通常用于需要动态指定排序方式的情况下，例如对自定义对象进行排序。</p></li><li><p>排序方式不同：<code>Comparable</code> 接口是内部比较器，它定义了对象的自然顺序，即对象本身就有了固定的比较规则。而 <code>Comparator</code> 接口是外部比较器，它允许用户根据需要指定不同的比较规则。</p></li></ul><p>综上所述，<code>Comparable</code> 接口适用于已经有一定顺序的情况下，而 <code>Comparator</code> 接口适用于需要动态指定排序方式的情况下。</p><h2 id="以下是-Comparable-和-Comparator-的用法实例："><a href="#以下是-Comparable-和-Comparator-的用法实例：" class="headerlink" title="以下是 Comparable 和 Comparator 的用法实例："></a>以下是 Comparable 和 Comparator 的用法实例：</h2><p>Comparable 实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Person&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Person other)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.compare(<span class="built_in">this</span>.age, other.age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这个例子中，我们定义了一个 <code>Person</code> 类，并实现了 <code>Comparable</code> 接口。在 <code>compareTo()</code> 方法中，我们使用 <code>Integer.compare()</code> 方法比较了两个 <code>Person</code> 对象的年龄大小关系，从而定义了 <code>Person</code> 对象的自然顺序。这样，我们就可以在使用 <code>Collections.sort()</code> 或 <code>Arrays.sort()</code> 方法时，直接对 &#96;Person 对象进行排序。</p><p>Comparator 实例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonCompartor</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Person&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Person p1, Person p2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.compare(p1.getAge(), p2.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Person[] people=<span class="keyword">new</span> <span class="title class_">Person</span>[]&#123;<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Tony&quot;</span>, <span class="number">20</span>),<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Xiangqi&quot;</span>, <span class="number">10</span>)&#125;;</span><br><span class="line">        System.out.println(<span class="string">&quot;排序前&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Person person : people)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.print(person.getName()+<span class="string">&quot;:&quot;</span>+person.getAge());</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(people,<span class="keyword">new</span> <span class="title class_">PersonCompartor</span>());</span><br><span class="line">        System.out.println(<span class="string">&quot;\n排序后&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Person person : people)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.print(person.getName()+<span class="string">&quot;:&quot;</span>+person.getAge());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在这个例子中，我们同样定义了一个 <code>Person</code> 类，但没有实现 <code>Comparable</code> 接口。然后，我们创建了一个 <code>PersonComparator</code> 类，实现了 <code>Comparator</code> 接口，并重写了 <code>compare()</code> 方法。在 <code>compare()</code> 方法中，我们比较了两个 <code>Person</code> 对象的年龄大小关系，从而定义了 <code>Person</code> 对象的比较规则。这样，我们就可以在使用 <code>Collections.sort()</code> 或 <code>Arrays.sort()</code> 方法时，使用 <code>PersonComparator</code> 对象进行排序。</p><p>参考文献：</p><p><a href="https://www.cnblogs.com/xujian2014/p/5215082.html">Java中Comparable和Comparator区别小结</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;简单比较下Comparator与Comparable接口&quot;&gt;&lt;a href=&quot;#简单比较下Comparator与Comparable接口&quot; class=&quot;headerlink&quot; title=&quot;简单比较下Comparator与Comparable接口&quot;&gt;&lt;/a&gt;简单比较下&lt;code&gt;Comparator&lt;/code&gt;与&lt;code&gt;Comparable&lt;/code&gt;接口&lt;/h2&gt;&lt;p&gt;&lt;code&gt;Comparator&lt;/code&gt; 和 &lt;code&gt;Comparable&lt;/code&gt; 都是 &lt;code&gt;Java&lt;/code&gt; 中用于比较对象大小的接口，但它们有以下区别：&lt;/p&gt;</summary>
    
    
    
    <category term="Java高级特性和类库" scheme="https://xqtony.github.io/categories/Java%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E5%92%8C%E7%B1%BB%E5%BA%93/"/>
    
    
    <category term="compareTo" scheme="https://xqtony.github.io/tags/compareTo/"/>
    
    <category term="compare" scheme="https://xqtony.github.io/tags/compare/"/>
    
    <category term="Java" scheme="https://xqtony.github.io/tags/Java/"/>
    
    <category term="AI辅助创作" scheme="https://xqtony.github.io/tags/AI%E8%BE%85%E5%8A%A9%E5%88%9B%E4%BD%9C/"/>
    
    <category term="Comparator" scheme="https://xqtony.github.io/tags/Comparator/"/>
    
    <category term="Comparable" scheme="https://xqtony.github.io/tags/Comparable/"/>
    
  </entry>
  
  <entry>
    <title>浅谈compareTo()方法</title>
    <link href="https://xqtony.github.io/2023/05/26/compareTo/"/>
    <id>https://xqtony.github.io/2023/05/26/compareTo/</id>
    <published>2023-05-25T20:19:45.560Z</published>
    <updated>2023-05-25T22:51:37.078Z</updated>
    
    <content type="html"><![CDATA[<h1 id="下面这段代码使用了-compareTo-方法，有问题吗？"><a href="#下面这段代码使用了-compareTo-方法，有问题吗？" class="headerlink" title="下面这段代码使用了 compareTo() 方法，有问题吗？"></a>下面这段代码使用了 <code>compareTo()</code> 方法，有问题吗？</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">emp</span> <span class="operator">=</span> (Employee) o;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.id - emp.id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用减法看起来合乎逻辑，但实际上隐藏了溢出的问题。</p><span id="more"></span><p>当我们需要按照一定的规则进行排序的时候，通常要实现 <code>Comparable</code> 接口，并实现 <code>compareTo</code> 方法，规则如下：</p><p>1）如果当前对象小于另外一个对象，则 <code>compareTo</code> 方法必须返回负数；如果当前对象大于另外一个对象，则必须返回正数；如果两个对象相等，则返回零。</p><p>2）通常来说，<code>compareTo</code> 方法必须和 <code>equals</code> 方法一致，如果两个对象通过 equals 方法判断的结果为 <code>true</code>，那么 <code>compareTo</code> 必须返回零。</p><p>不过，JDK 中有一个反例，就是 <code>BigDecimal</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BigDecimal</span> <span class="variable">bd1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;2.0&quot;</span>);</span><br><span class="line"><span class="type">BigDecimal</span> <span class="variable">bd2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;2.00&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;equals: &quot;</span> + bd1.equals(bd2));</span><br><span class="line">System.out.println(<span class="string">&quot;compareTo: &quot;</span> + bd1.compareTo(bd2));</span><br></pre></td></tr></table></figure><p>输出结果如下所示：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">equals: <span class="literal">false</span></span><br><span class="line">compareTo: 0</span><br></pre></td></tr></table></figure><p>这是因为 <code>JDK</code> 认为 <code>2.0</code> 和 <code>2.00</code> 的精度不一样，所以不能 <code>equals</code>，但值确实是相等的。</p><p>3）不能使用减法来比较整数值，因为减法的结果可能溢出。应该使用 <code>Integer.compareTo()</code> 来进行比较。如果你想通过减法操作来提高性能，必须得确保两个操作数是正整数，或者确保两者相差的值小于 <code>Integer.MAX_VALUE</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompareDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> <span class="title class_">Employee</span>(Integer.MIN_VALUE));</span><br><span class="line">        list.add(<span class="keyword">new</span> <span class="title class_">Employee</span>(Integer.MAX_VALUE));</span><br><span class="line">        Collections.sort(list);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Employee</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">emp</span> <span class="operator">=</span> (Employee) o;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.id - emp.id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Employee&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>程序的输出结果如下所示：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Employee&#123;<span class="built_in">id</span>=1&#125;, Employee&#123;<span class="built_in">id</span>=2147483647&#125;, Employee&#123;<span class="built_in">id</span>=-2147483648&#125;]</span><br></pre></td></tr></table></figure><p>排序就乱了。因为 <code>Integer.MIN_VALUE - 1</code> 变成了正数 <code>2147483647</code>。</p><p>回到最开始的问题，正确的写法应该是</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">emp</span> <span class="operator">=</span> (Employee) o;</span><br><span class="line">        <span class="keyword">return</span> Integer.valueOf(<span class="built_in">this</span>.id).compareTo(emp.id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>实际上，<code>Integer.compareTo()</code>底层是通过调用<code>Integer.compare()</code>方法实现的：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Integer anotherInteger)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> compare(<span class="built_in">this</span>.value, anotherInteger.value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &lt; y) ? -<span class="number">1</span> : ((x == y) ? <span class="number">0</span> : <span class="number">1</span>); </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>所以上面的问题可以重写为</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">emp</span> <span class="operator">=</span> (Employee) o;</span><br><span class="line">        <span class="keyword">return</span> Integer.compare(<span class="built_in">this</span>.id, emp.id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>值得注意的是，<code>String</code>类型只有<code>compareTo</code>方法，而没有<code>compare</code>方法。给出源代码进行参考：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(String anotherString)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">len1</span> <span class="operator">=</span> value.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">len2</span> <span class="operator">=</span> anotherString.value.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">lim</span> <span class="operator">=</span> Math.min(len1, len2);</span><br><span class="line">    <span class="type">char</span> v1[] = value;</span><br><span class="line">    <span class="type">char</span> v2[] = anotherString.value;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (k &lt; lim) &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">c1</span> <span class="operator">=</span> v1[k];</span><br><span class="line">        <span class="type">char</span> <span class="variable">c2</span> <span class="operator">=</span> v2[k];</span><br><span class="line">        <span class="keyword">if</span> (c1 != c2) &#123;</span><br><span class="line">            <span class="keyword">return</span> c1 - c2;</span><br><span class="line">        &#125;</span><br><span class="line">        k++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> len1 - len2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可见<code>String</code>类型不需要<code>compare</code>方法。</p><p>基于<a href="https://mp.weixin.qq.com/s/oBDrFnuk1lbfuNHkrhAC5w">这10道基础Java面试题，虐哭了多少人</a>改写。</p><p>参考：</p><p><a href="https://blog.csdn.net/tp19970424/article/details/84962584">List集合排序Collections.sort()方法的一个容易忽略的小问题</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;下面这段代码使用了-compareTo-方法，有问题吗？&quot;&gt;&lt;a href=&quot;#下面这段代码使用了-compareTo-方法，有问题吗？&quot; class=&quot;headerlink&quot; title=&quot;下面这段代码使用了 compareTo() 方法，有问题吗？&quot;&gt;&lt;/a&gt;下面这段代码使用了 &lt;code&gt;compareTo()&lt;/code&gt; 方法，有问题吗？&lt;/h1&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Employee&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Comparable&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;int&lt;/span&gt; id;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title function_&quot;&gt;compareTo&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Object o)&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;type&quot;&gt;Employee&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;emp&lt;/span&gt; &lt;span class=&quot;operator&quot;&gt;=&lt;/span&gt; (Employee) o;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;this&lt;/span&gt;.id - emp.id;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;使用减法看起来合乎逻辑，但实际上隐藏了溢出的问题。&lt;/p&gt;</summary>
    
    
    
    <category term="Java高级特性和类库" scheme="https://xqtony.github.io/categories/Java%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E5%92%8C%E7%B1%BB%E5%BA%93/"/>
    
    
    <category term="compareTo" scheme="https://xqtony.github.io/tags/compareTo/"/>
    
    <category term="compare" scheme="https://xqtony.github.io/tags/compare/"/>
    
    <category term="BigDecimal" scheme="https://xqtony.github.io/tags/BigDecimal/"/>
    
    <category term="Java" scheme="https://xqtony.github.io/tags/Java/"/>
    
    <category term="二创" scheme="https://xqtony.github.io/tags/%E4%BA%8C%E5%88%9B/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://xqtony.github.io/2023/05/23/todo/"/>
    <id>https://xqtony.github.io/2023/05/23/todo/</id>
    <published>2023-05-23T04:49:36.894Z</published>
    <updated>2023-05-26T00:05:45.271Z</updated>
    
    <content type="html"><![CDATA[<h1 id="待办事项"><a href="#待办事项" class="headerlink" title="待办事项"></a>待办事项</h1><p>罗列出即将在github上线的demo项目，来研究新技术</p><span id="more"></span><h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><ul><li>Java虚拟机原理</li><li>Java高级特性和类库</li><li>Java网络与服务器编程</li><li>Java多线程编程</li><li>JVM调优</li><li>NIO、RPC框架</li></ul><h2 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h2><ul><li>Golang语言机制</li><li>开发工具的使用，定位和调试问题</li></ul><h2 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h2><ul><li>理解什么是分布式架构，精通主流框架原理</li><li>Spring Cloud</li><li>Dubbo</li><li>Zookeeper</li></ul><h2 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h2><ul><li>MySQL</li><li>Redis</li><li>HBase</li><li>MongoDB</li><li>Kafka</li><li>ElasticSearch</li></ul><h2 id="前端技术"><a href="#前端技术" class="headerlink" title="前端技术"></a>前端技术</h2><ul><li>JS</li><li>JQuery</li><li>ReactJs</li><li>Vue</li></ul><h2 id="网络编程"><a href="#网络编程" class="headerlink" title="网络编程"></a>网络编程</h2><ul><li>HTTP协议</li><li>缓存</li><li>序列化</li><li>RPC框架</li></ul><h2 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h2><ul><li>Docker</li><li>K8s （含二次开发）</li></ul><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><ul><li>编写脚本bash shell</li><li>熟悉环境</li></ul><h2 id="DevOps"><a href="#DevOps" class="headerlink" title="DevOps"></a>DevOps</h2><ul><li>DevOps概念</li><li>CI&#x2F;CD pipelines</li></ul><h2 id="理论基础"><a href="#理论基础" class="headerlink" title="理论基础"></a>理论基础</h2><ul><li>计算机网络</li><li>数据结构</li><li>操作系统</li><li>算法</li><li>设计模式</li></ul><h2 id="软实力"><a href="#软实力" class="headerlink" title="软实力"></a>软实力</h2><ul><li>技术钻研能力</li><li>分析问题解决问题</li><li>独立承担任务</li><li>系统进度把控</li><li>独立负责跨足项目</li><li>结果导向</li></ul><h2 id="代码风格及文档"><a href="#代码风格及文档" class="headerlink" title="代码风格及文档"></a>代码风格及文档</h2><ul><li>良好的编码习惯</li><li>技术文档编写能力</li><li>英语书面交流</li></ul><h2 id="没来得及整理的内容"><a href="#没来得及整理的内容" class="headerlink" title="没来得及整理的内容"></a>没来得及整理的内容</h2><p><a href="https://www.cnblogs.com/kuanglongblogs/p/11230250.html">https://www.cnblogs.com/kuanglongblogs/p/11230250.html</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;待办事项&quot;&gt;&lt;a href=&quot;#待办事项&quot; class=&quot;headerlink&quot; title=&quot;待办事项&quot;&gt;&lt;/a&gt;待办事项&lt;/h1&gt;&lt;p&gt;罗列出即将在github上线的demo项目，来研究新技术&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>MySQL数据库 - 基础篇</title>
    <link href="https://xqtony.github.io/2023/05/23/MySQL_DB_basic/"/>
    <id>https://xqtony.github.io/2023/05/23/MySQL_DB_basic/</id>
    <published>2023-05-22T16:28:19.611Z</published>
    <updated>2023-05-25T21:33:41.131Z</updated>
    
    <content type="html"><![CDATA[<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>是一种 关系型数据库：建立在关系模型上，由多张互相连接的二维表组成的数据库。关系数据库 特点：1. 使用表存储数据，格式统一，便于维护2. 使用SQL语言操作，标准统一，使用方便<br>MySQL的数据模型从客户端到DBMS，再到数据库，最后到达数据库中的表  </p><span id="more"></span><p><img src="/images/MySQL_DB_basic/1.png">  </p><p>MySQL启动的命令</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net <span class="keyword">start</span> mysql80  # 这里的mysql80是注册在Windows中的服务名称</span><br><span class="line">net stop mysql80</span><br></pre></td></tr></table></figure><p>MySQL客户端连接MySQL自带的客户端命令行CMD执行命令：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h <span class="number">127.0</span>.<span class="number">0.1</span> -<span class="selector-tag">P</span> <span class="number">3306</span> -u root -<span class="selector-tag">p</span></span><br></pre></td></tr></table></figure><p>SQLSQL通用语法1. SQL语句单行，多行均可，默认分号结尾2. 使用空格&#x2F;缩进以增加可读性3. 不区分大小写，推荐关键字使用大写4. 注释：单行注释：– 通用，# MySQL独有多行注释：&#x2F;**&#x2F;<br>SQL分类：DDL: Data Definition Language 数据定义语言，用来定义数据库对象 （数据库，表，字段）DML: Data Manipulation Language 数据操作语言，用来对数据库表中的数据进行增删改DQL: Data Query Language 数据查询语言，用来查询数据库中表的记录DCL: Data Control Language 数据控制语言，用来创建数据库用户、控制数据库的访问权限<br>DDL-数据库操作:查询查询所有数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br></pre></td></tr></table></figure><p>查询当前数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATABASE();</span><br></pre></td></tr></table></figure><p>创建</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] 数据库名 [<span class="keyword">DEFAULT</span> CHARSET 字符集] [<span class="keyword">COLLATE</span> 排序规则]</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> test; <span class="comment">-- 如果不存在，创建test数据库</span></span><br><span class="line"><span class="keyword">create</span> database itheima <span class="keyword">default</span> charset utf8mb4;  <span class="comment">-- 创建utf8mb4字符集的itheima 数据库</span></span><br></pre></td></tr></table></figure><p>删除</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE [IF <span class="keyword">EXISTS</span>] 数据库名</span><br></pre></td></tr></table></figure><p>使用数据库</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">USE</span> 数据库名</span><br></pre></td></tr></table></figure><p>查询当前数据库全部表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br></pre></td></tr></table></figure><p>查询表结构</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DESC</span> 表名 或者 DESCRIBE 表名</span><br></pre></td></tr></table></figure><p>查询指定表的建表语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名</span><br></pre></td></tr></table></figure><p>DDL-表操作-创建</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名(</span><br><span class="line">    字段<span class="number">1</span>   字段<span class="number">1</span>类型[COMMENT  字段<span class="number">1</span>注释],</span><br><span class="line">    字段<span class="number">2</span>   字段<span class="number">2</span>类型[COMMENT  字段<span class="number">2</span>注释],</span><br><span class="line">    ......</span><br><span class="line">    字段n   字段n类型[COMMENT  字段n注释]</span><br><span class="line">)[COMMENT 注释];</span><br></pre></td></tr></table></figure><blockquote><p>第二章讲解InnoDB底层原理</p></blockquote><p>DDL-表操作-数据类型主要分三类：数值类型，字符串类型，日期时间类型数值类型<br><img src="/images/MySQL_DB_basic/2.png"> </p><p>实例：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age TINYINT UNSIGNED  # <span class="number">0</span>~<span class="number">255</span>的整数</span><br><span class="line">score DOUBLE(<span class="number">4</span>, <span class="number">1</span>)   <span class="selector-id">#100</span>.<span class="number">0</span>最长是<span class="number">4</span>，填<span class="number">4</span>，<span class="number">80.5</span>，<span class="number">70.5</span>，最多一位小数，填<span class="number">1</span>。</span><br></pre></td></tr></table></figure><p>字符串类型<br><img src="/images/MySQL_DB_basic/3.png"> </p><p>定长&#x2F;变长字符串的区别</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">char</span>(<span class="number">10</span>) <span class="meta"># 长度固定为10，没用的部分用空格补位  --&gt; 性能好？</span></span><br><span class="line">varchar(<span class="number">10</span>) <span class="meta"># 长度最长不超过10，小于10时体现实际长度  --&gt; 性能较差</span></span><br></pre></td></tr></table></figure><p>实例：用户名 username 用那个更好呢？答案：varchar(50)更好。因为用户的用户名不是定长的，使用varchar可以节约空间性别 gender 用哪个？答案：char(1)<br>日期类型<br><img src="/images/MySQL_DB_basic/4.png"> </p><p>实例：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">birthday</span> date  <span class="comment"># 生日用date类型更合适</span></span><br></pre></td></tr></table></figure><p>案例：根据需求创建表（设计合理的数据类型、长度）<br><img src="/images/MySQL_DB_basic/5.png"> </p><p>答案：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">    id <span class="type">int</span> comment <span class="string">&#x27;编号&#x27;</span>,</span><br><span class="line">    workno <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;工号&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">1</span>) comment <span class="string">&#x27;性别&#x27;</span>,</span><br><span class="line">    age tinyint unsigned comment <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    idcard <span class="type">char</span>(<span class="number">18</span>) comment <span class="string">&#x27;身份证号&#x27;</span>,</span><br><span class="line">    entrydate <span class="type">date</span> comment <span class="string">&#x27;入职时间&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;员工表&#x27;</span>;</span><br></pre></td></tr></table></figure><p>DDL-表操作-修改添加字段</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> 字段名 类型（长度） [COMMENT 注释] [约束];</span><br></pre></td></tr></table></figure><p>案例：为emp表添加一个字段“昵称”为nickname，类型为varchar(20)答案：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">add</span> nickname <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;昵称&#x27;</span>;</span><br></pre></td></tr></table></figure><p>修改数据类型</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 MODIFY 字段名 新数据类型(长度);</span><br></pre></td></tr></table></figure><p>修改字段名和字段类型</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 CHANGE 旧字段名 新字段名称 类型（长度） [COMMENT 注释] [约束];</span><br></pre></td></tr></table></figure><p>案例：将emp表的nickname 修改为username，类型为varchar(30)答案：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp change nickname username <span class="type">varchar</span>(<span class="number">30</span>) comment <span class="string">&#x27;用户名&#x27;</span>;</span><br></pre></td></tr></table></figure><p>删除字段</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">DROP</span> 字段名;</span><br></pre></td></tr></table></figure><p>案例：删除emp中的username列答案：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">drop</span> username;</span><br></pre></td></tr></table></figure><p>修改表名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 RENAME <span class="keyword">TO</span> 新表名;</span><br></pre></td></tr></table></figure><p>案例：将emp表表名修改为employee</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp RENAME <span class="keyword">TO</span> employee;</span><br></pre></td></tr></table></figure><p>删除表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [IF <span class="keyword">EXISTS</span>] 表名;</span><br></pre></td></tr></table></figure><p>删除指定表，并重新创建该表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> 表名;</span><br></pre></td></tr></table></figure><p>MySQL图形化界面：<br><img src="/images/MySQL_DB_basic/6.png"> MySQL Workbench<br>DML-介绍DML的全称是Data Manipulation Lanagage (数据操作语言），用来对数据表中的数据记录进行增删改操作。添加数据 (INSERT)修改数据 (UPDATE)删除数据 (DELETE)<br>DML-添加数据1. 给指定字段添加数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 (字段<span class="number">1</span>， 字段<span class="number">2</span>, ...) <span class="keyword">VALUES</span> (值<span class="number">1</span>， 值<span class="number">2</span>, ...);</span><br></pre></td></tr></table></figure><p>2. 给全部字段添加数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 VALUSE (值<span class="number">1</span>， 值<span class="number">2</span>, ...);</span><br></pre></td></tr></table></figure><p>3. 批量添加数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 (字段名<span class="number">1</span>，字段名<span class="number">2</span>，...) VALUSE (值<span class="number">1</span>，值<span class="number">2</span>，...), VALUSE (值<span class="number">1</span>，值<span class="number">2</span>，...);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 VALUSE (值<span class="number">1</span>，值<span class="number">2</span>，...), VALUSE (值<span class="number">1</span>，值<span class="number">2</span>，...);</span><br></pre></td></tr></table></figure><p>注意：<br><img src="/images/MySQL_DB_basic/7.png"> </p><p>DML-修改数据UPDATE 表名 SET 字段名1&#x3D;值1, 字段名2&#x3D;值2, … [WHERE 条件];注意：如果修改的条件没有，则会修改整张表的数据。案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- id = 1 的名字修改为it 黑马</span></span><br><span class="line"><span class="keyword">update</span> employee <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;kelly&#x27;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- id = 1 的名字修改为Kelly, gender 修改为女</span></span><br><span class="line"><span class="keyword">update</span> employee <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;kelly&#x27;</span>, gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 将所有员工的入职时间设定为2008-01-01</span></span><br><span class="line"><span class="keyword">update</span> employee <span class="keyword">set</span> entrydate <span class="operator">=</span> <span class="string">&#x27;2008-01-01&#x27;</span>;</span><br></pre></td></tr></table></figure><p>DML-删除数据DELETE FROM 表名 [WHERE 条件];注意：DELETE语句的条件可有可无，没有的情况下会删除整张表的数据。DELETE语句不能删除某一个字段的值（可以使用UPDATE）。案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除gender为W的员工</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employee <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除所有员工</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employee;</span><br></pre></td></tr></table></figure><p>DQL-介绍DQL是Data Query Language 的缩写，用来查询数据库中表的记录。查询关键字：SELECT<br>DQL-语法</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名列表</span><br><span class="line"><span class="keyword">WHERE</span> 条件列表 <span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组字段列表</span><br><span class="line"><span class="keyword">HAVING</span> 分组后条件列表 <span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序字段列表</span><br><span class="line">LIMIT 分页参数</span><br></pre></td></tr></table></figure><p>基本查询条件查询 WHERE聚合函数 count(), max(), min(), avg(), sum()分组查询 GROUP BY排序查询 ORDER BY分页查询 LIMIT<br>DQL-基本查询1. 查询返回多个字段</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段<span class="number">1</span>，字段<span class="number">2</span>，字段<span class="number">3.</span>.. <span class="keyword">FROM</span> 表名;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p>2. 设置别名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段<span class="number">1</span> [<span class="keyword">AS</span> 别名<span class="number">1</span>], 字段<span class="number">2</span> [<span class="keyword">AS</span> 别名<span class="number">2</span>] ... <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p>其中AS可以省略3. 去除重复记录</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> 字段列表 <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p>案例：数据准备：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数据准备</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp(</span><br><span class="line">  id <span class="type">INT</span>,</span><br><span class="line">    workno <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    gender <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">    age TINYINT UNSIGNED,</span><br><span class="line">    idcard <span class="type">CHAR</span>(<span class="number">18</span>),</span><br><span class="line">    workaddress <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    entrydate <span class="type">DATE</span></span><br><span class="line">) COMMENT <span class="string">&#x27;员工表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456789012345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;123456789012335678&#x27;</span>, <span class="string">&#x27;Dalian&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;ac&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">8</span>, <span class="string">&#x27;123456789012345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2006-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;ad&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456783412345678&#x27;</span>, <span class="string">&#x27;Dalian&#x27;</span>, <span class="string">&#x27;2002-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;ae&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">38</span>, <span class="string">&#x27;123456783312345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;af&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">68</span>, <span class="string">&#x27;123456786012345678&#x27;</span>, <span class="string">&#x27;Dalian&#x27;</span>, <span class="string">&#x27;2000-01-06&#x27;</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;ag&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456789012445678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2007-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;ah&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">8</span>, <span class="string">&#x27;123456789012235678&#x27;</span>, <span class="string">&#x27;Shanghai&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">9</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;ai&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456789022345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2011-01-02&#x27;</span>),</span><br><span class="line">(<span class="number">10</span>, <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;aj&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">98</span>, <span class="string">&#x27;123456722212345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">11</span>, <span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;ak&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456555512345678&#x27;</span>, <span class="string">&#x27;Shanghai&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">12</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;al&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">78</span>, <span class="string">&#x27;123456789512345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">13</span>, <span class="string">&#x27;13&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">16</span>, <span class="string">&#x27;123456789712345678&#x27;</span>, <span class="string">&#x27;Shanghai&#x27;</span>, <span class="string">&#x27;1990-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">14</span>, <span class="string">&#x27;14&#x27;</span>, <span class="string">&#x27;an&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;123456789872345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">15</span>, <span class="string">&#x27;15&#x27;</span>, <span class="string">&#x27;ao&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;123456789012345678&#x27;</span>, <span class="string">&#x27;Shanghai&#x27;</span>, <span class="string">&#x27;2005-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">16</span>, <span class="string">&#x27;16&#x27;</span>, <span class="string">&#x27;aq&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">22</span>, <span class="string">&#x27;123456782362345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--  基本查询</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. 查询指定字段，name，workno，age返回</span></span><br><span class="line"><span class="keyword">SELECT</span> name, workno, age <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询所有字段返回</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;  <span class="comment">-- 尽量不要写*，因为效率低而且不安全，相比之下写出来所有字段更好</span></span><br><span class="line"><span class="keyword">SELECT</span> id, workno, name, gender, age, idcard, workaddress, entrydate <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 查询所有员工的工作地址</span></span><br><span class="line"><span class="keyword">SELECT</span> workaddress <span class="keyword">as</span> <span class="string">&#x27;工作地址&#x27;</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> workaddress <span class="string">&#x27;工作地址&#x27;</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. 查询员工的上班地址（不要重复）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> workaddress <span class="string">&#x27;工作地址&#x27;</span> <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure><p>DQL-条件查询1. 语法</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span> 条件列表;</span><br></pre></td></tr></table></figure><p>2. 条件比较运算符![]<img src="/images/MySQL_DB_basic/8.png"><br>逻辑运算符<br><img src="/images/MySQL_DB_basic/9.png">   </p><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 条件查询</span></span><br><span class="line"><span class="comment">-- 1. 查询年龄等于98的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">98</span>;</span><br><span class="line"><span class="comment">-- 2. 查询年龄小于20 的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;</span> <span class="number">20</span>;</span><br><span class="line"><span class="comment">-- 3. 查询年龄小于等于20的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;=</span> <span class="number">20</span>;</span><br><span class="line"><span class="comment">-- 4. 查询没有身份证号的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> idcard <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="comment">-- 5. 查询有身份证号的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> idcard <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="comment">-- 6. 查询年龄不是88的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;&gt;</span> <span class="number">88</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">!=</span> <span class="number">88</span>;</span><br><span class="line"><span class="comment">-- 7. 查询年龄在15~20岁的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="keyword">BETWEEN</span> <span class="number">15</span> <span class="keyword">AND</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&gt;=</span> <span class="number">15</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">20</span>;</span><br><span class="line"><span class="comment">-- 8. 查询性别为女而且年龄小于25的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span> <span class="keyword">AND</span> age <span class="operator">&lt;</span> <span class="number">25</span>;</span><br><span class="line"><span class="comment">-- 9. 查询年龄等于18或20或40的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">18</span> <span class="keyword">OR</span> age <span class="operator">=</span> <span class="number">20</span> <span class="keyword">OR</span> age <span class="operator">=</span> <span class="number">40</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="keyword">IN</span> (<span class="number">18</span>, <span class="number">20</span>, <span class="number">40</span>);</span><br><span class="line"><span class="comment">-- 10. 查询名字是两个字的员工的信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> name <span class="keyword">like</span> <span class="string">&#x27;__&#x27;</span>;</span><br><span class="line"><span class="comment">-- 11. 查询身份证号最后一位是X的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> idcard <span class="keyword">LIKE</span> <span class="string">&#x27;%X&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> idcard <span class="keyword">LIKE</span> <span class="string">&#x27;_________________X&#x27;</span>;</span><br></pre></td></tr></table></figure><p>DQL-分组查询语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 [<span class="keyword">WHERE</span> 条件] <span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组字段名 [<span class="keyword">HAVING</span> 分组后过滤条件]</span><br></pre></td></tr></table></figure><p>WHERE和HAVING的区别- 执行时间不同，WHER是分组前过滤，HAVING是分组后过滤- 判断条件不同，WHERE不能对聚合函数进行判断，HAVING可以<br>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 分组查询</span></span><br><span class="line"><span class="comment">-- 1. 根据性别分组，统计男性员工和女性员工的数量</span></span><br><span class="line"><span class="keyword">SELECT</span> gender, <span class="built_in">COUNT</span>(<span class="operator">*</span>) total <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> gender;</span><br><span class="line"><span class="comment">-- 2. 根据性别分组，统计男性员工和女性员工的平均年龄</span></span><br><span class="line"><span class="keyword">SELECT</span> gender, <span class="built_in">AVG</span>(age) avg_age <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> gender;</span><br><span class="line"><span class="comment">-- 3. 查询年龄小于45的员工，并根据工作地址进行分组，获取员工数量&gt;=3的工作地址</span></span><br><span class="line"><span class="keyword">SELECT</span> workaddress, <span class="built_in">COUNT</span>(<span class="operator">*</span>) address_count <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;</span> <span class="number">45</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> workaddress <span class="keyword">HAVING</span> address_count <span class="operator">&gt;=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure><p>注意：- 执行顺序：where &gt; 聚合函数 &gt; having- 分组之后，查询的字段一般为聚合函数和分组字段，查询其他字段无意义<br>DQL-排序查询语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 <span class="keyword">ORDER</span> <span class="keyword">BY</span> 字段<span class="number">1</span> 排序方式<span class="number">1</span>,  字段<span class="number">2</span> 排序方式<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p>排序方式：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ASC: 升序 （默认值）</span><br><span class="line">DESC: 降序</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 排序查询</span></span><br><span class="line"><span class="comment">-- 1 根据年龄对公司的员工进行升序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> age <span class="keyword">ASC</span>;  <span class="comment">-- ASC可以省略；降序则改为DESC</span></span><br><span class="line"><span class="comment">-- 2 根据入职时间对员工进行降序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> entrydate <span class="keyword">DESC</span>;</span><br><span class="line"><span class="comment">-- 3 根据年龄对公司员工进行升序排序，如果年龄相同再按入职时间进行降序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> age <span class="keyword">ASC</span>, entrydate <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>DQL-分页查询语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 LIMIT 起始索, 查询返回记录数;</span><br></pre></td></tr></table></figure><p>注意：- 起始索引从0开始，其实索引 &#x3D; (查询页码 - 1) * 每页显示记录数- 分页查询是数据库的方言，不同的数据库有不同的实现，MySQL是LIMIT- 如果查询的是第一页的数据，起始索引可以省略，直接简写为LIMIT 10<br>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 分页查询</span></span><br><span class="line"><span class="comment">-- 1. 查询第一页员工数据，每页显示10条记录</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp LIMIT <span class="number">0</span>, <span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp LIMIT <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询第二页员工数据，每页显示10条记录</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp LIMIT <span class="number">10</span>, <span class="number">10</span>; <span class="comment">-- (页码 - 1)*页展示记录数</span></span><br></pre></td></tr></table></figure><p>DQL 案例课</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 案例</span></span><br><span class="line"><span class="comment">-- 1. 查询年龄为20，21，22，23岁的女性员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="keyword">IN</span> (<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>) <span class="keyword">AND</span> gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span>;</span><br><span class="line"><span class="comment">-- 2. 查询性别为男并且年龄在20-40岁（含）且姓名为两个字的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">&#x27;M&#x27;</span> <span class="keyword">AND</span> ( age <span class="keyword">BETWEEN</span> <span class="number">20</span> <span class="keyword">AND</span> <span class="number">40</span> ) <span class="keyword">AND</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;__&#x27;</span>;</span><br><span class="line"><span class="comment">-- 3. 统计员工表中，年龄小于60岁的男性和女性员工的数量。SELECT gender, COUNT(*) age_count FROM emp WHERE age &lt; 60 GROUP BY gender;</span></span><br><span class="line"><span class="comment">-- 4. 查询所有年龄小于等于35岁员工的姓名和年龄，并对查询结果按照年龄升序排序，年龄相同按照入职时间降序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> name, age <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;=</span> <span class="number">35</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age, entrydate <span class="keyword">DESC</span>;</span><br><span class="line"><span class="comment">-- 5. 查询性别为W且年龄在20-40（含）以内的前5个员工信息，对查询的结果按年龄升序排序，年龄相同按照入职时间升序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span> <span class="keyword">AND</span> ( age <span class="keyword">BETWEEN</span> <span class="number">20</span> <span class="keyword">AND</span> <span class="number">40</span> ) <span class="keyword">ORDER</span> <span class="keyword">BY</span> age, entrydate LIMIT <span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>DQL - 执行顺序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>        (<span class="number">4</span>)</span><br><span class="line"><span class="keyword">FROM</span>          (<span class="number">1</span>)</span><br><span class="line"><span class="keyword">WHERE</span>         (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span>      (<span class="number">3</span>)</span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span>      (<span class="number">5</span>)</span><br><span class="line">LIMIT         (<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">LIMIT</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询年龄大于15的员工的姓名、年龄、并根据年龄进行升序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> name, age <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age;</span><br><span class="line"><span class="comment">-- 顺序验证</span></span><br><span class="line"><span class="keyword">SELECT</span> name, age <span class="keyword">FROM</span> emp E <span class="keyword">WHERE</span> E.age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age; </span><br><span class="line"><span class="comment">-- FROM 第一</span></span><br><span class="line"><span class="keyword">SELECT</span> E.name, E.age <span class="keyword">FROM</span> emp E <span class="keyword">WHERE</span> E.age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age; </span><br><span class="line"><span class="comment">-- SELECT 在FROM和WHERE之后</span></span><br><span class="line"><span class="keyword">SELECT</span> E.name ename, E.age EAGE <span class="keyword">FROM</span> emp E <span class="keyword">WHERE</span> EAGE <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age; </span><br><span class="line"><span class="comment">-- 失败：SELECT 在FROM和WHERE之后执行</span></span><br><span class="line"><span class="keyword">SELECT</span> E.name ename, E.age EAGE <span class="keyword">FROM</span> emp E <span class="keyword">WHERE</span> E.age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> EAGE; </span><br><span class="line"><span class="comment">-- 成功：SELECT 在ORDER BY之前执行</span></span><br></pre></td></tr></table></figure><p>DCL-介绍DCL 全称 Data Control Language （数据控制语言），用来管理数据库用户、控制数据库的访问权限<br>DCL-管理用户1. 查询用户</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USE mysql;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure><p>2. 创建用户</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;密码&#x27;</span>;</span><br></pre></td></tr></table></figure><p>3. 修改用户密码</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;新密码&#x27;</span>;</span><br></pre></td></tr></table></figure><p>4. 删除用户</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span>;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- DCL</span></span><br><span class="line">use mysql;</span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建用户itcast，只能够在localhost 访问，密码123456</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;itcast&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建用户heima，可以在任意机器访问该数据库，密码123456</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改用户heima的密码为1234</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">with</span> mysql_native_password <span class="keyword">by</span> <span class="string">&#x27;1234&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除itcast@localhost用户</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> <span class="string">&#x27;itcast&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><p>注意：- 主机名可以用’%‘通配- 这类SQL开发人员使用较少，主要是DBA (Database Administrator 数据库管理员)使用<br>DCL-权限控制</p><p><img src="/images/MySQL_DB_basic/10.png"> </p><p>1. 查询权限  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;用户名&#x27;</span>@‘主机名’;</span><br></pre></td></tr></table></figure><p>2. 授予权限</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> 权限列表 <span class="keyword">ON</span> 数据库.表名 <span class="keyword">TO</span> <span class="string">&#x27;用户名&#x27;</span>@‘主机名’;</span><br></pre></td></tr></table></figure><p>3. 撤销权限</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">REMOVE</span> 权限列表 ON 数据库名.表名 FROM <span class="string">&#x27;用户名&#x27;</span>@‘主机名’;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询权限</span></span><br><span class="line"><span class="keyword">show</span> grants <span class="keyword">for</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授予权限</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> itcast.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 撤销权限</span></span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">all</span> <span class="keyword">on</span> itcast.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>注意：<br><img src="/images/MySQL_DB_basic/11.png"> </p><p>总结：1. 用户管理</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;usernmae&#x27;</span>@<span class="string">&#x27;host&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span>;</span><br></pre></td></tr></table></figure><p>2. 权限控制</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> 权限列表 <span class="keyword">ON</span> 数据库名.表名 <span class="keyword">TO</span> ‘用户名<span class="string">&#x27;@&#x27;</span>主机名<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">REVOKE 权限列表 ON 数据库名.表名 FROM &#x27;</span>用户名<span class="string">&#x27;@&#x27;</span>主机名<span class="string">&#x27;;</span></span><br></pre></td></tr></table></figure><p>函数函数是指可以被另一段程序直接调用的的程序或代码。</p><ul><li><p>字符串函数</p></li><li><p>数值函数</p></li><li><p>日期函数</p></li><li><p>流程函数</p></li></ul><p>字符串函数<br><img src="/images/MySQL_DB_basic/12.png"><br>演示：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 函数演示</span></span><br><span class="line"><span class="comment">-- concat</span></span><br><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;Hello &#x27;</span>, <span class="string">&#x27;MySQL&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- lower</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(<span class="string">&#x27;Hello&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- upper</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;Hello&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- lpad</span></span><br><span class="line"><span class="keyword">select</span> lpad(<span class="string">&#x27;01&#x27;</span>, <span class="number">5</span>, <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- rpad</span></span><br><span class="line"><span class="keyword">select</span> rpad(<span class="string">&#x27;01&#x27;</span>, <span class="number">5</span>, <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- trim</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">trim</span>(<span class="string">&#x27;  Hello MySQL    &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- substring</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">substring</span>(<span class="string">&#x27;Hello MySQL&#x27;</span>, <span class="number">1</span>, <span class="number">5</span>);  # 这里字符串索引从<span class="number">1</span>开始</span><br></pre></td></tr></table></figure><p>案例：由于业务需求变更，企业员工的工号，统一为5位数，目前不足5位数的全部在前面补充0。比如1号员工应该为00001。答案：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 员工号补0.</span></span><br><span class="line">use itcast;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">update</span> emp <span class="keyword">set</span> workno <span class="operator">=</span> lpad(workno, <span class="number">5</span>, <span class="string">&#x27;0&#x27;</span>);</span><br></pre></td></tr></table></figure><p>数值函数常见的数值函数如下：</p><p><img src="/images/MySQL_DB_basic/13.png"> </p><p>演示</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数值函数</span></span><br><span class="line"><span class="comment">-- ceil</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="number">1.1</span>);</span><br><span class="line"><span class="comment">-- floor</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">floor</span>(<span class="number">1.5</span>);</span><br><span class="line"><span class="comment">-- mod</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">mod</span>(<span class="number">3</span>, <span class="number">4</span>);  # <span class="number">3</span>除以<span class="number">4</span>取余</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">mod</span>(<span class="number">6</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">-- rand</span></span><br><span class="line"><span class="keyword">select</span> rand();  # 获得一个<span class="number">0</span><span class="number">-1</span>的随机数</span><br><span class="line"><span class="comment">-- round</span></span><br><span class="line"><span class="keyword">select</span> round(<span class="number">2.345</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">select</span> round(<span class="number">2.344</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>案例通过数据库的函数，生成一个六位数的随机验证码</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 2.通过数据库的函数，生成一个六位数的随机验证码</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="built_in">substring</span>(rand(), <span class="number">3</span>, <span class="number">6</span>);  # 用substring截取</span><br><span class="line"><span class="keyword">select</span> lpad(round(rand() <span class="operator">*</span> <span class="number">1000000</span>, <span class="number">0</span>), <span class="number">6</span>, <span class="string">&#x27;0&#x27;</span>);  # 计算，取整，填充</span><br></pre></td></tr></table></figure><p>日期函数常见的日期函数<br><img src="/images/MySQL_DB_basic/14.png"> </p><p>演示：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 日期函数</span></span><br><span class="line"><span class="comment">-- curdate()</span></span><br><span class="line"><span class="keyword">select</span> curdate();</span><br><span class="line"><span class="comment">-- curtime()</span></span><br><span class="line"><span class="keyword">select</span> curtime();</span><br><span class="line"><span class="comment">-- now()</span></span><br><span class="line"><span class="keyword">select</span> now();</span><br><span class="line"></span><br><span class="line"><span class="comment">-- YEAR, MONTH, DAY</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">year</span>(now()), <span class="keyword">month</span>(now()), <span class="keyword">day</span>(now());</span><br><span class="line"></span><br><span class="line"><span class="comment">-- date_add(date, INTERVAL expr type)</span></span><br><span class="line"><span class="keyword">select</span> date_add(now(), <span class="type">INTERVAL</span> <span class="number">70</span> <span class="keyword">day</span>);  # <span class="number">70</span>天之后，<span class="number">70</span>天之前用负值即可</span><br><span class="line"></span><br><span class="line"><span class="comment">-- date_diff</span></span><br><span class="line"><span class="keyword">select</span> datediff(now(), <span class="string">&#x27;2022-12-01&#x27;</span>);  # 第一个日期减去第二个日期</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有员工的入职天数，并根据入职天数倒序排序</span></span><br><span class="line"><span class="keyword">select</span> name, entrydate, datediff(now(), entrydate) 入职日期 <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> 入职日期 <span class="keyword">desc</span>;  #可以用中文。</span><br></pre></td></tr></table></figure><p>流程函数流程函数实现条件筛选，提高语句的效率：<br><img src="/images/MySQL_DB_basic/15.png"> </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IF(value, t, f)</span><br><span class="line">IFNULL(value1, value2)</span><br><span class="line">CASE WHEN <span class="selector-attr">[val1]</span> THEN <span class="selector-attr">[res1]</span> ... ELSE <span class="selector-attr">[default]</span> END</span><br><span class="line">CASE <span class="selector-attr">[expr]</span> WHEN <span class="selector-attr">[val1]</span> THEN <span class="selector-attr">[res1]</span> .. ELSE <span class="selector-attr">[default]</span> END</span><br></pre></td></tr></table></figure><p>演示：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 流程函数</span></span><br><span class="line"><span class="comment">-- if</span></span><br><span class="line"><span class="keyword">select</span> if (<span class="literal">true</span>, <span class="string">&#x27;ok&#x27;</span>, <span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ifnull</span></span><br><span class="line"><span class="keyword">select</span> ifnull (<span class="string">&#x27;ok&#x27;</span>, <span class="string">&#x27;Default&#x27;</span>);  <span class="comment">-- 第一个值为非null则返回第一个值，若为null则返回第二个值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> ifnull (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Default&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> ifnull (<span class="keyword">null</span>, <span class="string">&#x27;Default&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- case when then else end</span></span><br><span class="line"><span class="comment">-- 需求：查询emp员工姓名和工作地址（北京/上海 ---&gt;一线城市，其他---&gt;二线城市）</span></span><br><span class="line"><span class="keyword">select</span> name, </span><br><span class="line">     <span class="keyword">case</span> workaddress </span><br><span class="line">       <span class="keyword">when</span> <span class="string">&#x27;Beijing&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;一线城市&#x27;</span> </span><br><span class="line">       <span class="keyword">when</span> <span class="string">&#x27;Shanghai&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;一线城市&#x27;</span></span><br><span class="line">       <span class="keyword">else</span> <span class="string">&#x27;二线城市&#x27;</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 案例：统计班级各个学员的成绩，展示的规则如下：-- &gt;= 85，展示优秀 </span></span><br><span class="line"><span class="comment">-- &gt;= 60, 展示及格 </span></span><br><span class="line"><span class="comment">-- 否则， 展示不及格 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> score(</span><br><span class="line">  id <span class="type">int</span> comment <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    math <span class="type">int</span> comment <span class="string">&#x27;数学&#x27;</span>,</span><br><span class="line">    english <span class="type">int</span> comment <span class="string">&#x27;英语&#x27;</span>,</span><br><span class="line">    chinese <span class="type">int</span> comment <span class="string">&#x27;语文&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;学员成绩表&#x27;</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> score</span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;Tom&#x27;</span>, <span class="number">67</span>, <span class="number">88</span>, <span class="number">95</span>), (<span class="number">2</span>, <span class="string">&#x27;Rose&#x27;</span>, <span class="number">23</span>, <span class="number">66</span>, <span class="number">90</span>), (<span class="number">3</span>, <span class="string">&#x27;Jack&#x27;</span>, <span class="number">56</span>, <span class="number">98</span>, <span class="number">76</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> score;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id, name,</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">when</span> math <span class="operator">&gt;=</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;优秀&#x27;</span> <span class="keyword">when</span> math <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;及格&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;不及格&#x27;</span> <span class="keyword">end</span> <span class="string">&#x27;数学成绩&#x27;</span>,</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">when</span> english <span class="operator">&gt;=</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;优秀&#x27;</span> <span class="keyword">when</span> english <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;及格&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;不及格&#x27;</span> <span class="keyword">end</span> <span class="string">&#x27;英语成绩&#x27;</span>,</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">when</span> chinese <span class="operator">&gt;=</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;优秀&#x27;</span> <span class="keyword">when</span> chinese <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;及格&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;不及格&#x27;</span> <span class="keyword">end</span> <span class="string">&#x27;语文成绩&#x27;</span></span><br><span class="line"><span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure><p>总结字符串函数</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">concat</span></span><br><span class="line"><span class="attr">lower</span></span><br><span class="line"><span class="attr">upper</span></span><br><span class="line"><span class="attr">lpad</span> <span class="string">左填充</span></span><br><span class="line"><span class="attr">rpad</span> <span class="string">右填充</span></span><br><span class="line"><span class="attr">trim</span> <span class="string">去除左右空格</span></span><br><span class="line"><span class="attr">substring</span>  <span class="string">字符串截取</span></span><br></pre></td></tr></table></figure><p>数值函数</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ceil</span><br><span class="line">floor</span><br><span class="line">mod</span><br><span class="line">rand</span><br><span class="line">round 四舍五入，保留指定位小数</span><br></pre></td></tr></table></figure><p>日期函数</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">curdate</span></span><br><span class="line">curtime</span><br><span class="line">now</span><br><span class="line">year</span><br><span class="line">month</span><br><span class="line">day</span><br><span class="line">date_add</span><br><span class="line">datediff  第一个日期减去第二个日期</span><br></pre></td></tr></table></figure><p>流程函数</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span></span><br><span class="line">ifnull</span><br><span class="line"><span class="keyword">case</span> [...] <span class="keyword">when</span>.. <span class="keyword">then</span>... <span class="keyword">else</span>... <span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>约束概述：常见的约束有哪些</p><ul><li><p>概念：约束是作用于表中字段上的规则，用于限制存储在表中的数据</p></li><li><p>目的：保证数据库中数据的正确，有效性和完整性</p></li><li><p>分类：</p></li></ul><p><img src="/images/MySQL_DB_basic/16.png"> </p><p>约束演示案例：根据需求，完成表的创建<br><img src="/images/MySQL_DB_basic/17.png"> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">id: <span class="keyword">primary</span> key, auto_increment</span><br><span class="line">name: <span class="keyword">not</span> <span class="keyword">null</span>, <span class="keyword">unique</span></span><br><span class="line">age: <span class="keyword">check</span></span><br><span class="line">status: <span class="keyword">default</span></span><br><span class="line">gender: N<span class="operator">/</span>A</span><br><span class="line"><span class="comment">--  约束</span></span><br><span class="line"><span class="keyword">create</span> database itheima <span class="keyword">default</span> charset utf8mb4;</span><br><span class="line">use itheima;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;主键&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> <span class="keyword">check</span>(age <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">and</span> age <span class="operator">&lt;</span> <span class="number">120</span>) comment <span class="string">&#x27;年龄&#x27;</span>,   <span class="comment">-- 用and或&amp;&amp;都可以 </span></span><br><span class="line">    status <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;1&#x27;</span> comment <span class="string">&#x27;状态&#x27;</span>,</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">1</span>)</span><br><span class="line">) comment <span class="string">&#x27;用户表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom1&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>), (<span class="string">&#x27;Tom2&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom3&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="keyword">null</span>, <span class="number">19</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>); <span class="comment">-- 出错，因为不可以出错</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom3&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>); <span class="comment">-- 不可重复执行，因为存在唯一约束 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom4&#x27;</span>, <span class="number">80</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>);  <span class="comment">-- id 是5，虽然刚才插入没有成功，但是id已经被申请过了 </span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom5&#x27;</span>, <span class="number">-1</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>);  <span class="comment">-- 检查约束生效 </span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom5&#x27;</span>, <span class="number">121</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>); <span class="comment">-- 检查约束生效 </span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom6&#x27;</span>, <span class="number">121</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom5&#x27;</span>, <span class="number">120</span>, <span class="string">&#x27;男&#x27;</span>);</span><br></pre></td></tr></table></figure><p>拓展：约束的修改</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 发现建表的时候约束设置的不正确,如何修改 </span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>;  <span class="comment">-- 查看现有约束的名称</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">drop</span> <span class="keyword">constraint</span> user_chk_1; <span class="comment">-- 删除现有约束</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="operator">=</span> <span class="number">121</span>;  <span class="comment">-- 如果有数据不满足约束,去除之 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> <span class="keyword">constraint</span> user_chk_1 <span class="keyword">check</span> (age <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">and</span> age <span class="operator">&lt;=</span> <span class="number">120</span>);  <span class="comment">-- 添加新的约束,操作结束</span></span><br></pre></td></tr></table></figure><p>外键约束概念外键用来让两张表的数据之间建立连接，从而保证数据的一致性和完整性<br><img src="/images/MySQL_DB_basic/18.png"> </p><p>具有外键的表称为子表，被关联的表叫做父表注意：数据库层面，未建立外键关联，所以无法保证数据的一致性和完整性。演示：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 外键约束 </span></span><br><span class="line"><span class="comment">-- 准备数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;部门名称&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;部门表&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;研发部&#x27;</span>), (<span class="number">2</span>, <span class="string">&#x27;市场部&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;财务部&#x27;</span>), (<span class="number">4</span>, <span class="string">&#x27;销售部&#x27;</span>), (<span class="number">5</span>, <span class="string">&#x27;总经办&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    job <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line">    salary <span class="type">int</span> comment <span class="string">&#x27;薪资&#x27;</span>,</span><br><span class="line">    entrydate <span class="type">date</span> comment <span class="string">&#x27;入职时间&#x27;</span>,</span><br><span class="line">    managerid <span class="type">int</span> comment <span class="string">&#x27;直属领导ID&#x27;</span>,</span><br><span class="line">    dept_id <span class="type">int</span> comment <span class="string">&#x27;部门ID&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;员工表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (name, age, job, salary, entrydate, managerid, dept_id) <span class="keyword">values</span> (<span class="string">&#x27;金庸&#x27;</span>, <span class="number">66</span>, <span class="string">&#x27;总裁&#x27;</span>, <span class="number">20000</span>, <span class="string">&#x27;2000-01-01&#x27;</span>, <span class="keyword">null</span>, <span class="number">5</span>), (<span class="string">&#x27;张无忌&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;项目经理&#x27;</span>, <span class="number">12500</span>, <span class="string">&#x27;2005-12-05&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;杨逍&#x27;</span>, <span class="number">33</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">8400</span>, <span class="string">&#x27;2000-11-03&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>), (<span class="string">&#x27;韦一笑&#x27;</span>, <span class="number">48</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">11000</span>, <span class="string">&#x27;2002-02-05&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;常遇春&#x27;</span>, <span class="number">43</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">10500</span>, <span class="string">&#x27;2004-09-07&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>), (<span class="string">&#x27;小昭&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;程序员鼓励师&#x27;</span>, <span class="number">6600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 以上,没有设置物理外键,无法保证数据之间的一致性和完整性</span></span><br></pre></td></tr></table></figure><p>语法：添加外键</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名(</span><br><span class="line">    字段名 数据类型,</span><br><span class="line">    ..</span><br><span class="line">    [<span class="keyword">CONSTRAINT</span>] [外键名称] <span class="keyword">FOREIGN</span> KEY (外键字段名) <span class="keyword">REFERENCES</span> 主表(主表列名)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> 外键名称 <span class="keyword">FOREIGN</span> KEY(外键字段名) <span class="keyword">REFERENCES</span> 主表(主表列名);</span><br><span class="line">案例：</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 成功删除 </span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;研发部&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加外键 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dept_id <span class="keyword">foreign</span> key(dept_id) <span class="keyword">references</span> dept(id);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>; <span class="comment">-- Cannot delete or update a parent row: a foreign key constraint fails</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除外键 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">drop</span> <span class="keyword">foreign</span> key fk_emp_dept_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 删除成功</span></span><br></pre></td></tr></table></figure><p>删除&#x2F;更新行为<br><img src="/images/MySQL_DB_basic/19.png"> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> 外键名称 <span class="keyword">FOREIGN</span> KEY (外键字段）</span><br><span class="line"><span class="keyword">REFERENCES</span> 主表 （主表字段名）</span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 外键的删除和更新行为 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dept_id</span><br><span class="line"><span class="keyword">foreign</span> key(dept_id) <span class="keyword">references</span> dept(id)</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade;  <span class="comment">-- 级联更新/删除 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 级联更新操作 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="keyword">update</span> dept <span class="keyword">set</span> id <span class="operator">=</span> <span class="number">6</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;  <span class="comment">-- 查看子表，的确更新为6了，这就是cascade的作用 </span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">6</span>; <span class="comment">-- 子表数据也被删除了 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- SET NULL 操作 </span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> emp;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 准备数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;部门名称&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;部门表&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;研发部&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;市场部&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;财务部&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;销售部&#x27;</span>), (<span class="number">5</span>, <span class="string">&#x27;总经办&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    job <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line">    salary <span class="type">int</span> comment <span class="string">&#x27;薪资&#x27;</span>,</span><br><span class="line">    entrydate <span class="type">date</span> comment <span class="string">&#x27;入职时间&#x27;</span>,</span><br><span class="line">    managerid <span class="type">int</span> comment <span class="string">&#x27;直属领导ID&#x27;</span>,</span><br><span class="line">    dept_id <span class="type">int</span> comment <span class="string">&#x27;部门ID&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;员工表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (name, age, job, salary, entrydate, managerid, dept_id)</span><br><span class="line"><span class="keyword">values</span> (<span class="string">&#x27;金庸&#x27;</span>, <span class="number">66</span>, <span class="string">&#x27;总裁&#x27;</span>, <span class="number">20000</span>, <span class="string">&#x27;2000-01-01&#x27;</span>, <span class="keyword">null</span>, <span class="number">5</span>),</span><br><span class="line">(<span class="string">&#x27;张无忌&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;项目经理&#x27;</span>, <span class="number">12500</span>, <span class="string">&#x27;2005-12-05&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;杨逍&#x27;</span>, <span class="number">33</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">8400</span>, <span class="string">&#x27;2000-11-03&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;韦一笑&#x27;</span>, <span class="number">48</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">11000</span>, <span class="string">&#x27;2002-02-05&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;常遇春&#x27;</span>, <span class="number">43</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">10500</span>, <span class="string">&#x27;2004-09-07&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;小昭&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;程序员鼓励师&#x27;</span>, <span class="number">6600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加外键 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dept_id <span class="keyword">foreign</span> key(dept_id)</span><br><span class="line"><span class="keyword">references</span> dept(id) <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">set</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span>; </span><br><span class="line"><span class="comment">-- set null更新/删除 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除id = 1的数据</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp; </span><br><span class="line"><span class="comment">-- 可见所有emp 原有dept_id = 1的数据现在 dept_id的值为 null</span></span><br></pre></td></tr></table></figure><p>总结1. 非空约束 not null2. 唯一约束 unique3. 主键约束 primary key (自增: AUTO_INCREMENT， ORACLE没有这个，而是SEQUENCE)4. 默认约束 default5. 检查约束 check6. 外键约束 foreign key<br>多表查询多表关系各个表结构之间存在各种联系：一对多 （多对一）多对多一对一一对多（多对一）案例：部门 与 员工 的关系关系：一个部门对应多个员工，一个员工对应一个部门实现：再多的一方建立外键，只想一的一方的主键<br><img src="/images/MySQL_DB_basic/20.png"> </p><p>多对多案例：学生 与 课程的关系关系：一个学生可以选择多门课程，一门课程也可以供多个学生选择实现：建立第三张中间表，中间层至少包含两个外键，分别关联两方主键<br><img src="/images/MySQL_DB_basic/21.png"> </p><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多对多 </span></span><br><span class="line"><span class="comment">-- 学生表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line">  id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    <span class="keyword">no</span> <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;学号&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;学生表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student</span><br><span class="line"><span class="keyword">values</span> (<span class="keyword">null</span>, <span class="string">&#x27;黛绮丝&#x27;</span>, <span class="string">&#x27;2000100101&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;谢逊&#x27;</span>, <span class="string">&#x27;2000100102&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;殷天正&#x27;</span>, <span class="string">&#x27;2000100103&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;韦一笑&#x27;</span>, <span class="string">&#x27;2000100104&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 课程表 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> course(</span><br><span class="line">  id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;课程名称&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;课程表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> course <span class="keyword">values</span> (<span class="keyword">null</span>, <span class="string">&#x27;Java&#x27;</span>), (<span class="keyword">null</span>, <span class="string">&#x27;PHP&#x27;</span>), (<span class="keyword">null</span>, <span class="string">&#x27;MySQL&#x27;</span>), (<span class="keyword">null</span>, <span class="string">&#x27;Hadoop&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 学生课程关系表 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student_course(</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;主键&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    studentid <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;学生ID&#x27;</span>,</span><br><span class="line">    courseid <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;课程ID&#x27;</span>,</span><br><span class="line">    <span class="keyword">constraint</span> fk_courseid <span class="keyword">foreign</span> key (courseid) <span class="keyword">references</span> course (id),</span><br><span class="line">    <span class="keyword">constraint</span> fk_student_id <span class="keyword">foreign</span> key (studentid) <span class="keyword">references</span> student(id)</span><br><span class="line">) comment <span class="string">&#x27;学生课程中间表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student_course <span class="keyword">values</span> (<span class="keyword">null</span>, <span class="number">1</span>, <span class="number">1</span>), (<span class="keyword">null</span>, <span class="number">1</span>, <span class="number">2</span>), (<span class="keyword">null</span>, <span class="number">1</span>, <span class="number">3</span>), (<span class="keyword">null</span>, <span class="number">2</span>, <span class="number">2</span>), (<span class="keyword">null</span>, <span class="number">2</span>, <span class="number">3</span>), (<span class="keyword">null</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">describe</span> student_course;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> studenstudent_coursestudent_coursestudent_coursestudent_coursestudent_courset_course;</span><br></pre></td></tr></table></figure><p>.一对一案例：用户 和 用户详情的关系关系：一对一关系，多用于单表拆分，将一张表的基础字段放在一张表中，其他详情字段放在另一张表中，以提升操作效率实现：在任意一方加入外键，关联另一方的主键，并且设置外键为唯一的（UNIQUE）图例：![]<img src="/images/MySQL_DB_basic/22.png"> </p><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 一对一</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_user (</span><br><span class="line">  id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">1</span>) comment <span class="string">&#x27;1: 男，2: 女&#x27;</span>,</span><br><span class="line">    phone <span class="type">char</span>(<span class="number">11</span>) comment <span class="string">&#x27;手机号&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;用户基本信息表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_user_edu (</span><br><span class="line">  id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    degree <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;学历&#x27;</span>,</span><br><span class="line">    major <span class="type">varchar</span>(<span class="number">50</span>) comment <span class="string">&#x27;专业&#x27;</span>,</span><br><span class="line">    primaryschool <span class="type">varchar</span>(<span class="number">50</span>) comment <span class="string">&#x27;小学&#x27;</span>,</span><br><span class="line">    middleschool <span class="type">varchar</span>(<span class="number">50</span>) comment <span class="string">&#x27;中学&#x27;</span>,</span><br><span class="line">    university <span class="type">varchar</span>(<span class="number">50</span>) comment <span class="string">&#x27;大学&#x27;</span>,</span><br><span class="line">    userid <span class="type">int</span> <span class="keyword">UNIQUE</span> comment <span class="string">&#x27;用户ID&#x27;</span>,</span><br><span class="line">    <span class="keyword">constraint</span> fk_userid <span class="keyword">foreign</span> key (userid) <span class="keyword">references</span> tb_user(id)</span><br><span class="line">) comment <span class="string">&#x27;用户教育信息表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_user(id, name, age, gender, phone) <span class="keyword">values</span></span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;黄渤&#x27;</span>, <span class="number">45</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;18800001111&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;冰冰&#x27;</span>, <span class="number">35</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;18800002222&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;码云&#x27;</span>, <span class="number">55</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;18800008888&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;李彦宏&#x27;</span>, <span class="number">50</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;18800009999&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_user_edu <span class="keyword">values</span></span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;本科&#x27;</span>, <span class="string">&#x27;舞蹈&#x27;</span>, <span class="string">&#x27;青岛市第一小学&#x27;</span>, <span class="string">&#x27;青岛市第一中学&#x27;</span>, <span class="string">&#x27;北京电影学院&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;硕士&#x27;</span>, <span class="string">&#x27;表演&#x27;</span>, <span class="string">&#x27;朝阳区第一小学&#x27;</span>, <span class="string">&#x27;朝阳区第一中学&#x27;</span>, <span class="string">&#x27;上海戏剧学院&#x27;</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;本科&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="string">&#x27;杭州市第一小学&#x27;</span>, <span class="string">&#x27;杭州市第一中学&#x27;</span>, <span class="string">&#x27;杭州示范大学&#x27;</span>, <span class="number">3</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;本科&#x27;</span>, <span class="string">&#x27;计算机&#x27;</span>, <span class="string">&#x27;阳泉第一小学&#x27;</span>, <span class="string">&#x27;阳泉第一中学&#x27;</span>, <span class="string">&#x27;清华大学&#x27;</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>多表查询概述概述：指从多张表中查询数据笛卡尔积：指在数学中，两个集合的所有组合情况（在多表查询时，需要消除无效的笛卡尔积）<br><img src="/images/MySQL_DB_basic/23.png"> </p><p>案例:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数据准备 </span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> emp;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;部门名称&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;部门表&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;研发部&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;市场部&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;财务部&#x27;</span>), (<span class="number">4</span>, <span class="string">&#x27;销售部&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;总经办&#x27;</span>), (<span class="number">6</span>, <span class="string">&#x27;人事部&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    job <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line">    salary <span class="type">int</span> comment <span class="string">&#x27;薪资&#x27;</span>,</span><br><span class="line">    entrydate <span class="type">date</span> comment <span class="string">&#x27;入职时间&#x27;</span>,</span><br><span class="line">    managerid <span class="type">int</span> comment <span class="string">&#x27;直属领导ID&#x27;</span>,</span><br><span class="line">    dept_id <span class="type">int</span> comment <span class="string">&#x27;部门ID&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;员工表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (name, age, job, salary, entrydate, managerid, dept_id)</span><br><span class="line"><span class="keyword">values</span></span><br><span class="line">(<span class="string">&#x27;金庸&#x27;</span>, <span class="number">66</span>, <span class="string">&#x27;总裁&#x27;</span>, <span class="number">20000</span>, <span class="string">&#x27;2000-01-01&#x27;</span>, <span class="keyword">null</span>, <span class="number">5</span>),</span><br><span class="line">(<span class="string">&#x27;张无忌&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;项目经理&#x27;</span>, <span class="number">12500</span>, <span class="string">&#x27;2005-12-05&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;杨逍&#x27;</span>, <span class="number">33</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">8400</span>, <span class="string">&#x27;2000-11-03&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;韦一笑&#x27;</span>, <span class="number">48</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">11000</span>, <span class="string">&#x27;2002-02-05&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;常遇春&#x27;</span>, <span class="number">43</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">10500</span>, <span class="string">&#x27;2004-09-07&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;小昭&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;程序员鼓励师&#x27;</span>, <span class="number">6600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;灭绝&#x27;</span>, <span class="number">60</span>, <span class="string">&#x27;财务总监&#x27;</span>, <span class="number">8500</span>, <span class="string">&#x27;2002-10-12&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;周芷若&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;会计&#x27;</span>, <span class="number">48000</span>, <span class="string">&#x27;2006-10-12&#x27;</span>, <span class="number">7</span>, <span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;丁敏君&#x27;</span>, <span class="number">23</span>, <span class="string">&#x27;出纳&#x27;</span>, <span class="number">5250</span>, <span class="string">&#x27;2009-10-12&#x27;</span>, <span class="number">7</span>, <span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;赵敏&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;市场部总监&#x27;</span>, <span class="number">12500</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;路障可&#x27;</span>, <span class="number">56</span>, <span class="string">&#x27;职员&#x27;</span>, <span class="number">3750</span>, <span class="string">&#x27;2006-10-12&#x27;</span>, <span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;和笔翁&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;职员&#x27;</span>, <span class="number">3750</span>, <span class="string">&#x27;2007-10-12&#x27;</span>, <span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;房东白&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;职员&#x27;</span>, <span class="number">5500</span>, <span class="string">&#x27;2009-10-12&#x27;</span>, <span class="number">102</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;张三丰&#x27;</span>, <span class="number">88</span>, <span class="string">&#x27;销售总监&#x27;</span>, <span class="number">14000</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">1</span>, <span class="number">4</span>),</span><br><span class="line">(<span class="string">&#x27;玉莲舟&#x27;</span>, <span class="number">38</span>, <span class="string">&#x27;销售&#x27;</span>, <span class="number">4600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">14</span>, <span class="number">4</span>),</span><br><span class="line">(<span class="string">&#x27;宋远桥&#x27;</span>, <span class="number">40</span>, <span class="string">&#x27;销售&#x27;</span>, <span class="number">4600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">14</span>, <span class="number">4</span>),</span><br><span class="line">(<span class="string">&#x27;陈友谅&#x27;</span>, <span class="number">42</span>, <span class="string">&#x27;null&#x27;</span>, <span class="number">2000</span>, <span class="string">&#x27;2011-10-12&#x27;</span>, <span class="number">1</span>, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> <span class="keyword">foreign</span> key fk_deptid (dept_id)</span><br><span class="line"><span class="keyword">references</span> dept(id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 多表查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp, dept;  <span class="comment">-- 查出来的结果好像比想象中要多 - 笛卡尔积 17 * 6 = 102 条</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp, dept <span class="keyword">where</span> emp.dept_id <span class="operator">=</span> dept.id;</span><br></pre></td></tr></table></figure><p>多表查询分类- 连接查询    - 内连接: 相当于查询A.B交集部分的数据    </p><ul><li>外连接:        <br>左外连接: 查询左表中的所有数据，以及交集部分数据        <br>右外连接：查询右表中的所有数据，以及交集部分数据   </li><li>自连接：当前表与自身的连接查询，自连接必须使用表别名\</li><li>子查询<br>内连接内连接查询语法：    <br>隐式内连接：</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段列表 <span class="keyword">from</span> 表<span class="number">1</span>, 表<span class="number">2</span> <span class="keyword">where</span> 条件...;</span><br></pre></td></tr></table></figure><p>    显式内连接：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段列表 <span class="keyword">from</span> 表<span class="number">1</span> [<span class="keyword">INNER</span>] <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 连接条件...;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 内连接演示</span></span><br><span class="line"><span class="comment">-- 1. 查询每一个员工的姓名,以及关联的部门的名称 (隐式内连接实现) </span></span><br><span class="line"><span class="keyword">select</span> e.name, d.name <span class="keyword">from</span> emp e, dept d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id;  </span><br><span class="line"><span class="comment">-- 起别名之后不能直接用表名访问字段了 </span></span><br><span class="line"><span class="keyword">select</span> emp.name, dept.name <span class="keyword">from</span> emp, dept <span class="keyword">where</span> emp.dept_id <span class="operator">=</span> dept.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询每一个员工的姓名以及关联的部门名称(显式内连接实现) </span></span><br><span class="line"><span class="keyword">select</span> e.name, d.name <span class="keyword">from</span> emp e </span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br></pre></td></tr></table></figure><p>外连接语法：    左外：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段名 <span class="keyword">from</span> 表<span class="number">1</span> <span class="keyword">left</span> [<span class="keyword">outer</span>] <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 条件... ;</span><br></pre></td></tr></table></figure><p>    右外：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段名 <span class="keyword">from</span> 表<span class="number">1</span> <span class="keyword">right</span> [<span class="keyword">outer</span>] <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 条件... ;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 外连接演示 </span></span><br><span class="line"><span class="comment">-- 1. 查询emp表所有数据， 和对应的部门信息 （左连接）</span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.name <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.name <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询dept表中所有数据，和对应的员工信息 （右连接） </span></span><br><span class="line"><span class="keyword">select</span> d.<span class="operator">*</span>, e.<span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 等价于：select d.*, e.* from dept d left outer join emp e  on e.dept_id = d.id;</span></span><br></pre></td></tr></table></figure><p>自连接语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段列表 <span class="keyword">from</span> 表A 别名A <span class="keyword">join</span> 表A 别名B <span class="keyword">on</span> 条件... ;</span><br></pre></td></tr></table></figure><p>自联结查询可以是内连接也可以是外连接案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 内连接演示 </span></span><br><span class="line"><span class="comment">-- 1. 查询员工及其所属的领导名字 </span></span><br><span class="line"><span class="comment">-- 表结构：emp表</span></span><br><span class="line"><span class="keyword">select</span> a.name employee, b.name manager <span class="keyword">from</span> emp a, emp b</span><br><span class="line"><span class="keyword">where</span> a.managerid <span class="operator">=</span> b.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询所有员工emp及其领导的名字emp，如果员工没有领导也需要查询出来 </span></span><br><span class="line"><span class="comment">-- 表结构：emp e1, emp e2</span></span><br><span class="line"><span class="keyword">select</span> e1.name employee, e2.name boss <span class="keyword">from</span> emp e1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> emp e2 <span class="keyword">on</span> e1.managerid <span class="operator">=</span> e2.id; <span class="comment">-- 左外</span></span><br></pre></td></tr></table></figure><p>联合查询关键字：union, union all语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段列表 表A ...</span><br><span class="line"><span class="keyword">UNION</span> [<span class="keyword">ALL</span>]</span><br><span class="line"><span class="keyword">select</span> 字段列表 表B ... ;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- union all, union</span></span><br><span class="line"><span class="comment">-- 1. 将薪资低于5000的员工，和年龄大于50的员工全部查询出来 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&lt;</span> <span class="number">5000</span></span><br><span class="line"><span class="keyword">union</span> # <span class="keyword">union</span>合并后去重，<span class="keyword">union</span> <span class="keyword">all</span>则没有去重 </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line"># 如果第二个查询只查询name，则无法使用<span class="keyword">union</span>因为列数量不同</span><br></pre></td></tr></table></figure><p>小结：</p><ul><li><p>联合查询多张表的列数必须保持一致，字段类型也必须一致</p></li><li><p>union all 直接合并，union则会去重</p></li></ul><p>子查询概念：SQL语句中嵌套SELECT语句，成为嵌套查询，又称子查询语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t1 <span class="keyword">where</span> column1 <span class="operator">=</span> (<span class="keyword">select</span> column1 <span class="keyword">from</span> t2);</span><br></pre></td></tr></table></figure><p>注意 - 子查询外部语句可以是insert&#x2F;update&#x2F;delete&#x2F;select的任何一个。<br>分类：子查询结果不同，可以分为：    标量子查询 （子查询结果为单个值）    列子查询 （子查询结果为一列）    行子查询 （子查询结果为一行）    表子查询 （子查询结果为多行多列）<br>根据子查询位置，分为：WHERE之后，FROM之后，SELECT之后。<br>标量子查询：概念：子查询返回结果为单个值（数字，字符串，日期等），最简单的形式，这种子查询称为标量子查询。常用的操作符：&#x3D; &lt;&gt; &gt; &gt;&#x3D; &lt; &lt;&#x3D;<br>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 标量子查询 </span></span><br><span class="line"><span class="comment">-- 1. 查询销售部所有员工信息 </span></span><br><span class="line"><span class="comment">-- a. 查询销售部部门id</span></span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;销售部&#x27;</span>;</span><br><span class="line"><span class="comment">-- b. 根据部门id查询员工信息 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line"><span class="comment">-- 使用子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="operator">=</span></span><br><span class="line">(<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;销售部&#x27;</span>);</span><br><span class="line"><span class="comment">-- 使用外连接 </span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> d.name <span class="operator">=</span> <span class="string">&#x27;销售部&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询在“房东白”入职之后的员工信息 </span></span><br><span class="line"><span class="comment">-- a. 查询房东白的入职时间 </span></span><br><span class="line"><span class="keyword">select</span> entrydate <span class="keyword">from</span> emp <span class="keyword">where</span> emp.name <span class="operator">=</span> <span class="string">&#x27;房东白&#x27;</span>;</span><br><span class="line"><span class="comment">-- b. 查询比房东白入职晚的员工 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2009-10-12&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span></span><br><span class="line">(<span class="keyword">select</span> entrydate <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;房东白&#x27;</span>);</span><br></pre></td></tr></table></figure><p>列子查询：概念：子查询返回的结果是一列（可以是多行），这种子查询称为列子查询常用的操作符：IN, NOT IN, ANY, SOME, ALL<br><img src="/images/MySQL_DB_basic/24.png"> </p><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列子查询 </span></span><br><span class="line"><span class="comment">-- 1. 查询“销售部”和“市场部”的所有员工信息 </span></span><br><span class="line"><span class="comment">-- a. 找到销售部和市场部的部门id</span></span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="keyword">in</span> (<span class="string">&#x27;销售部&#x27;</span>, <span class="string">&#x27;市场部&#x27;</span>);</span><br><span class="line"><span class="comment">-- b. 根据部门id，查询员工信息 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="keyword">in</span> (<span class="string">&#x27;销售部&#x27;</span>, <span class="string">&#x27;市场部&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询比财务部所有人工资都高的员工信息</span></span><br><span class="line"><span class="comment">-- 标量子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp a <span class="keyword">where</span> salary <span class="operator">&gt;</span> ( </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(salary) <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;财务部&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> <span class="keyword">all</span> (</span><br><span class="line"><span class="keyword">select</span> salary <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;财务部&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 比研发部任意一人工资高的员工信息 </span></span><br><span class="line"><span class="comment">-- 列子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> <span class="keyword">any</span> (</span><br><span class="line"><span class="keyword">select</span> salary <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span></span><br><span class="line">));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 标量子查询</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> (</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(e.salary) <span class="keyword">from</span> emp e <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> d.name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>行子查询概念：子查询返回的结果是一行（多列的）常用操作符：&#x3D;, &lt;&gt;, IN, NOT IN案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 行子查询 </span></span><br><span class="line"><span class="comment">-- 查询与张无忌薪资和直属领导相同的员工信息  </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> (salary, managerid) <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">select</span> salary, managerid <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张无忌&#x27;</span>);</span><br></pre></td></tr></table></figure><p>表子查询概念：子查询返回的结果是多行多列，这种子查询叫做表子查询常用操作符：IN案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 表子查询 </span></span><br><span class="line"><span class="comment">-- 1. 查询与路障可，宋远桥的职位和薪资相同的员工 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> (job, salary) <span class="keyword">in</span> (</span><br><span class="line"><span class="keyword">select</span> job, salary <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="keyword">in</span> (<span class="string">&#x27;路障可&#x27;</span>, <span class="string">&#x27;宋远桥&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询入职日期是“2006-01-01”之后的员工信息及其部门信息 </span></span><br><span class="line"><span class="keyword">select</span> a.<span class="operator">*</span>, b.<span class="operator">*</span> <span class="keyword">from</span> dept a </span><br><span class="line"><span class="keyword">right</span> <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2006-01-01&#x27;</span>) b</span><br><span class="line"><span class="keyword">on</span> a.id <span class="operator">=</span> b.dept_id;</span><br></pre></td></tr></table></figure><p>多表查询案例：<br><img src="/images/MySQL_DB_basic/25.png"> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多表查询案例 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> salgrade (</span><br><span class="line">  grade <span class="type">int</span>,</span><br><span class="line">    losal <span class="type">int</span>,</span><br><span class="line">    hisal <span class="type">int</span></span><br><span class="line">) comment <span class="string">&#x27;薪资等级表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade <span class="keyword">values</span></span><br><span class="line">(<span class="number">1</span>, <span class="number">0</span>, <span class="number">3000</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="number">3001</span>, <span class="number">5000</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="number">5001</span>, <span class="number">8000</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="number">8001</span>, <span class="number">10000</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="number">10001</span>, <span class="number">15000</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="number">15001</span>, <span class="number">20000</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="number">20001</span>, <span class="number">25000</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="number">25001</span>, <span class="number">30000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. 查询员工的姓名，年龄，职位，部门信息（隐式内连接） </span></span><br><span class="line"><span class="keyword">select</span> e.name, e.age, e.job, d.name <span class="keyword">from</span> emp e, dept d</span><br><span class="line"><span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询年龄小于30岁的员工的姓名，年龄，职位，部门信息（显式内连接） </span></span><br><span class="line"><span class="keyword">select</span> e.name, e.age, e.job, d.name</span><br><span class="line"><span class="keyword">from</span> emp e <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> e.age <span class="operator">&lt;</span> <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 查询拥有员工的部门的id，部门名称 </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> d.id, d.name <span class="keyword">from</span> dept d</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> emp e</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. 查询年龄大于40岁的员工，及其归属的部门名称；如果员工没有部门，也要展示出来 </span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.name <span class="keyword">from</span> </span><br><span class="line">emp e <span class="keyword">left</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> e.age <span class="operator">&gt;</span> <span class="number">40</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5. 查询所有员工的工资等级 </span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, sg.grade, sg.losal, sg.hisal <span class="keyword">from</span></span><br><span class="line">emp e <span class="keyword">left</span> <span class="keyword">join</span> salgrade sg</span><br><span class="line"><span class="keyword">on</span> e.salary <span class="operator">&gt;=</span> sg.losal <span class="keyword">and</span> e.salary <span class="operator">&lt;=</span> sg.hisal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, sg.grade <span class="keyword">from</span></span><br><span class="line">emp e, salgrade sg</span><br><span class="line"><span class="keyword">where</span> e.salary <span class="keyword">between</span> sg.losal <span class="keyword">and</span> sg.hisal;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6. 查询研发部所有员工的信息及工资等级 </span></span><br><span class="line"><span class="keyword">select</span> d.name, e.<span class="operator">*</span>, sg.grade <span class="keyword">from</span></span><br><span class="line">emp e <span class="keyword">join</span> salgrade sg <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.salary <span class="keyword">between</span> sg.losal <span class="keyword">and</span> sg.hisal</span><br><span class="line"><span class="keyword">and</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> d.name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    d.name, e.<span class="operator">*</span>, sg.grade</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    emp e,</span><br><span class="line">    dept d,</span><br><span class="line">    salgrade sg</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    e.salary <span class="keyword">BETWEEN</span> sg.losal <span class="keyword">AND</span> sg.hisal</span><br><span class="line">        <span class="keyword">AND</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line">        <span class="keyword">AND</span> d.name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span>;</span><br><span class="line"><span class="comment">-- ctrl + B </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7. 查询研发部的员工的平均工资 </span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(e.salary) <span class="string">&#x27;研发部平均工资&#x27;</span> <span class="keyword">from</span> emp e, dept d</span><br><span class="line"><span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">and</span> d.name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 8. 查询工资比灭绝高的员工信息 </span></span><br><span class="line"><span class="comment">-- 自连接 </span></span><br><span class="line"><span class="keyword">select</span> e2.<span class="operator">*</span> <span class="keyword">from</span> emp e1, emp e2</span><br><span class="line"><span class="keyword">where</span> e1.name <span class="operator">=</span> <span class="string">&#x27;灭绝&#x27;</span></span><br><span class="line"><span class="keyword">and</span> e2.salary <span class="operator">&gt;</span> e1.salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 子查询</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> (</span><br><span class="line"><span class="keyword">select</span> salary <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;灭绝&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 9. 查询比平均薪资高的员工信息 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> (</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(salary) <span class="keyword">from</span> emp</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 10. 查询低于本部门平均薪资的员工 </span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, avgsal.sal <span class="keyword">from</span> emp e <span class="keyword">join</span> (</span><br><span class="line"><span class="keyword">select</span> dept_id, <span class="built_in">avg</span>(salary) sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> dept_id) avgsal</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> avgsal.dept_id</span><br><span class="line"><span class="keyword">where</span> e.salary <span class="operator">&lt;</span> avgsal.sal;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 可以用子查询，目测效率更低因为对于每一行子查询都需要重新计算一下本部门平均薪资 </span></span><br><span class="line"><span class="comment">-- 第一步：计算本部门平均薪资：select avg(salary) from emp where dept_id = 1;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e2 <span class="keyword">where</span> e2.salary <span class="operator">&lt;</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">avg</span>(e1.salary) <span class="keyword">from</span> emp e1 <span class="keyword">where</span> e1.dept_id <span class="operator">=</span> e2.dept_id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 11. 查询所有部门信息并统计部门的员工人数 </span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(e.dept_id), d.name <span class="keyword">from</span> emp e <span class="keyword">right</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 子查询</span></span><br><span class="line"><span class="comment">-- 第一步，计算每个部门的人数 </span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp e <span class="keyword">where</span> e.dept_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第二步，得出结果 </span></span><br><span class="line"><span class="keyword">select</span> d.id, d.name, (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id) <span class="string">&#x27;人数&#x27;</span> <span class="keyword">from</span> dept d;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 12. 查询所有学生的选课情况，展示出学生名称，学号，课程名称 </span></span><br><span class="line"><span class="keyword">select</span> s.name <span class="string">&#x27;姓名&#x27;</span>, s.no <span class="string">&#x27;学号&#x27;</span>, c.name <span class="string">&#x27;课程名称&#x27;</span> <span class="keyword">from</span></span><br><span class="line">student s, course c , student_course sc</span><br><span class="line"><span class="keyword">where</span> s.id <span class="operator">=</span> sc.studentid</span><br><span class="line"><span class="keyword">and</span> sc. courseid <span class="operator">=</span> c.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student_course;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> course;</span><br></pre></td></tr></table></figure><p>多表查询-总结1. 多表关系多表之间的关系分为三类：    一对多：在多的一方设置外键，关联一的一方的主键    多对多：建立中间表，中间表包含两个外键，关联两张表的主键    一对一：用于表结构拆分，在其中任何一方设置外键（UNIQUE)，关联另一方的主键</p><blockquote><p>（一对一注：xx_order与xx_order_det就是这样的关系）</p></blockquote><p>2. 多表查询内连接    隐式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表A, 表B <span class="keyword">where</span> 条件....;</span><br></pre></td></tr></table></figure><p>    显式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表A <span class="keyword">inner</span> <span class="keyword">join</span> 表B <span class="keyword">on</span> 条件.....;</span><br></pre></td></tr></table></figure><p>外连接    左外：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> 表A <span class="keyword">left</span> <span class="keyword">join</span> 表B <span class="keyword">on</span> 条件...;</span><br></pre></td></tr></table></figure><p>    右外：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> 表A <span class="keyword">right</span> <span class="keyword">join</span> 表B <span class="keyword">on</span> 条件...;</span><br></pre></td></tr></table></figure><p>自连接：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表A 别名<span class="number">1</span>, 表B 别名<span class="number">2</span> <span class="keyword">where</span> 条件...;</span><br></pre></td></tr></table></figure><p>子查询：标量子查询，列子查询，行子查询，表子查询。<br>事务事务简介事务是一组操作的集合，它是一个不可分割的工作单位，事务会把所有操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。注意：默认MySQL的事务是自动提交的，即当执行一条DML语句，MySQL会隐式的提交事务。<br>事务操作案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 事务操作 </span></span><br><span class="line"><span class="comment">-- 数据准备 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> account (</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    money <span class="type">int</span> comment <span class="string">&#x27;余额&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;账户表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account</span><br><span class="line"><span class="keyword">values</span> (<span class="keyword">null</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="number">2000</span>), (<span class="keyword">null</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 恢复数据 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 转账操作 </span></span><br><span class="line"><span class="comment">-- 1. 查询张三的余额 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 将张三的账户余额减去1000 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">-</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 将李四账户余额+1000</span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">+</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;</span><br></pre></td></tr></table></figure><p>事务操作方式一：查看&#x2F;设置事务的提交方式</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@autocommit</span>;</span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@autocommit</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">-- 将提交方式改为手动</span></span><br></pre></td></tr></table></figure><p>提交事务</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure><p>回滚事务</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rollback</span>;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @<span class="variable">@autocommit</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@autocommit</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 恢复数据 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 转账操作 </span></span><br><span class="line"><span class="comment">-- 1. 查询张三的余额 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 将张三的账户余额减去1000 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">-</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 将李四账户余额+1000</span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">+</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">rollback</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;</span><br></pre></td></tr></table></figure><p>事务操作方式二：开启事务</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction 或者 <span class="keyword">begin</span></span><br></pre></td></tr></table></figure><p>提交事务</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">commit</span></span><br></pre></td></tr></table></figure><p>回滚事务</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rollback</span></span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式2</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@autocommit</span>;</span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@autocommit</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span>;  <span class="comment">-- 事务开始 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. 查询张三的余额 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 将张三的账户余额减去1000 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">-</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 将李四账户余额+1000</span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">+</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>; <span class="comment">-- 提交事务</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">rollback</span>; <span class="comment">-- 回滚事务</span></span><br></pre></td></tr></table></figure><p>commit 之前：<br><img src="/images/MySQL_DB_basic/26.png"> </p><p>commit 之后：<br><img src="/images/MySQL_DB_basic/27.png">  </p><p>出错了就rollback<br>事务四大特性（ACID）原子性 A - atomicity 事务是不可分割的最小操作单元，要么全部成功，要么全部失败。一致性 C - consistency 事务完成时，必须使所有数据都保持一致隔离性 I - isolation 数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境运行持久性 D - durability 事务一旦提交或回滚，它对数据库中数据的修改就是永久的<br>并发事务问题</p><table width="0"><colgroup><col style="width: 310px;"><col style="width: 310px;"></colgroup><tbody><tr style="height: 42px;"><td data-cell-id="9076-1646771121440-cell-0-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;background-color: rgb(223, 64, 42);text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(255, 255, 255);background-color: transparent;font-weight: bold;font-style: normal;text-decoration: none;">问题</span></p></td><td data-cell-id="9076-1646771121440-cell-0-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;background-color: rgb(223, 64, 42);text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(255, 255, 255);background-color: transparent;font-weight: bold;font-style: normal;text-decoration: none;">描述</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="9076-1646771121440-cell-1-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(194, 79, 74);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">脏读</span></p></td><td data-cell-id="9076-1646771121440-cell-1-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">一个事务读取到另一个事务未提交的数据</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="9076-1646771121440-cell-2-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(194, 79, 74);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">不可重复读</span></p></td><td data-cell-id="9076-1646771121440-cell-2-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">一个事务先后读取同一条记录，但两次读取的数据不同，称之为不可重复读</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="9076-1646771121440-cell-3-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(194, 79, 74);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">幻读</span></p></td><td data-cell-id="9076-1646771121440-cell-3-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">一个事务按照条件查询数据时，没有对应的数据行，但在插入数据时，发现这行数据已经存在了，好像出现了”幻影“。</span></p></td></tr></tbody></table>事务隔离级别<table width="0"><colgroup><col style="width: 155px;"><col style="width: 155px;"><col style="width: 155px;"><col style="width: 155px;"></colgroup><tbody><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-0-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">隔离级别</span></p></td><td data-cell-id="7274-1646771576710-cell-0-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">脏读</span></p></td><td data-cell-id="7274-1646771576710-cell-0-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">不可重复读</span></p></td><td data-cell-id="7274-1646771576710-cell-0-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">幻读</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-1-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">Read uncommitted</span></p></td><td data-cell-id="7274-1646771576710-cell-1-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td><td data-cell-id="7274-1646771576710-cell-1-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td><td data-cell-id="7274-1646771576710-cell-1-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-2-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">Read commiited (Oracle 默认）</span></p></td><td data-cell-id="7274-1646771576710-cell-2-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-2-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td><td data-cell-id="7274-1646771576710-cell-2-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-3-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">Repeatable Read (MySQL 默认）</span></p></td><td data-cell-id="7274-1646771576710-cell-3-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-3-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-3-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-4-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">Serializable</span></p></td><td data-cell-id="7274-1646771576710-cell-4-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-4-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-4-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td></tr></tbody></table>查看事务隔离级别：<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @<span class="keyword">@transaction_isolation</span>;</span><br></pre></td></tr></table></figure><p>设置事务隔离级别：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> [session<span class="operator">|</span><span class="keyword">global</span>] transaction isolation level</span><br><span class="line">&#123;read uncommitted <span class="operator">|</span> read committed <span class="operator">|</span> repeatable read <span class="operator">|</span> serializable&#125;</span><br></pre></td></tr></table></figure><p>案例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 设置事务隔离级别案例 </span></span><br><span class="line"><span class="comment">-- 演示脏读 </span></span><br><span class="line"><span class="keyword">set</span> session transaction isolation level read uncommitted;</span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- id = 1, money = 2000;</span></span><br><span class="line"><span class="comment">-- 新开个session，执行</span></span><br><span class="line"># <span class="keyword">start</span> transaction</span><br><span class="line"># <span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> <span class="number">2001</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 发现数据更新了 money = 2001</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 演示不可重复读 </span></span><br><span class="line"><span class="comment">-- 在一个事务里修改隔离级别是不会起作用的 </span></span><br><span class="line"><span class="keyword">set</span> session transaction isolation level read committed;</span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 发现数据是没有更新的 money = 2000;</span></span><br><span class="line"><span class="comment">-- 新开的session里执行</span></span><br><span class="line"># <span class="keyword">commit</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 发现数据更新了 money = 2001;</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 演示可重复读 </span></span><br><span class="line"><span class="keyword">set</span> session transaction isolation level repeatable read;</span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- id = 1, money = 2001</span></span><br><span class="line"><span class="comment">-- 新开的session里执行 </span></span><br><span class="line"># being</span><br><span class="line"># <span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> <span class="number">2005</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"># <span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 发现数据没有更新 money = 2001</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account; <span class="comment">-- 这时候在上一个事务之外，读到了 money = 2005</span></span><br><span class="line"><span class="comment">-- 演示幻读 </span></span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 这时候只读到两条数据 </span></span><br><span class="line"><span class="comment">-- 在新session里执行 </span></span><br><span class="line"># <span class="keyword">begin</span>;</span><br><span class="line"># <span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"># <span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">2000</span>);  </span><br><span class="line"><span class="comment">-- 执行失败，原因是新session读已提交 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 依然读不到 id为3的数据，称之为幻读 </span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 演示串行化 </span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> account <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">set</span> session transaction isolation level serializable;</span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 这时候只读到两条数据 </span></span><br><span class="line"><span class="comment">-- 在新开session里执行 </span></span><br><span class="line"># <span class="keyword">begin</span>;</span><br><span class="line"># <span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"># 发现新session卡住了，不能动弹 </span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"># 发现新session里的<span class="keyword">insert</span>执行完成了。</span><br></pre></td></tr></table></figure><p>注意：事务隔离级别越高，数据越安全，但是效率也越低。<br>总结：1. 事务简介事务是一组操作的集合，一荣俱荣，一损俱损2. 事务操作</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction; 或者 <span class="keyword">begin</span>; <span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">commit</span><span class="operator">/</span><span class="keyword">rollback</span>; <span class="comment">-- 提交/回滚</span></span><br></pre></td></tr></table></figure><p>事务3. 事务四大特性原子性A、一致性C、隔离性I、持久性D4. 并发事务问题脏读、不可重复读、幻读5. 事务隔离级别read uncommitted, read committed, repeatable read, serializable<br>基础篇总结MySQL概述 - SQL -函数 - 约束 - 多表查询 - 事务</p><p>转载自本人公众号<a href="https://mp.weixin.qq.com/s/TSVTzhUvrfqaWGSNDH2nmw">笔记：MySQL数据库 - 基础篇</a>，归类为原创。</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h1&gt;&lt;p&gt;是一种 关系型数据库：建立在关系模型上，由多张互相连接的二维表组成的数据库。关系数据库 特点：1. 使用表存储数据，格式统一，便于维护2. 使用SQL语言操作，标准统一，使用方便&lt;br&gt;MySQL的数据模型从客户端到DBMS，再到数据库，最后到达数据库中的表  &lt;/p&gt;</summary>
    
    
    
    <category term="中间件" scheme="https://xqtony.github.io/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
    <category term="MySQL" scheme="https://xqtony.github.io/tags/MySQL/"/>
    
    <category term="原创" scheme="https://xqtony.github.io/tags/%E5%8E%9F%E5%88%9B/"/>
    
  </entry>
  
</feed>
