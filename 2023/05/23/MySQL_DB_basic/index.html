<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>MySQL数据库 - 基础篇 | Tony&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  
  
    <link rel="alternate" href="/atom.xml" title="Tony's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/localshare/css/share.css">

  
  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tony&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/."><i class="fa fa-home"></i> Home</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="search"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-MySQL_DB_basic" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      MySQL数据库 - 基础篇
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2023-05-22T16:28:19.611Z" itemprop="datePublished">05/23/2023</time>
</span>
      
      
        <span class="article-views">
  <i class="fa fa-views"></i>
  <i id="busuanzi_container_page_pv">
      <i id="busuanzi_value_page_pv"></i>
  </i>
</span>

      
      
<a href="/2023/05/23/MySQL_DB_basic/#comments" class="article-comment-link">
  
    
    
    
    
    
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>是一种 关系型数据库：建立在关系模型上，由多张互相连接的二维表组成的数据库。关系数据库 特点：1. 使用表存储数据，格式统一，便于维护2. 使用SQL语言操作，标准统一，使用方便<br>MySQL的数据模型从客户端到DBMS，再到数据库，最后到达数据库中的表  </p>
<span id="more"></span>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZlapGm0xEXe4Nkz1vbPodUEl3f97HanNtyd7mRJhTMhmTkUibmYPzqVA/640?wx_fmt=png">  </p>
<p>MySQL启动的命令</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net <span class="keyword">start</span> mysql80  # 这里的mysql80是注册在Windows中的服务名称</span><br><span class="line">net stop mysql80</span><br></pre></td></tr></table></figure>

<p>MySQL客户端连接MySQL自带的客户端命令行CMD执行命令：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h <span class="number">127.0</span>.<span class="number">0.1</span> -<span class="selector-tag">P</span> <span class="number">3306</span> -u root -<span class="selector-tag">p</span></span><br></pre></td></tr></table></figure>

<p>SQLSQL通用语法1. SQL语句单行，多行均可，默认分号结尾2. 使用空格&#x2F;缩进以增加可读性3. 不区分大小写，推荐关键字使用大写4. 注释：单行注释：– 通用，# MySQL独有多行注释：&#x2F;**&#x2F;<br>SQL分类：DDL: Data Definition Language 数据定义语言，用来定义数据库对象 （数据库，表，字段）DML: Data Manipulation Language 数据操作语言，用来对数据库表中的数据进行增删改DQL: Data Query Language 数据查询语言，用来查询数据库中表的记录DCL: Data Control Language 数据控制语言，用来创建数据库用户、控制数据库的访问权限<br>DDL-数据库操作:查询查询所有数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br></pre></td></tr></table></figure>

<p>查询当前数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATABASE();</span><br></pre></td></tr></table></figure>

<p>创建</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] 数据库名 [<span class="keyword">DEFAULT</span> CHARSET 字符集] [<span class="keyword">COLLATE</span> 排序规则]</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> test; <span class="comment">-- 如果不存在，创建test数据库</span></span><br><span class="line"><span class="keyword">create</span> database itheima <span class="keyword">default</span> charset utf8mb4;  <span class="comment">-- 创建utf8mb4字符集的itheima 数据库</span></span><br></pre></td></tr></table></figure>

<p>删除</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE [IF <span class="keyword">EXISTS</span>] 数据库名</span><br></pre></td></tr></table></figure>

<p>使用数据库</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">USE</span> 数据库名</span><br></pre></td></tr></table></figure>

<p>查询当前数据库全部表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br></pre></td></tr></table></figure>

<p>查询表结构</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DESC</span> 表名 或者 DESCRIBE 表名</span><br></pre></td></tr></table></figure>

<p>查询指定表的建表语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名</span><br></pre></td></tr></table></figure>

<p>DDL-表操作-创建</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名(</span><br><span class="line">    字段<span class="number">1</span>   字段<span class="number">1</span>类型[COMMENT  字段<span class="number">1</span>注释],</span><br><span class="line">    字段<span class="number">2</span>   字段<span class="number">2</span>类型[COMMENT  字段<span class="number">2</span>注释],</span><br><span class="line">    ......</span><br><span class="line">    字段n   字段n类型[COMMENT  字段n注释]</span><br><span class="line">)[COMMENT 注释];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>第二章讲解InnoDB底层原理</p>
</blockquote>
<p>DDL-表操作-数据类型主要分三类：数值类型，字符串类型，日期时间类型数值类型<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZT9wSwMStUh5muxADhLg3WufwsIr5syPnofMrU2vPu6v4HloHWDet3g/640?wx_fmt=png">  </p>
<p>实例：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age TINYINT UNSIGNED  # <span class="number">0</span>~<span class="number">255</span>的整数</span><br><span class="line">score DOUBLE(<span class="number">4</span>, <span class="number">1</span>)   <span class="selector-id">#100</span>.<span class="number">0</span>最长是<span class="number">4</span>，填<span class="number">4</span>，<span class="number">80.5</span>，<span class="number">70.5</span>，最多一位小数，填<span class="number">1</span>。</span><br></pre></td></tr></table></figure>

<p>字符串类型<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZgmWI7NBf2CUfCcne49ud2aeOesibpLyyHspT4OWWm0A1VKqAIkvbxzw/640?wx_fmt=png">  </p>
<p>定长&#x2F;变长字符串的区别</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">char</span>(<span class="number">10</span>) <span class="meta"># 长度固定为10，没用的部分用空格补位  --&gt; 性能好？</span></span><br><span class="line">varchar(<span class="number">10</span>) <span class="meta"># 长度最长不超过10，小于10时体现实际长度  --&gt; 性能较差</span></span><br></pre></td></tr></table></figure>

<p>实例：用户名 username 用那个更好呢？答案：varchar(50)更好。因为用户的用户名不是定长的，使用varchar可以节约空间性别 gender 用哪个？答案：char(1)<br>日期类型<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7Z8J50IialfneKVicX9icqBiaZ84aoOf2fw7JlvcUYFHveb9fYRrwDHC8QPg/640?wx_fmt=png">  </p>
<p>实例：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">birthday</span> date  <span class="comment"># 生日用date类型更合适</span></span><br></pre></td></tr></table></figure>

<p>案例：根据需求创建表（设计合理的数据类型、长度）<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZgvoZfFiaXpoK2kllClmCFP7dhBibabkjPPWk1Qp2xViaprvVBvh0kibedQ/640?wx_fmt=png">  </p>
<p>答案：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">    id <span class="type">int</span> comment <span class="string">&#x27;编号&#x27;</span>,</span><br><span class="line">    workno <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;工号&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">1</span>) comment <span class="string">&#x27;性别&#x27;</span>,</span><br><span class="line">    age tinyint unsigned comment <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    idcard <span class="type">char</span>(<span class="number">18</span>) comment <span class="string">&#x27;身份证号&#x27;</span>,</span><br><span class="line">    entrydate <span class="type">date</span> comment <span class="string">&#x27;入职时间&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;员工表&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>DDL-表操作-修改添加字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> 字段名 类型（长度） [COMMENT 注释] [约束];</span><br></pre></td></tr></table></figure>

<p>案例：为emp表添加一个字段“昵称”为nickname，类型为varchar(20)答案：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">add</span> nickname <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;昵称&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>修改数据类型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 MODIFY 字段名 新数据类型(长度);</span><br></pre></td></tr></table></figure>

<p>修改字段名和字段类型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 CHANGE 旧字段名 新字段名称 类型（长度） [COMMENT 注释] [约束];</span><br></pre></td></tr></table></figure>

<p>案例：将emp表的nickname 修改为username，类型为varchar(30)答案：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp change nickname username <span class="type">varchar</span>(<span class="number">30</span>) comment <span class="string">&#x27;用户名&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>删除字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">DROP</span> 字段名;</span><br></pre></td></tr></table></figure>

<p>案例：删除emp中的username列答案：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">drop</span> username;</span><br></pre></td></tr></table></figure>

<p>修改表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 RENAME <span class="keyword">TO</span> 新表名;</span><br></pre></td></tr></table></figure>

<p>案例：将emp表表名修改为employee</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp RENAME <span class="keyword">TO</span> employee;</span><br></pre></td></tr></table></figure>

<p>删除表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [IF <span class="keyword">EXISTS</span>] 表名;</span><br></pre></td></tr></table></figure>

<p>删除指定表，并重新创建该表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> 表名;</span><br></pre></td></tr></table></figure>

<p>MySQL图形化界面：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZtpatQbPZwCiaHofrzCQMulib5c8k25fTlO1zha5xItqBt4zr5KXefkbQ/640?wx_fmt=png">MySQL Workbench<br>DML-介绍DML的全称是Data Manipulation Lanagage (数据操作语言），用来对数据表中的数据记录进行增删改操作。添加数据 (INSERT)修改数据 (UPDATE)删除数据 (DELETE)<br>DML-添加数据1. 给指定字段添加数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 (字段<span class="number">1</span>， 字段<span class="number">2</span>, ...) <span class="keyword">VALUES</span> (值<span class="number">1</span>， 值<span class="number">2</span>, ...);</span><br></pre></td></tr></table></figure>

<p>2. 给全部字段添加数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 VALUSE (值<span class="number">1</span>， 值<span class="number">2</span>, ...);</span><br></pre></td></tr></table></figure>

<p>3. 批量添加数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 (字段名<span class="number">1</span>，字段名<span class="number">2</span>，...) VALUSE (值<span class="number">1</span>，值<span class="number">2</span>，...), VALUSE (值<span class="number">1</span>，值<span class="number">2</span>，...);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 VALUSE (值<span class="number">1</span>，值<span class="number">2</span>，...), VALUSE (值<span class="number">1</span>，值<span class="number">2</span>，...);</span><br></pre></td></tr></table></figure>

<p>注意：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZFicnFAbTWYLbnKMhTBFv6PGOOibDm0bwBKArNYxUWM6Y8aBaqrYlWNCg/640?wx_fmt=png">  </p>
<p>DML-修改数据UPDATE 表名 SET 字段名1&#x3D;值1, 字段名2&#x3D;值2, … [WHERE 条件];注意：如果修改的条件没有，则会修改整张表的数据。案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- id = 1 的名字修改为it 黑马</span></span><br><span class="line"><span class="keyword">update</span> employee <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;kelly&#x27;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- id = 1 的名字修改为Kelly, gender 修改为女</span></span><br><span class="line"><span class="keyword">update</span> employee <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;kelly&#x27;</span>, gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 将所有员工的入职时间设定为2008-01-01</span></span><br><span class="line"><span class="keyword">update</span> employee <span class="keyword">set</span> entrydate <span class="operator">=</span> <span class="string">&#x27;2008-01-01&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>DML-删除数据DELETE FROM 表名 [WHERE 条件];注意：DELETE语句的条件可有可无，没有的情况下会删除整张表的数据。DELETE语句不能删除某一个字段的值（可以使用UPDATE）。案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除gender为W的员工</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employee <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除所有员工</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employee;</span><br></pre></td></tr></table></figure>

<p>DQL-介绍DQL是Data Query Language 的缩写，用来查询数据库中表的记录。查询关键字：SELECT<br>DQL-语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名列表</span><br><span class="line"><span class="keyword">WHERE</span> 条件列表 <span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组字段列表</span><br><span class="line"><span class="keyword">HAVING</span> 分组后条件列表 <span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序字段列表</span><br><span class="line">LIMIT 分页参数</span><br></pre></td></tr></table></figure>

<p>基本查询条件查询 WHERE聚合函数 count(), max(), min(), avg(), sum()分组查询 GROUP BY排序查询 ORDER BY分页查询 LIMIT<br>DQL-基本查询1. 查询返回多个字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段<span class="number">1</span>，字段<span class="number">2</span>，字段<span class="number">3.</span>.. <span class="keyword">FROM</span> 表名;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>

<p>2. 设置别名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段<span class="number">1</span> [<span class="keyword">AS</span> 别名<span class="number">1</span>], 字段<span class="number">2</span> [<span class="keyword">AS</span> 别名<span class="number">2</span>] ... <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>

<p>其中AS可以省略3. 去除重复记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> 字段列表 <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>

<p>案例：数据准备：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数据准备</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp(</span><br><span class="line">  id <span class="type">INT</span>,</span><br><span class="line">    workno <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    gender <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">    age TINYINT UNSIGNED,</span><br><span class="line">    idcard <span class="type">CHAR</span>(<span class="number">18</span>),</span><br><span class="line">    workaddress <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    entrydate <span class="type">DATE</span></span><br><span class="line">) COMMENT <span class="string">&#x27;员工表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456789012345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;123456789012335678&#x27;</span>, <span class="string">&#x27;Dalian&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;ac&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">8</span>, <span class="string">&#x27;123456789012345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2006-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;ad&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456783412345678&#x27;</span>, <span class="string">&#x27;Dalian&#x27;</span>, <span class="string">&#x27;2002-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;ae&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">38</span>, <span class="string">&#x27;123456783312345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;af&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">68</span>, <span class="string">&#x27;123456786012345678&#x27;</span>, <span class="string">&#x27;Dalian&#x27;</span>, <span class="string">&#x27;2000-01-06&#x27;</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;ag&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456789012445678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2007-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;ah&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">8</span>, <span class="string">&#x27;123456789012235678&#x27;</span>, <span class="string">&#x27;Shanghai&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">9</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;ai&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456789022345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2011-01-02&#x27;</span>),</span><br><span class="line">(<span class="number">10</span>, <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;aj&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">98</span>, <span class="string">&#x27;123456722212345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">11</span>, <span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;ak&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;123456555512345678&#x27;</span>, <span class="string">&#x27;Shanghai&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">12</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;al&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">78</span>, <span class="string">&#x27;123456789512345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">13</span>, <span class="string">&#x27;13&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">16</span>, <span class="string">&#x27;123456789712345678&#x27;</span>, <span class="string">&#x27;Shanghai&#x27;</span>, <span class="string">&#x27;1990-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">14</span>, <span class="string">&#x27;14&#x27;</span>, <span class="string">&#x27;an&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;123456789872345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">15</span>, <span class="string">&#x27;15&#x27;</span>, <span class="string">&#x27;ao&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;123456789012345678&#x27;</span>, <span class="string">&#x27;Shanghai&#x27;</span>, <span class="string">&#x27;2005-01-01&#x27;</span>),</span><br><span class="line">(<span class="number">16</span>, <span class="string">&#x27;16&#x27;</span>, <span class="string">&#x27;aq&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="number">22</span>, <span class="string">&#x27;123456782362345678&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>, <span class="string">&#x27;2000-01-01&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--  基本查询</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. 查询指定字段，name，workno，age返回</span></span><br><span class="line"><span class="keyword">SELECT</span> name, workno, age <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询所有字段返回</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;  <span class="comment">-- 尽量不要写*，因为效率低而且不安全，相比之下写出来所有字段更好</span></span><br><span class="line"><span class="keyword">SELECT</span> id, workno, name, gender, age, idcard, workaddress, entrydate <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 查询所有员工的工作地址</span></span><br><span class="line"><span class="keyword">SELECT</span> workaddress <span class="keyword">as</span> <span class="string">&#x27;工作地址&#x27;</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> workaddress <span class="string">&#x27;工作地址&#x27;</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. 查询员工的上班地址（不要重复）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> workaddress <span class="string">&#x27;工作地址&#x27;</span> <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>

<p>DQL-条件查询1. 语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span> 条件列表;</span><br></pre></td></tr></table></figure>

<p>2. 条件比较运算符<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZpNenesalWic8CKF2qe2uGJLibF7ZKTHxKecTZubOMVzicicylBmHqFgGCg/640?wx_fmt=png"><br>逻辑运算符<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZanFv8rZMf88q555Zicv6xDNk1ROIRNMmgSodId2ZZelibw2jXUHuKDyA/640?wx_fmt=png">  </p>
<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 条件查询</span></span><br><span class="line"><span class="comment">-- 1. 查询年龄等于98的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">98</span>;</span><br><span class="line"><span class="comment">-- 2. 查询年龄小于20 的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;</span> <span class="number">20</span>;</span><br><span class="line"><span class="comment">-- 3. 查询年龄小于等于20的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;=</span> <span class="number">20</span>;</span><br><span class="line"><span class="comment">-- 4. 查询没有身份证号的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> idcard <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="comment">-- 5. 查询有身份证号的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> idcard <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="comment">-- 6. 查询年龄不是88的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;&gt;</span> <span class="number">88</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">!=</span> <span class="number">88</span>;</span><br><span class="line"><span class="comment">-- 7. 查询年龄在15~20岁的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="keyword">BETWEEN</span> <span class="number">15</span> <span class="keyword">AND</span> <span class="number">20</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&gt;=</span> <span class="number">15</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">20</span>;</span><br><span class="line"><span class="comment">-- 8. 查询性别为女而且年龄小于25的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span> <span class="keyword">AND</span> age <span class="operator">&lt;</span> <span class="number">25</span>;</span><br><span class="line"><span class="comment">-- 9. 查询年龄等于18或20或40的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">18</span> <span class="keyword">OR</span> age <span class="operator">=</span> <span class="number">20</span> <span class="keyword">OR</span> age <span class="operator">=</span> <span class="number">40</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="keyword">IN</span> (<span class="number">18</span>, <span class="number">20</span>, <span class="number">40</span>);</span><br><span class="line"><span class="comment">-- 10. 查询名字是两个字的员工的信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> name <span class="keyword">like</span> <span class="string">&#x27;__&#x27;</span>;</span><br><span class="line"><span class="comment">-- 11. 查询身份证号最后一位是X的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> idcard <span class="keyword">LIKE</span> <span class="string">&#x27;%X&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> idcard <span class="keyword">LIKE</span> <span class="string">&#x27;_________________X&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>DQL-分组查询语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 [<span class="keyword">WHERE</span> 条件] <span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组字段名 [<span class="keyword">HAVING</span> 分组后过滤条件]</span><br></pre></td></tr></table></figure>

<p>WHERE和HAVING的区别- 执行时间不同，WHER是分组前过滤，HAVING是分组后过滤- 判断条件不同，WHERE不能对聚合函数进行判断，HAVING可以<br>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 分组查询</span></span><br><span class="line"><span class="comment">-- 1. 根据性别分组，统计男性员工和女性员工的数量</span></span><br><span class="line"><span class="keyword">SELECT</span> gender, <span class="built_in">COUNT</span>(<span class="operator">*</span>) total <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> gender;</span><br><span class="line"><span class="comment">-- 2. 根据性别分组，统计男性员工和女性员工的平均年龄</span></span><br><span class="line"><span class="keyword">SELECT</span> gender, <span class="built_in">AVG</span>(age) avg_age <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> gender;</span><br><span class="line"><span class="comment">-- 3. 查询年龄小于45的员工，并根据工作地址进行分组，获取员工数量&gt;=3的工作地址</span></span><br><span class="line"><span class="keyword">SELECT</span> workaddress, <span class="built_in">COUNT</span>(<span class="operator">*</span>) address_count <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;</span> <span class="number">45</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> workaddress <span class="keyword">HAVING</span> address_count <span class="operator">&gt;=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p>注意：- 执行顺序：where &gt; 聚合函数 &gt; having- 分组之后，查询的字段一般为聚合函数和分组字段，查询其他字段无意义<br>DQL-排序查询语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 <span class="keyword">ORDER</span> <span class="keyword">BY</span> 字段<span class="number">1</span> 排序方式<span class="number">1</span>,  字段<span class="number">2</span> 排序方式<span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>排序方式：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ASC: 升序 （默认值）</span><br><span class="line">DESC: 降序</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 排序查询</span></span><br><span class="line"><span class="comment">-- 1 根据年龄对公司的员工进行升序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> age <span class="keyword">ASC</span>;  <span class="comment">-- ASC可以省略；降序则改为DESC</span></span><br><span class="line"><span class="comment">-- 2 根据入职时间对员工进行降序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> entrydate <span class="keyword">DESC</span>;</span><br><span class="line"><span class="comment">-- 3 根据年龄对公司员工进行升序排序，如果年龄相同再按入职时间进行降序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> age <span class="keyword">ASC</span>, entrydate <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>DQL-分页查询语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 LIMIT 起始索, 查询返回记录数;</span><br></pre></td></tr></table></figure>

<p>注意：- 起始索引从0开始，其实索引 &#x3D; (查询页码 - 1) * 每页显示记录数- 分页查询是数据库的方言，不同的数据库有不同的实现，MySQL是LIMIT- 如果查询的是第一页的数据，起始索引可以省略，直接简写为LIMIT 10<br>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 分页查询</span></span><br><span class="line"><span class="comment">-- 1. 查询第一页员工数据，每页显示10条记录</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp LIMIT <span class="number">0</span>, <span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp LIMIT <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询第二页员工数据，每页显示10条记录</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp LIMIT <span class="number">10</span>, <span class="number">10</span>; <span class="comment">-- (页码 - 1)*页展示记录数</span></span><br></pre></td></tr></table></figure>

<p>DQL 案例课</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 案例</span></span><br><span class="line"><span class="comment">-- 1. 查询年龄为20，21，22，23岁的女性员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="keyword">IN</span> (<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>) <span class="keyword">AND</span> gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span>;</span><br><span class="line"><span class="comment">-- 2. 查询性别为男并且年龄在20-40岁（含）且姓名为两个字的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">&#x27;M&#x27;</span> <span class="keyword">AND</span> ( age <span class="keyword">BETWEEN</span> <span class="number">20</span> <span class="keyword">AND</span> <span class="number">40</span> ) <span class="keyword">AND</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;__&#x27;</span>;</span><br><span class="line"><span class="comment">-- 3. 统计员工表中，年龄小于60岁的男性和女性员工的数量。SELECT gender, COUNT(*) age_count FROM emp WHERE age &lt; 60 GROUP BY gender;</span></span><br><span class="line"><span class="comment">-- 4. 查询所有年龄小于等于35岁员工的姓名和年龄，并对查询结果按照年龄升序排序，年龄相同按照入职时间降序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> name, age <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&lt;=</span> <span class="number">35</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age, entrydate <span class="keyword">DESC</span>;</span><br><span class="line"><span class="comment">-- 5. 查询性别为W且年龄在20-40（含）以内的前5个员工信息，对查询的结果按年龄升序排序，年龄相同按照入职时间升序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> gender <span class="operator">=</span> <span class="string">&#x27;W&#x27;</span> <span class="keyword">AND</span> ( age <span class="keyword">BETWEEN</span> <span class="number">20</span> <span class="keyword">AND</span> <span class="number">40</span> ) <span class="keyword">ORDER</span> <span class="keyword">BY</span> age, entrydate LIMIT <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p>DQL - 执行顺序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>        (<span class="number">4</span>)</span><br><span class="line"><span class="keyword">FROM</span>          (<span class="number">1</span>)</span><br><span class="line"><span class="keyword">WHERE</span>         (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span>      (<span class="number">3</span>)</span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span>      (<span class="number">5</span>)</span><br><span class="line">LIMIT         (<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">LIMIT</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询年龄大于15的员工的姓名、年龄、并根据年龄进行升序排序</span></span><br><span class="line"><span class="keyword">SELECT</span> name, age <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age;</span><br><span class="line"><span class="comment">-- 顺序验证</span></span><br><span class="line"><span class="keyword">SELECT</span> name, age <span class="keyword">FROM</span> emp E <span class="keyword">WHERE</span> E.age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age; </span><br><span class="line"><span class="comment">-- FROM 第一</span></span><br><span class="line"><span class="keyword">SELECT</span> E.name, E.age <span class="keyword">FROM</span> emp E <span class="keyword">WHERE</span> E.age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age; </span><br><span class="line"><span class="comment">-- SELECT 在FROM和WHERE之后</span></span><br><span class="line"><span class="keyword">SELECT</span> E.name ename, E.age EAGE <span class="keyword">FROM</span> emp E <span class="keyword">WHERE</span> EAGE <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age; </span><br><span class="line"><span class="comment">-- 失败：SELECT 在FROM和WHERE之后执行</span></span><br><span class="line"><span class="keyword">SELECT</span> E.name ename, E.age EAGE <span class="keyword">FROM</span> emp E <span class="keyword">WHERE</span> E.age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> EAGE; </span><br><span class="line"><span class="comment">-- 成功：SELECT 在ORDER BY之前执行</span></span><br></pre></td></tr></table></figure>

<p>DCL-介绍DCL 全称 Data Control Language （数据控制语言），用来管理数据库用户、控制数据库的访问权限<br>DCL-管理用户1. 查询用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USE mysql;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure>

<p>2. 创建用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;密码&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>3. 修改用户密码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;新密码&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>4. 删除用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- DCL</span></span><br><span class="line">use mysql;</span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建用户itcast，只能够在localhost 访问，密码123456</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;itcast&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建用户heima，可以在任意机器访问该数据库，密码123456</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改用户heima的密码为1234</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">with</span> mysql_native_password <span class="keyword">by</span> <span class="string">&#x27;1234&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除itcast@localhost用户</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> <span class="string">&#x27;itcast&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>注意：- 主机名可以用’%‘通配- 这类SQL开发人员使用较少，主要是DBA (Database Administrator 数据库管理员)使用<br>DCL-权限控制<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZzjuOlpaC6MhotHMactU2kLpcVmc6hSTkGTR3rouIsjHHQ8ibtHic7FKg/640?wx_fmt=png">1. 查询权限  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;用户名&#x27;</span>@‘主机名’;</span><br></pre></td></tr></table></figure>

<p>2. 授予权限</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> 权限列表 <span class="keyword">ON</span> 数据库.表名 <span class="keyword">TO</span> <span class="string">&#x27;用户名&#x27;</span>@‘主机名’;</span><br></pre></td></tr></table></figure>

<p>3. 撤销权限</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">REMOVE</span> 权限列表 ON 数据库名.表名 FROM <span class="string">&#x27;用户名&#x27;</span>@‘主机名’;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询权限</span></span><br><span class="line"><span class="keyword">show</span> grants <span class="keyword">for</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授予权限</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> itcast.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 撤销权限</span></span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">all</span> <span class="keyword">on</span> itcast.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;heima&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>注意：<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZUx1csNqlXXs1yvdJbYib9Vpdo46Vo4XkdgMxCoTSFhhmEtvp2lHtLhA/640?wx_fmt=png">  </p>
<p>总结：1. 用户管理</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;usernmae&#x27;</span>@<span class="string">&#x27;host&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>2. 权限控制</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> 权限列表 <span class="keyword">ON</span> 数据库名.表名 <span class="keyword">TO</span> ‘用户名<span class="string">&#x27;@&#x27;</span>主机名<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">REVOKE 权限列表 ON 数据库名.表名 FROM &#x27;</span>用户名<span class="string">&#x27;@&#x27;</span>主机名<span class="string">&#x27;;</span></span><br></pre></td></tr></table></figure>

<p>函数函数是指可以被另一段程序直接调用的的程序或代码。</p>
<ul>
<li><p>字符串函数</p>
</li>
<li><p>数值函数</p>
</li>
<li><p>日期函数</p>
</li>
<li><p>流程函数</p>
</li>
</ul>
<p>字符串函数<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7Zkiac6B4dM5XWKdztRiczt36dJHwNBApQIC6LsofYoIWJR52X2LWhkzRg/640?wx_fmt=png"><br>演示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 函数演示</span></span><br><span class="line"><span class="comment">-- concat</span></span><br><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;Hello &#x27;</span>, <span class="string">&#x27;MySQL&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- lower</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(<span class="string">&#x27;Hello&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- upper</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;Hello&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- lpad</span></span><br><span class="line"><span class="keyword">select</span> lpad(<span class="string">&#x27;01&#x27;</span>, <span class="number">5</span>, <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- rpad</span></span><br><span class="line"><span class="keyword">select</span> rpad(<span class="string">&#x27;01&#x27;</span>, <span class="number">5</span>, <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- trim</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">trim</span>(<span class="string">&#x27;  Hello MySQL    &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- substring</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">substring</span>(<span class="string">&#x27;Hello MySQL&#x27;</span>, <span class="number">1</span>, <span class="number">5</span>);  # 这里字符串索引从<span class="number">1</span>开始</span><br></pre></td></tr></table></figure>

<p>案例：由于业务需求变更，企业员工的工号，统一为5位数，目前不足5位数的全部在前面补充0。比如1号员工应该为00001。答案：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 员工号补0.</span></span><br><span class="line">use itcast;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">update</span> emp <span class="keyword">set</span> workno <span class="operator">=</span> lpad(workno, <span class="number">5</span>, <span class="string">&#x27;0&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>数值函数常见的数值函数如下：<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZAhKZAr51oBf5NnRQR1PuUbVSdOncm6Yj7N4p09CGUHfenH5fD60dTg/640?wx_fmt=png">  </p>
<p>演示</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数值函数</span></span><br><span class="line"><span class="comment">-- ceil</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="number">1.1</span>);</span><br><span class="line"><span class="comment">-- floor</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">floor</span>(<span class="number">1.5</span>);</span><br><span class="line"><span class="comment">-- mod</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">mod</span>(<span class="number">3</span>, <span class="number">4</span>);  # <span class="number">3</span>除以<span class="number">4</span>取余</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">mod</span>(<span class="number">6</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">-- rand</span></span><br><span class="line"><span class="keyword">select</span> rand();  # 获得一个<span class="number">0</span><span class="number">-1</span>的随机数</span><br><span class="line"><span class="comment">-- round</span></span><br><span class="line"><span class="keyword">select</span> round(<span class="number">2.345</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">select</span> round(<span class="number">2.344</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p>案例通过数据库的函数，生成一个六位数的随机验证码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 2.通过数据库的函数，生成一个六位数的随机验证码</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="built_in">substring</span>(rand(), <span class="number">3</span>, <span class="number">6</span>);  # 用substring截取</span><br><span class="line"><span class="keyword">select</span> lpad(round(rand() <span class="operator">*</span> <span class="number">1000000</span>, <span class="number">0</span>), <span class="number">6</span>, <span class="string">&#x27;0&#x27;</span>);  # 计算，取整，填充</span><br></pre></td></tr></table></figure>

<p>日期函数常见的日期函数<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZtWI2KXksN23ziciaLlviadzjicRIpQjtXIvPAicBnNQ2nL9EFq6ZpbZI03Q/640?wx_fmt=png">  </p>
<p>演示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 日期函数</span></span><br><span class="line"><span class="comment">-- curdate()</span></span><br><span class="line"><span class="keyword">select</span> curdate();</span><br><span class="line"><span class="comment">-- curtime()</span></span><br><span class="line"><span class="keyword">select</span> curtime();</span><br><span class="line"><span class="comment">-- now()</span></span><br><span class="line"><span class="keyword">select</span> now();</span><br><span class="line"></span><br><span class="line"><span class="comment">-- YEAR, MONTH, DAY</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">year</span>(now()), <span class="keyword">month</span>(now()), <span class="keyword">day</span>(now());</span><br><span class="line"></span><br><span class="line"><span class="comment">-- date_add(date, INTERVAL expr type)</span></span><br><span class="line"><span class="keyword">select</span> date_add(now(), <span class="type">INTERVAL</span> <span class="number">70</span> <span class="keyword">day</span>);  # <span class="number">70</span>天之后，<span class="number">70</span>天之前用负值即可</span><br><span class="line"></span><br><span class="line"><span class="comment">-- date_diff</span></span><br><span class="line"><span class="keyword">select</span> datediff(now(), <span class="string">&#x27;2022-12-01&#x27;</span>);  # 第一个日期减去第二个日期</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有员工的入职天数，并根据入职天数倒序排序</span></span><br><span class="line"><span class="keyword">select</span> name, entrydate, datediff(now(), entrydate) 入职日期 <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> 入职日期 <span class="keyword">desc</span>;  #可以用中文。</span><br></pre></td></tr></table></figure>

<p>流程函数流程函数实现条件筛选，提高语句的效率：<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7Zo0T4LcDbmfmYvSP9v5hMgA459bdBIicwhpkUYxEeyERW2Q7ySUXuR3A/640?wx_fmt=png">  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IF(value, t, f)</span><br><span class="line">IFNULL(value1, value2)</span><br><span class="line">CASE WHEN <span class="selector-attr">[val1]</span> THEN <span class="selector-attr">[res1]</span> ... ELSE <span class="selector-attr">[default]</span> END</span><br><span class="line">CASE <span class="selector-attr">[expr]</span> WHEN <span class="selector-attr">[val1]</span> THEN <span class="selector-attr">[res1]</span> .. ELSE <span class="selector-attr">[default]</span> END</span><br></pre></td></tr></table></figure>

<p>演示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 流程函数</span></span><br><span class="line"><span class="comment">-- if</span></span><br><span class="line"><span class="keyword">select</span> if (<span class="literal">true</span>, <span class="string">&#x27;ok&#x27;</span>, <span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ifnull</span></span><br><span class="line"><span class="keyword">select</span> ifnull (<span class="string">&#x27;ok&#x27;</span>, <span class="string">&#x27;Default&#x27;</span>);  <span class="comment">-- 第一个值为非null则返回第一个值，若为null则返回第二个值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> ifnull (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Default&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> ifnull (<span class="keyword">null</span>, <span class="string">&#x27;Default&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- case when then else end</span></span><br><span class="line"><span class="comment">-- 需求：查询emp员工姓名和工作地址（北京/上海 ---&gt;一线城市，其他---&gt;二线城市）</span></span><br><span class="line"><span class="keyword">select</span> name, </span><br><span class="line">     <span class="keyword">case</span> workaddress </span><br><span class="line">       <span class="keyword">when</span> <span class="string">&#x27;Beijing&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;一线城市&#x27;</span> </span><br><span class="line">       <span class="keyword">when</span> <span class="string">&#x27;Shanghai&#x27;</span> <span class="keyword">then</span> <span class="string">&#x27;一线城市&#x27;</span></span><br><span class="line">       <span class="keyword">else</span> <span class="string">&#x27;二线城市&#x27;</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 案例：统计班级各个学员的成绩，展示的规则如下：-- &gt;= 85，展示优秀 </span></span><br><span class="line"><span class="comment">-- &gt;= 60, 展示及格 </span></span><br><span class="line"><span class="comment">-- 否则， 展示不及格 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> score(</span><br><span class="line">  id <span class="type">int</span> comment <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    math <span class="type">int</span> comment <span class="string">&#x27;数学&#x27;</span>,</span><br><span class="line">    english <span class="type">int</span> comment <span class="string">&#x27;英语&#x27;</span>,</span><br><span class="line">    chinese <span class="type">int</span> comment <span class="string">&#x27;语文&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;学员成绩表&#x27;</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> score</span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;Tom&#x27;</span>, <span class="number">67</span>, <span class="number">88</span>, <span class="number">95</span>), (<span class="number">2</span>, <span class="string">&#x27;Rose&#x27;</span>, <span class="number">23</span>, <span class="number">66</span>, <span class="number">90</span>), (<span class="number">3</span>, <span class="string">&#x27;Jack&#x27;</span>, <span class="number">56</span>, <span class="number">98</span>, <span class="number">76</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> score;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id, name,</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">when</span> math <span class="operator">&gt;=</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;优秀&#x27;</span> <span class="keyword">when</span> math <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;及格&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;不及格&#x27;</span> <span class="keyword">end</span> <span class="string">&#x27;数学成绩&#x27;</span>,</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">when</span> english <span class="operator">&gt;=</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;优秀&#x27;</span> <span class="keyword">when</span> english <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;及格&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;不及格&#x27;</span> <span class="keyword">end</span> <span class="string">&#x27;英语成绩&#x27;</span>,</span><br><span class="line">      <span class="keyword">case</span> <span class="keyword">when</span> chinese <span class="operator">&gt;=</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;优秀&#x27;</span> <span class="keyword">when</span> chinese <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">85</span> <span class="keyword">then</span> <span class="string">&#x27;及格&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;不及格&#x27;</span> <span class="keyword">end</span> <span class="string">&#x27;语文成绩&#x27;</span></span><br><span class="line"><span class="keyword">from</span> score;</span><br></pre></td></tr></table></figure>

<p>总结字符串函数</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">concat</span></span><br><span class="line"><span class="attr">lower</span></span><br><span class="line"><span class="attr">upper</span></span><br><span class="line"><span class="attr">lpad</span> <span class="string">左填充</span></span><br><span class="line"><span class="attr">rpad</span> <span class="string">右填充</span></span><br><span class="line"><span class="attr">trim</span> <span class="string">去除左右空格</span></span><br><span class="line"><span class="attr">substring</span>  <span class="string">字符串截取</span></span><br></pre></td></tr></table></figure>

<p>数值函数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ceil</span><br><span class="line">floor</span><br><span class="line">mod</span><br><span class="line">rand</span><br><span class="line">round 四舍五入，保留指定位小数</span><br></pre></td></tr></table></figure>

<p>日期函数</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">curdate</span></span><br><span class="line">curtime</span><br><span class="line">now</span><br><span class="line">year</span><br><span class="line">month</span><br><span class="line">day</span><br><span class="line">date_add</span><br><span class="line">datediff  第一个日期减去第二个日期</span><br></pre></td></tr></table></figure>

<p>流程函数</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span></span><br><span class="line">ifnull</span><br><span class="line"><span class="keyword">case</span> [...] <span class="keyword">when</span>.. <span class="keyword">then</span>... <span class="keyword">else</span>... <span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>约束概述：常见的约束有哪些</p>
<ul>
<li><p>概念：约束是作用于表中字段上的规则，用于限制存储在表中的数据</p>
</li>
<li><p>目的：保证数据库中数据的正确，有效性和完整性</p>
</li>
<li><p>分类：</p>
</li>
</ul>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZCcOWNzOLLKHicc3ATZ58sxJribv1J9J5pOVTnibupiazbZH5iaiaPoxR4Bqw/640?wx_fmt=png">  </p>
<p>约束演示案例：根据需求，完成表的创建<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZFZibNJK5CUzibEBa1zNy5LwXJunxIB2ibzmiaIL5v9nslNGtp0AqLvF2lQ/640?wx_fmt=png">  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">id: <span class="keyword">primary</span> key, auto_increment</span><br><span class="line">name: <span class="keyword">not</span> <span class="keyword">null</span>, <span class="keyword">unique</span></span><br><span class="line">age: <span class="keyword">check</span></span><br><span class="line">status: <span class="keyword">default</span></span><br><span class="line">gender: N<span class="operator">/</span>A</span><br><span class="line"><span class="comment">--  约束</span></span><br><span class="line"><span class="keyword">create</span> database itheima <span class="keyword">default</span> charset utf8mb4;</span><br><span class="line">use itheima;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;主键&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> <span class="keyword">check</span>(age <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">and</span> age <span class="operator">&lt;</span> <span class="number">120</span>) comment <span class="string">&#x27;年龄&#x27;</span>,   <span class="comment">-- 用and或&amp;&amp;都可以 </span></span><br><span class="line">    status <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;1&#x27;</span> comment <span class="string">&#x27;状态&#x27;</span>,</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">1</span>)</span><br><span class="line">) comment <span class="string">&#x27;用户表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom1&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>), (<span class="string">&#x27;Tom2&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom3&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="keyword">null</span>, <span class="number">19</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>); <span class="comment">-- 出错，因为不可以出错</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom3&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>); <span class="comment">-- 不可重复执行，因为存在唯一约束 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom4&#x27;</span>, <span class="number">80</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>);  <span class="comment">-- id 是5，虽然刚才插入没有成功，但是id已经被申请过了 </span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom5&#x27;</span>, <span class="number">-1</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>);  <span class="comment">-- 检查约束生效 </span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, status, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom5&#x27;</span>, <span class="number">121</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;男&#x27;</span>); <span class="comment">-- 检查约束生效 </span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom6&#x27;</span>, <span class="number">121</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(name, age, gender) <span class="keyword">values</span> (<span class="string">&#x27;Tom5&#x27;</span>, <span class="number">120</span>, <span class="string">&#x27;男&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>拓展：约束的修改</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 发现建表的时候约束设置的不正确,如何修改 </span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>;  <span class="comment">-- 查看现有约束的名称</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">drop</span> <span class="keyword">constraint</span> user_chk_1; <span class="comment">-- 删除现有约束</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="operator">=</span> <span class="number">121</span>;  <span class="comment">-- 如果有数据不满足约束,去除之 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> <span class="keyword">constraint</span> user_chk_1 <span class="keyword">check</span> (age <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">and</span> age <span class="operator">&lt;=</span> <span class="number">120</span>);  <span class="comment">-- 添加新的约束,操作结束</span></span><br></pre></td></tr></table></figure>

<p>外键约束概念外键用来让两张表的数据之间建立连接，从而保证数据的一致性和完整性<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZreGYa6JnJOoht6MOLbogjW21J9guJWOicllM6ibhVeopF5TDo0nIhPfA/640?wx_fmt=png">  </p>
<p>具有外键的表称为子表，被关联的表叫做父表注意：数据库层面，未建立外键关联，所以无法保证数据的一致性和完整性。演示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 外键约束 </span></span><br><span class="line"><span class="comment">-- 准备数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;部门名称&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;部门表&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;研发部&#x27;</span>), (<span class="number">2</span>, <span class="string">&#x27;市场部&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;财务部&#x27;</span>), (<span class="number">4</span>, <span class="string">&#x27;销售部&#x27;</span>), (<span class="number">5</span>, <span class="string">&#x27;总经办&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    job <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line">    salary <span class="type">int</span> comment <span class="string">&#x27;薪资&#x27;</span>,</span><br><span class="line">    entrydate <span class="type">date</span> comment <span class="string">&#x27;入职时间&#x27;</span>,</span><br><span class="line">    managerid <span class="type">int</span> comment <span class="string">&#x27;直属领导ID&#x27;</span>,</span><br><span class="line">    dept_id <span class="type">int</span> comment <span class="string">&#x27;部门ID&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;员工表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (name, age, job, salary, entrydate, managerid, dept_id) <span class="keyword">values</span> (<span class="string">&#x27;金庸&#x27;</span>, <span class="number">66</span>, <span class="string">&#x27;总裁&#x27;</span>, <span class="number">20000</span>, <span class="string">&#x27;2000-01-01&#x27;</span>, <span class="keyword">null</span>, <span class="number">5</span>), (<span class="string">&#x27;张无忌&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;项目经理&#x27;</span>, <span class="number">12500</span>, <span class="string">&#x27;2005-12-05&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;杨逍&#x27;</span>, <span class="number">33</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">8400</span>, <span class="string">&#x27;2000-11-03&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>), (<span class="string">&#x27;韦一笑&#x27;</span>, <span class="number">48</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">11000</span>, <span class="string">&#x27;2002-02-05&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;常遇春&#x27;</span>, <span class="number">43</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">10500</span>, <span class="string">&#x27;2004-09-07&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>), (<span class="string">&#x27;小昭&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;程序员鼓励师&#x27;</span>, <span class="number">6600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 以上,没有设置物理外键,无法保证数据之间的一致性和完整性</span></span><br></pre></td></tr></table></figure>

<p>语法：添加外键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名(</span><br><span class="line">    字段名 数据类型,</span><br><span class="line">    ..</span><br><span class="line">    [<span class="keyword">CONSTRAINT</span>] [外键名称] <span class="keyword">FOREIGN</span> KEY (外键字段名) <span class="keyword">REFERENCES</span> 主表(主表列名)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> 外键名称 <span class="keyword">FOREIGN</span> KEY(外键字段名) <span class="keyword">REFERENCES</span> 主表(主表列名);</span><br><span class="line">案例：</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 成功删除 </span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;研发部&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加外键 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dept_id <span class="keyword">foreign</span> key(dept_id) <span class="keyword">references</span> dept(id);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>; <span class="comment">-- Cannot delete or update a parent row: a foreign key constraint fails</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除外键 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">drop</span> <span class="keyword">foreign</span> key fk_emp_dept_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 删除成功</span></span><br></pre></td></tr></table></figure>

<p>删除&#x2F;更新行为<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7Z3x7cDe9wxp8VJgzj3YRub8IzXHko5ZWErylhXngO5h9PnFX4p3r0jg/640?wx_fmt=png">  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> 外键名称 <span class="keyword">FOREIGN</span> KEY (外键字段）</span><br><span class="line"><span class="keyword">REFERENCES</span> 主表 （主表字段名）</span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 外键的删除和更新行为 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dept_id</span><br><span class="line"><span class="keyword">foreign</span> key(dept_id) <span class="keyword">references</span> dept(id)</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade;  <span class="comment">-- 级联更新/删除 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 级联更新操作 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="keyword">update</span> dept <span class="keyword">set</span> id <span class="operator">=</span> <span class="number">6</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;  <span class="comment">-- 查看子表，的确更新为6了，这就是cascade的作用 </span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">6</span>; <span class="comment">-- 子表数据也被删除了 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- SET NULL 操作 </span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> emp;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 准备数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;部门名称&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;部门表&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;研发部&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;市场部&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;财务部&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;销售部&#x27;</span>), (<span class="number">5</span>, <span class="string">&#x27;总经办&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    job <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line">    salary <span class="type">int</span> comment <span class="string">&#x27;薪资&#x27;</span>,</span><br><span class="line">    entrydate <span class="type">date</span> comment <span class="string">&#x27;入职时间&#x27;</span>,</span><br><span class="line">    managerid <span class="type">int</span> comment <span class="string">&#x27;直属领导ID&#x27;</span>,</span><br><span class="line">    dept_id <span class="type">int</span> comment <span class="string">&#x27;部门ID&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;员工表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (name, age, job, salary, entrydate, managerid, dept_id)</span><br><span class="line"><span class="keyword">values</span> (<span class="string">&#x27;金庸&#x27;</span>, <span class="number">66</span>, <span class="string">&#x27;总裁&#x27;</span>, <span class="number">20000</span>, <span class="string">&#x27;2000-01-01&#x27;</span>, <span class="keyword">null</span>, <span class="number">5</span>),</span><br><span class="line">(<span class="string">&#x27;张无忌&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;项目经理&#x27;</span>, <span class="number">12500</span>, <span class="string">&#x27;2005-12-05&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;杨逍&#x27;</span>, <span class="number">33</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">8400</span>, <span class="string">&#x27;2000-11-03&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;韦一笑&#x27;</span>, <span class="number">48</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">11000</span>, <span class="string">&#x27;2002-02-05&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;常遇春&#x27;</span>, <span class="number">43</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">10500</span>, <span class="string">&#x27;2004-09-07&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;小昭&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;程序员鼓励师&#x27;</span>, <span class="number">6600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加外键 </span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dept_id <span class="keyword">foreign</span> key(dept_id)</span><br><span class="line"><span class="keyword">references</span> dept(id) <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">set</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span>; </span><br><span class="line"><span class="comment">-- set null更新/删除 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除id = 1的数据</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp; </span><br><span class="line"><span class="comment">-- 可见所有emp 原有dept_id = 1的数据现在 dept_id的值为 null</span></span><br></pre></td></tr></table></figure>

<p>总结1. 非空约束 not null2. 唯一约束 unique3. 主键约束 primary key (自增: AUTO_INCREMENT， ORACLE没有这个，而是SEQUENCE)4. 默认约束 default5. 检查约束 check6. 外键约束 foreign key<br>多表查询多表关系各个表结构之间存在各种联系：一对多 （多对一）多对多一对一一对多（多对一）案例：部门 与 员工 的关系关系：一个部门对应多个员工，一个员工对应一个部门实现：再多的一方建立外键，只想一的一方的主键<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZqEfORXMq9UgeKqe5ryia3wVpy9C2OmW1B5k1rhKwT1MgaPUA2gft3sw/640?wx_fmt=png">  </p>
<p>多对多案例：学生 与 课程的关系关系：一个学生可以选择多门课程，一门课程也可以供多个学生选择实现：建立第三张中间表，中间层至少包含两个外键，分别关联两方主键<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7Z0AuibPUab20DnrL5oibfX0gpwKwqNibYWxwkrvGJH7RZQnhK6eprpoBJg/640?wx_fmt=png">  </p>
<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多对多 </span></span><br><span class="line"><span class="comment">-- 学生表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line">  id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    <span class="keyword">no</span> <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;学号&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;学生表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student</span><br><span class="line"><span class="keyword">values</span> (<span class="keyword">null</span>, <span class="string">&#x27;黛绮丝&#x27;</span>, <span class="string">&#x27;2000100101&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;谢逊&#x27;</span>, <span class="string">&#x27;2000100102&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;殷天正&#x27;</span>, <span class="string">&#x27;2000100103&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;韦一笑&#x27;</span>, <span class="string">&#x27;2000100104&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 课程表 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> course(</span><br><span class="line">  id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;课程名称&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;课程表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> course <span class="keyword">values</span> (<span class="keyword">null</span>, <span class="string">&#x27;Java&#x27;</span>), (<span class="keyword">null</span>, <span class="string">&#x27;PHP&#x27;</span>), (<span class="keyword">null</span>, <span class="string">&#x27;MySQL&#x27;</span>), (<span class="keyword">null</span>, <span class="string">&#x27;Hadoop&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 学生课程关系表 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student_course(</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;主键&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    studentid <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;学生ID&#x27;</span>,</span><br><span class="line">    courseid <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;课程ID&#x27;</span>,</span><br><span class="line">    <span class="keyword">constraint</span> fk_courseid <span class="keyword">foreign</span> key (courseid) <span class="keyword">references</span> course (id),</span><br><span class="line">    <span class="keyword">constraint</span> fk_student_id <span class="keyword">foreign</span> key (studentid) <span class="keyword">references</span> student(id)</span><br><span class="line">) comment <span class="string">&#x27;学生课程中间表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student_course <span class="keyword">values</span> (<span class="keyword">null</span>, <span class="number">1</span>, <span class="number">1</span>), (<span class="keyword">null</span>, <span class="number">1</span>, <span class="number">2</span>), (<span class="keyword">null</span>, <span class="number">1</span>, <span class="number">3</span>), (<span class="keyword">null</span>, <span class="number">2</span>, <span class="number">2</span>), (<span class="keyword">null</span>, <span class="number">2</span>, <span class="number">3</span>), (<span class="keyword">null</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">describe</span> student_course;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> studenstudent_coursestudent_coursestudent_coursestudent_coursestudent_courset_course;</span><br></pre></td></tr></table></figure>

<p>.一对一案例：用户 和 用户详情的关系关系：一对一关系，多用于单表拆分，将一张表的基础字段放在一张表中，其他详情字段放在另一张表中，以提升操作效率实现：在任意一方加入外键，关联另一方的主键，并且设置外键为唯一的（UNIQUE）图例：<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7Zje9VoicFIIGVfrvb94HC2WzqiaiaE5iawveXiaOjgOVDORLuNZae2njjTcA/640?wx_fmt=png">  </p>
<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 一对一</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_user (</span><br><span class="line">  id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">1</span>) comment <span class="string">&#x27;1: 男，2: 女&#x27;</span>,</span><br><span class="line">    phone <span class="type">char</span>(<span class="number">11</span>) comment <span class="string">&#x27;手机号&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;用户基本信息表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_user_edu (</span><br><span class="line">  id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    degree <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;学历&#x27;</span>,</span><br><span class="line">    major <span class="type">varchar</span>(<span class="number">50</span>) comment <span class="string">&#x27;专业&#x27;</span>,</span><br><span class="line">    primaryschool <span class="type">varchar</span>(<span class="number">50</span>) comment <span class="string">&#x27;小学&#x27;</span>,</span><br><span class="line">    middleschool <span class="type">varchar</span>(<span class="number">50</span>) comment <span class="string">&#x27;中学&#x27;</span>,</span><br><span class="line">    university <span class="type">varchar</span>(<span class="number">50</span>) comment <span class="string">&#x27;大学&#x27;</span>,</span><br><span class="line">    userid <span class="type">int</span> <span class="keyword">UNIQUE</span> comment <span class="string">&#x27;用户ID&#x27;</span>,</span><br><span class="line">    <span class="keyword">constraint</span> fk_userid <span class="keyword">foreign</span> key (userid) <span class="keyword">references</span> tb_user(id)</span><br><span class="line">) comment <span class="string">&#x27;用户教育信息表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_user(id, name, age, gender, phone) <span class="keyword">values</span></span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;黄渤&#x27;</span>, <span class="number">45</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;18800001111&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;冰冰&#x27;</span>, <span class="number">35</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;18800002222&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;码云&#x27;</span>, <span class="number">55</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;18800008888&#x27;</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;李彦宏&#x27;</span>, <span class="number">50</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;18800009999&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_user_edu <span class="keyword">values</span></span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;本科&#x27;</span>, <span class="string">&#x27;舞蹈&#x27;</span>, <span class="string">&#x27;青岛市第一小学&#x27;</span>, <span class="string">&#x27;青岛市第一中学&#x27;</span>, <span class="string">&#x27;北京电影学院&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;硕士&#x27;</span>, <span class="string">&#x27;表演&#x27;</span>, <span class="string">&#x27;朝阳区第一小学&#x27;</span>, <span class="string">&#x27;朝阳区第一中学&#x27;</span>, <span class="string">&#x27;上海戏剧学院&#x27;</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;本科&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="string">&#x27;杭州市第一小学&#x27;</span>, <span class="string">&#x27;杭州市第一中学&#x27;</span>, <span class="string">&#x27;杭州示范大学&#x27;</span>, <span class="number">3</span>),</span><br><span class="line">(<span class="keyword">null</span>, <span class="string">&#x27;本科&#x27;</span>, <span class="string">&#x27;计算机&#x27;</span>, <span class="string">&#x27;阳泉第一小学&#x27;</span>, <span class="string">&#x27;阳泉第一中学&#x27;</span>, <span class="string">&#x27;清华大学&#x27;</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<p>多表查询概述概述：指从多张表中查询数据笛卡尔积：指在数学中，两个集合的所有组合情况（在多表查询时，需要消除无效的笛卡尔积）<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZJCTRqic6dTQlPMj2UickC5cZPh8hxETFnxib6pL9LXMbe76ZgqOqmNOdA/640?wx_fmt=png">  </p>
<p>案例:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数据准备 </span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> emp;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;部门名称&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;部门表&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;研发部&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;市场部&#x27;</span>), (<span class="number">3</span>, <span class="string">&#x27;财务部&#x27;</span>), (<span class="number">4</span>, <span class="string">&#x27;销售部&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;总经办&#x27;</span>), (<span class="number">6</span>, <span class="string">&#x27;人事部&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">  id <span class="type">int</span> auto_increment comment <span class="string">&#x27;ID&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    age <span class="type">int</span> comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    job <span class="type">varchar</span>(<span class="number">20</span>) comment <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line">    salary <span class="type">int</span> comment <span class="string">&#x27;薪资&#x27;</span>,</span><br><span class="line">    entrydate <span class="type">date</span> comment <span class="string">&#x27;入职时间&#x27;</span>,</span><br><span class="line">    managerid <span class="type">int</span> comment <span class="string">&#x27;直属领导ID&#x27;</span>,</span><br><span class="line">    dept_id <span class="type">int</span> comment <span class="string">&#x27;部门ID&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;员工表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (name, age, job, salary, entrydate, managerid, dept_id)</span><br><span class="line"><span class="keyword">values</span></span><br><span class="line">(<span class="string">&#x27;金庸&#x27;</span>, <span class="number">66</span>, <span class="string">&#x27;总裁&#x27;</span>, <span class="number">20000</span>, <span class="string">&#x27;2000-01-01&#x27;</span>, <span class="keyword">null</span>, <span class="number">5</span>),</span><br><span class="line">(<span class="string">&#x27;张无忌&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;项目经理&#x27;</span>, <span class="number">12500</span>, <span class="string">&#x27;2005-12-05&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;杨逍&#x27;</span>, <span class="number">33</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">8400</span>, <span class="string">&#x27;2000-11-03&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;韦一笑&#x27;</span>, <span class="number">48</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">11000</span>, <span class="string">&#x27;2002-02-05&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;常遇春&#x27;</span>, <span class="number">43</span>, <span class="string">&#x27;开发&#x27;</span>, <span class="number">10500</span>, <span class="string">&#x27;2004-09-07&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;小昭&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;程序员鼓励师&#x27;</span>, <span class="number">6600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;灭绝&#x27;</span>, <span class="number">60</span>, <span class="string">&#x27;财务总监&#x27;</span>, <span class="number">8500</span>, <span class="string">&#x27;2002-10-12&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">&#x27;周芷若&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;会计&#x27;</span>, <span class="number">48000</span>, <span class="string">&#x27;2006-10-12&#x27;</span>, <span class="number">7</span>, <span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;丁敏君&#x27;</span>, <span class="number">23</span>, <span class="string">&#x27;出纳&#x27;</span>, <span class="number">5250</span>, <span class="string">&#x27;2009-10-12&#x27;</span>, <span class="number">7</span>, <span class="number">3</span>),</span><br><span class="line">(<span class="string">&#x27;赵敏&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;市场部总监&#x27;</span>, <span class="number">12500</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;路障可&#x27;</span>, <span class="number">56</span>, <span class="string">&#x27;职员&#x27;</span>, <span class="number">3750</span>, <span class="string">&#x27;2006-10-12&#x27;</span>, <span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;和笔翁&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;职员&#x27;</span>, <span class="number">3750</span>, <span class="string">&#x27;2007-10-12&#x27;</span>, <span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;房东白&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;职员&#x27;</span>, <span class="number">5500</span>, <span class="string">&#x27;2009-10-12&#x27;</span>, <span class="number">102</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">&#x27;张三丰&#x27;</span>, <span class="number">88</span>, <span class="string">&#x27;销售总监&#x27;</span>, <span class="number">14000</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">1</span>, <span class="number">4</span>),</span><br><span class="line">(<span class="string">&#x27;玉莲舟&#x27;</span>, <span class="number">38</span>, <span class="string">&#x27;销售&#x27;</span>, <span class="number">4600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">14</span>, <span class="number">4</span>),</span><br><span class="line">(<span class="string">&#x27;宋远桥&#x27;</span>, <span class="number">40</span>, <span class="string">&#x27;销售&#x27;</span>, <span class="number">4600</span>, <span class="string">&#x27;2004-10-12&#x27;</span>, <span class="number">14</span>, <span class="number">4</span>),</span><br><span class="line">(<span class="string">&#x27;陈友谅&#x27;</span>, <span class="number">42</span>, <span class="string">&#x27;null&#x27;</span>, <span class="number">2000</span>, <span class="string">&#x27;2011-10-12&#x27;</span>, <span class="number">1</span>, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> <span class="keyword">foreign</span> key fk_deptid (dept_id)</span><br><span class="line"><span class="keyword">references</span> dept(id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 多表查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp, dept;  <span class="comment">-- 查出来的结果好像比想象中要多 - 笛卡尔积 17 * 6 = 102 条</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp, dept <span class="keyword">where</span> emp.dept_id <span class="operator">=</span> dept.id;</span><br></pre></td></tr></table></figure>

<p>多表查询分类- 连接查询    - 内连接: 相当于查询A.B交集部分的数据    - 外连接:        左外连接: 查询左表中的所有数据，以及交集部分数据        右外连接：查询右表中的所有数据，以及交集部分数据    - 自连接：当前表与自身的连接查询，自连接必须使用表别名- 子查询<br>内连接内连接查询语法：    隐式内连接：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段列表 <span class="keyword">from</span> 表<span class="number">1</span>, 表<span class="number">2</span> <span class="keyword">where</span> 条件...;</span><br></pre></td></tr></table></figure>

<p>    显式内连接：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段列表 <span class="keyword">from</span> 表<span class="number">1</span> [<span class="keyword">INNER</span>] <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 连接条件...;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 内连接演示</span></span><br><span class="line"><span class="comment">-- 1. 查询每一个员工的姓名,以及关联的部门的名称 (隐式内连接实现) </span></span><br><span class="line"><span class="keyword">select</span> e.name, d.name <span class="keyword">from</span> emp e, dept d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id;  </span><br><span class="line"><span class="comment">-- 起别名之后不能直接用表名访问字段了 </span></span><br><span class="line"><span class="keyword">select</span> emp.name, dept.name <span class="keyword">from</span> emp, dept <span class="keyword">where</span> emp.dept_id <span class="operator">=</span> dept.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询每一个员工的姓名以及关联的部门名称(显式内连接实现) </span></span><br><span class="line"><span class="keyword">select</span> e.name, d.name <span class="keyword">from</span> emp e </span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br></pre></td></tr></table></figure>

<p>外连接语法：    左外：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段名 <span class="keyword">from</span> 表<span class="number">1</span> <span class="keyword">left</span> [<span class="keyword">outer</span>] <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 条件... ;</span><br></pre></td></tr></table></figure>

<p>    右外：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段名 <span class="keyword">from</span> 表<span class="number">1</span> <span class="keyword">right</span> [<span class="keyword">outer</span>] <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 条件... ;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 外连接演示 </span></span><br><span class="line"><span class="comment">-- 1. 查询emp表所有数据， 和对应的部门信息 （左连接）</span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.name <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.name <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询dept表中所有数据，和对应的员工信息 （右连接） </span></span><br><span class="line"><span class="keyword">select</span> d.<span class="operator">*</span>, e.<span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 等价于：select d.*, e.* from dept d left outer join emp e  on e.dept_id = d.id;</span></span><br></pre></td></tr></table></figure>

<p>自连接语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段列表 <span class="keyword">from</span> 表A 别名A <span class="keyword">join</span> 表A 别名B <span class="keyword">on</span> 条件... ;</span><br></pre></td></tr></table></figure>

<p>自联结查询可以是内连接也可以是外连接案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 内连接演示 </span></span><br><span class="line"><span class="comment">-- 1. 查询员工及其所属的领导名字 </span></span><br><span class="line"><span class="comment">-- 表结构：emp表</span></span><br><span class="line"><span class="keyword">select</span> a.name employee, b.name manager <span class="keyword">from</span> emp a, emp b</span><br><span class="line"><span class="keyword">where</span> a.managerid <span class="operator">=</span> b.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询所有员工emp及其领导的名字emp，如果员工没有领导也需要查询出来 </span></span><br><span class="line"><span class="comment">-- 表结构：emp e1, emp e2</span></span><br><span class="line"><span class="keyword">select</span> e1.name employee, e2.name boss <span class="keyword">from</span> emp e1</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> emp e2 <span class="keyword">on</span> e1.managerid <span class="operator">=</span> e2.id; <span class="comment">-- 左外</span></span><br></pre></td></tr></table></figure>

<p>联合查询关键字：union, union all语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段列表 表A ...</span><br><span class="line"><span class="keyword">UNION</span> [<span class="keyword">ALL</span>]</span><br><span class="line"><span class="keyword">select</span> 字段列表 表B ... ;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- union all, union</span></span><br><span class="line"><span class="comment">-- 1. 将薪资低于5000的员工，和年龄大于50的员工全部查询出来 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&lt;</span> <span class="number">5000</span></span><br><span class="line"><span class="keyword">union</span> # <span class="keyword">union</span>合并后去重，<span class="keyword">union</span> <span class="keyword">all</span>则没有去重 </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line"># 如果第二个查询只查询name，则无法使用<span class="keyword">union</span>因为列数量不同</span><br></pre></td></tr></table></figure>

<p>小结：</p>
<ul>
<li><p>联合查询多张表的列数必须保持一致，字段类型也必须一致</p>
</li>
<li><p>union all 直接合并，union则会去重</p>
</li>
</ul>
<p>子查询概念：SQL语句中嵌套SELECT语句，成为嵌套查询，又称子查询语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t1 <span class="keyword">where</span> column1 <span class="operator">=</span> (<span class="keyword">select</span> column1 <span class="keyword">from</span> t2);</span><br></pre></td></tr></table></figure>

<p>注意 - 子查询外部语句可以是insert&#x2F;update&#x2F;delete&#x2F;select的任何一个。<br>分类：子查询结果不同，可以分为：    标量子查询 （子查询结果为单个值）    列子查询 （子查询结果为一列）    行子查询 （子查询结果为一行）    表子查询 （子查询结果为多行多列）<br>根据子查询位置，分为：WHERE之后，FROM之后，SELECT之后。<br>标量子查询：概念：子查询返回结果为单个值（数字，字符串，日期等），最简单的形式，这种子查询称为标量子查询。常用的操作符：&#x3D; &lt;&gt; &gt; &gt;&#x3D; &lt; &lt;&#x3D;<br>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 标量子查询 </span></span><br><span class="line"><span class="comment">-- 1. 查询销售部所有员工信息 </span></span><br><span class="line"><span class="comment">-- a. 查询销售部部门id</span></span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;销售部&#x27;</span>;</span><br><span class="line"><span class="comment">-- b. 根据部门id查询员工信息 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line"><span class="comment">-- 使用子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="operator">=</span></span><br><span class="line">(<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;销售部&#x27;</span>);</span><br><span class="line"><span class="comment">-- 使用外连接 </span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> d.name <span class="operator">=</span> <span class="string">&#x27;销售部&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询在“房东白”入职之后的员工信息 </span></span><br><span class="line"><span class="comment">-- a. 查询房东白的入职时间 </span></span><br><span class="line"><span class="keyword">select</span> entrydate <span class="keyword">from</span> emp <span class="keyword">where</span> emp.name <span class="operator">=</span> <span class="string">&#x27;房东白&#x27;</span>;</span><br><span class="line"><span class="comment">-- b. 查询比房东白入职晚的员工 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2009-10-12&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span></span><br><span class="line">(<span class="keyword">select</span> entrydate <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;房东白&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>列子查询：概念：子查询返回的结果是一列（可以是多行），这种子查询称为列子查询常用的操作符：IN, NOT IN, ANY, SOME, ALL<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZCticK7zle59HB0BvZKa6dYwict0c2gvTQawSV7hvUcX6DfEBeDzcVfzg/640?wx_fmt=png">  </p>
<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列子查询 </span></span><br><span class="line"><span class="comment">-- 1. 查询“销售部”和“市场部”的所有员工信息 </span></span><br><span class="line"><span class="comment">-- a. 找到销售部和市场部的部门id</span></span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="keyword">in</span> (<span class="string">&#x27;销售部&#x27;</span>, <span class="string">&#x27;市场部&#x27;</span>);</span><br><span class="line"><span class="comment">-- b. 根据部门id，查询员工信息 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="keyword">in</span> (<span class="string">&#x27;销售部&#x27;</span>, <span class="string">&#x27;市场部&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询比财务部所有人工资都高的员工信息</span></span><br><span class="line"><span class="comment">-- 标量子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp a <span class="keyword">where</span> salary <span class="operator">&gt;</span> ( </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(salary) <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;财务部&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> <span class="keyword">all</span> (</span><br><span class="line"><span class="keyword">select</span> salary <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;财务部&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 比研发部任意一人工资高的员工信息 </span></span><br><span class="line"><span class="comment">-- 列子查询 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> <span class="keyword">any</span> (</span><br><span class="line"><span class="keyword">select</span> salary <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span></span><br><span class="line">));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 标量子查询</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> (</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(e.salary) <span class="keyword">from</span> emp e <span class="keyword">join</span> dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> d.name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>行子查询概念：子查询返回的结果是一行（多列的）常用操作符：&#x3D;, &lt;&gt;, IN, NOT IN案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 行子查询 </span></span><br><span class="line"><span class="comment">-- 查询与张无忌薪资和直属领导相同的员工信息  </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> (salary, managerid) <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">select</span> salary, managerid <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张无忌&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>表子查询概念：子查询返回的结果是多行多列，这种子查询叫做表子查询常用操作符：IN案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 表子查询 </span></span><br><span class="line"><span class="comment">-- 1. 查询与路障可，宋远桥的职位和薪资相同的员工 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> (job, salary) <span class="keyword">in</span> (</span><br><span class="line"><span class="keyword">select</span> job, salary <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="keyword">in</span> (<span class="string">&#x27;路障可&#x27;</span>, <span class="string">&#x27;宋远桥&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询入职日期是“2006-01-01”之后的员工信息及其部门信息 </span></span><br><span class="line"><span class="keyword">select</span> a.<span class="operator">*</span>, b.<span class="operator">*</span> <span class="keyword">from</span> dept a </span><br><span class="line"><span class="keyword">right</span> <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2006-01-01&#x27;</span>) b</span><br><span class="line"><span class="keyword">on</span> a.id <span class="operator">=</span> b.dept_id;</span><br></pre></td></tr></table></figure>

<p>多表查询案例：<img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7ZBeuQLQ6icicKB13UZR8fzXUjbCuKU7MoPVm4r1QzLjGgCC5mndwNqyhw/640?wx_fmt=png">  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多表查询案例 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> salgrade (</span><br><span class="line">  grade <span class="type">int</span>,</span><br><span class="line">    losal <span class="type">int</span>,</span><br><span class="line">    hisal <span class="type">int</span></span><br><span class="line">) comment <span class="string">&#x27;薪资等级表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade <span class="keyword">values</span></span><br><span class="line">(<span class="number">1</span>, <span class="number">0</span>, <span class="number">3000</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="number">3001</span>, <span class="number">5000</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="number">5001</span>, <span class="number">8000</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="number">8001</span>, <span class="number">10000</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="number">10001</span>, <span class="number">15000</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="number">15001</span>, <span class="number">20000</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="number">20001</span>, <span class="number">25000</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="number">25001</span>, <span class="number">30000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. 查询员工的姓名，年龄，职位，部门信息（隐式内连接） </span></span><br><span class="line"><span class="keyword">select</span> e.name, e.age, e.job, d.name <span class="keyword">from</span> emp e, dept d</span><br><span class="line"><span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 查询年龄小于30岁的员工的姓名，年龄，职位，部门信息（显式内连接） </span></span><br><span class="line"><span class="keyword">select</span> e.name, e.age, e.job, d.name</span><br><span class="line"><span class="keyword">from</span> emp e <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> e.age <span class="operator">&lt;</span> <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 查询拥有员工的部门的id，部门名称 </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> d.id, d.name <span class="keyword">from</span> dept d</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> emp e</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. 查询年龄大于40岁的员工，及其归属的部门名称；如果员工没有部门，也要展示出来 </span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.name <span class="keyword">from</span> </span><br><span class="line">emp e <span class="keyword">left</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> e.age <span class="operator">&gt;</span> <span class="number">40</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5. 查询所有员工的工资等级 </span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, sg.grade, sg.losal, sg.hisal <span class="keyword">from</span></span><br><span class="line">emp e <span class="keyword">left</span> <span class="keyword">join</span> salgrade sg</span><br><span class="line"><span class="keyword">on</span> e.salary <span class="operator">&gt;=</span> sg.losal <span class="keyword">and</span> e.salary <span class="operator">&lt;=</span> sg.hisal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, sg.grade <span class="keyword">from</span></span><br><span class="line">emp e, salgrade sg</span><br><span class="line"><span class="keyword">where</span> e.salary <span class="keyword">between</span> sg.losal <span class="keyword">and</span> sg.hisal;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6. 查询研发部所有员工的信息及工资等级 </span></span><br><span class="line"><span class="keyword">select</span> d.name, e.<span class="operator">*</span>, sg.grade <span class="keyword">from</span></span><br><span class="line">emp e <span class="keyword">join</span> salgrade sg <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.salary <span class="keyword">between</span> sg.losal <span class="keyword">and</span> sg.hisal</span><br><span class="line"><span class="keyword">and</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">where</span> d.name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    d.name, e.<span class="operator">*</span>, sg.grade</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    emp e,</span><br><span class="line">    dept d,</span><br><span class="line">    salgrade sg</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    e.salary <span class="keyword">BETWEEN</span> sg.losal <span class="keyword">AND</span> sg.hisal</span><br><span class="line">        <span class="keyword">AND</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line">        <span class="keyword">AND</span> d.name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span>;</span><br><span class="line"><span class="comment">-- ctrl + B </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7. 查询研发部的员工的平均工资 </span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(e.salary) <span class="string">&#x27;研发部平均工资&#x27;</span> <span class="keyword">from</span> emp e, dept d</span><br><span class="line"><span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">and</span> d.name <span class="operator">=</span> <span class="string">&#x27;研发部&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 8. 查询工资比灭绝高的员工信息 </span></span><br><span class="line"><span class="comment">-- 自连接 </span></span><br><span class="line"><span class="keyword">select</span> e2.<span class="operator">*</span> <span class="keyword">from</span> emp e1, emp e2</span><br><span class="line"><span class="keyword">where</span> e1.name <span class="operator">=</span> <span class="string">&#x27;灭绝&#x27;</span></span><br><span class="line"><span class="keyword">and</span> e2.salary <span class="operator">&gt;</span> e1.salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 子查询</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> (</span><br><span class="line"><span class="keyword">select</span> salary <span class="keyword">from</span> emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;灭绝&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 9. 查询比平均薪资高的员工信息 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">&gt;</span> (</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(salary) <span class="keyword">from</span> emp</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 10. 查询低于本部门平均薪资的员工 </span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, avgsal.sal <span class="keyword">from</span> emp e <span class="keyword">join</span> (</span><br><span class="line"><span class="keyword">select</span> dept_id, <span class="built_in">avg</span>(salary) sal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> dept_id) avgsal</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> avgsal.dept_id</span><br><span class="line"><span class="keyword">where</span> e.salary <span class="operator">&lt;</span> avgsal.sal;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 可以用子查询，目测效率更低因为对于每一行子查询都需要重新计算一下本部门平均薪资 </span></span><br><span class="line"><span class="comment">-- 第一步：计算本部门平均薪资：select avg(salary) from emp where dept_id = 1;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e2 <span class="keyword">where</span> e2.salary <span class="operator">&lt;</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">avg</span>(e1.salary) <span class="keyword">from</span> emp e1 <span class="keyword">where</span> e1.dept_id <span class="operator">=</span> e2.dept_id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 11. 查询所有部门信息并统计部门的员工人数 </span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(e.dept_id), d.name <span class="keyword">from</span> emp e <span class="keyword">right</span> <span class="keyword">join</span> dept d</span><br><span class="line"><span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 子查询</span></span><br><span class="line"><span class="comment">-- 第一步，计算每个部门的人数 </span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp e <span class="keyword">where</span> e.dept_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第二步，得出结果 </span></span><br><span class="line"><span class="keyword">select</span> d.id, d.name, (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp e</span><br><span class="line"><span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id) <span class="string">&#x27;人数&#x27;</span> <span class="keyword">from</span> dept d;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 12. 查询所有学生的选课情况，展示出学生名称，学号，课程名称 </span></span><br><span class="line"><span class="keyword">select</span> s.name <span class="string">&#x27;姓名&#x27;</span>, s.no <span class="string">&#x27;学号&#x27;</span>, c.name <span class="string">&#x27;课程名称&#x27;</span> <span class="keyword">from</span></span><br><span class="line">student s, course c , student_course sc</span><br><span class="line"><span class="keyword">where</span> s.id <span class="operator">=</span> sc.studentid</span><br><span class="line"><span class="keyword">and</span> sc. courseid <span class="operator">=</span> c.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student_course;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> course;</span><br></pre></td></tr></table></figure>

<p>多表查询-总结1. 多表关系多表之间的关系分为三类：    一对多：在多的一方设置外键，关联一的一方的主键    多对多：建立中间表，中间表包含两个外键，关联两张表的主键    一对一：用于表结构拆分，在其中任何一方设置外键（UNIQUE)，关联另一方的主键</p>
<blockquote>
<p>（一对一注：xx_order与xx_order_det就是这样的关系）</p>
</blockquote>
<p>2. 多表查询内连接    隐式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表A, 表B <span class="keyword">where</span> 条件....;</span><br></pre></td></tr></table></figure>

<p>    显式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表A <span class="keyword">inner</span> <span class="keyword">join</span> 表B <span class="keyword">on</span> 条件.....;</span><br></pre></td></tr></table></figure>

<p>外连接    左外：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> 表A <span class="keyword">left</span> <span class="keyword">join</span> 表B <span class="keyword">on</span> 条件...;</span><br></pre></td></tr></table></figure>

<p>    右外：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> 表A <span class="keyword">right</span> <span class="keyword">join</span> 表B <span class="keyword">on</span> 条件...;</span><br></pre></td></tr></table></figure>

<p>自连接：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表A 别名<span class="number">1</span>, 表B 别名<span class="number">2</span> <span class="keyword">where</span> 条件...;</span><br></pre></td></tr></table></figure>

<p>子查询：标量子查询，列子查询，行子查询，表子查询。<br>事务事务简介事务是一组操作的集合，它是一个不可分割的工作单位，事务会把所有操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。注意：默认MySQL的事务是自动提交的，即当执行一条DML语句，MySQL会隐式的提交事务。<br>事务操作案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 事务操作 </span></span><br><span class="line"><span class="comment">-- 数据准备 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> account (</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) comment <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    money <span class="type">int</span> comment <span class="string">&#x27;余额&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;账户表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account</span><br><span class="line"><span class="keyword">values</span> (<span class="keyword">null</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="number">2000</span>), (<span class="keyword">null</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 恢复数据 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 转账操作 </span></span><br><span class="line"><span class="comment">-- 1. 查询张三的余额 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 将张三的账户余额减去1000 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">-</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 将李四账户余额+1000</span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">+</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;</span><br></pre></td></tr></table></figure>

<p>事务操作方式一：查看&#x2F;设置事务的提交方式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@autocommit</span>;</span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@autocommit</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">-- 将提交方式改为手动</span></span><br></pre></td></tr></table></figure>

<p>提交事务</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<p>回滚事务</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rollback</span>;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @<span class="variable">@autocommit</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@autocommit</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 恢复数据 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 转账操作 </span></span><br><span class="line"><span class="comment">-- 1. 查询张三的余额 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 将张三的账户余额减去1000 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">-</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 将李四账户余额+1000</span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">+</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">rollback</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;</span><br></pre></td></tr></table></figure>

<p>事务操作方式二：开启事务</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction 或者 <span class="keyword">begin</span></span><br></pre></td></tr></table></figure>

<p>提交事务</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">commit</span></span><br></pre></td></tr></table></figure>

<p>回滚事务</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rollback</span></span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式2</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@autocommit</span>;</span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@autocommit</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span>;  <span class="comment">-- 事务开始 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. 查询张三的余额 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 将张三的账户余额减去1000 </span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">-</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 将李四账户余额+1000</span></span><br><span class="line"><span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> money <span class="operator">+</span> <span class="number">1000</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>; <span class="comment">-- 提交事务</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">rollback</span>; <span class="comment">-- 回滚事务</span></span><br></pre></td></tr></table></figure>

<p>commit 之前：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7Zg5sgVTrS8dFGHTTMKorRQuMzbdV82WCrNTP2s3I73Vy9ibK6R3GUkrw/640?wx_fmt=png">  </p>
<p>commit 之后：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Qux9pvZoXPjj649O37E9LV9icjxRloL7Z11BsvD1yWu9N0P1ryvVGOSvKRH5S0kiclqIGUiadKt2NjJWQhh2RmzIw/640?wx_fmt=png">  </p>
<p>出错了就rollback<br>事务四大特性（ACID）原子性 A - atomicity 事务是不可分割的最小操作单元，要么全部成功，要么全部失败。一致性 C - consistency 事务完成时，必须使所有数据都保持一致隔离性 I - isolation 数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境运行持久性 D - durability 事务一旦提交或回滚，它对数据库中数据的修改就是永久的<br>并发事务问题</p>
<table width="0"><colgroup><col style="width: 310px;"><col style="width: 310px;"></colgroup><tbody><tr style="height: 42px;"><td data-cell-id="9076-1646771121440-cell-0-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;background-color: rgb(223, 64, 42);text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(255, 255, 255);background-color: transparent;font-weight: bold;font-style: normal;text-decoration: none;">问题</span></p></td><td data-cell-id="9076-1646771121440-cell-0-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;background-color: rgb(223, 64, 42);text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(255, 255, 255);background-color: transparent;font-weight: bold;font-style: normal;text-decoration: none;">描述</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="9076-1646771121440-cell-1-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(194, 79, 74);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">脏读</span></p></td><td data-cell-id="9076-1646771121440-cell-1-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">一个事务读取到另一个事务未提交的数据</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="9076-1646771121440-cell-2-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(194, 79, 74);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">不可重复读</span></p></td><td data-cell-id="9076-1646771121440-cell-2-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">一个事务先后读取同一条记录，但两次读取的数据不同，称之为不可重复读</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="9076-1646771121440-cell-3-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;text-align: center;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(194, 79, 74);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">幻读</span></p></td><td data-cell-id="9076-1646771121440-cell-3-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">一个事务按照条件查询数据时，没有对应的数据行，但在插入数据时，发现这行数据已经存在了，好像出现了”幻影“。</span></p></td></tr></tbody></table>
事务隔离级别

<table width="0"><colgroup><col style="width: 155px;"><col style="width: 155px;"><col style="width: 155px;"><col style="width: 155px;"></colgroup><tbody><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-0-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">隔离级别</span></p></td><td data-cell-id="7274-1646771576710-cell-0-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">脏读</span></p></td><td data-cell-id="7274-1646771576710-cell-0-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">不可重复读</span></p></td><td data-cell-id="7274-1646771576710-cell-0-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">幻读</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-1-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">Read uncommitted</span></p></td><td data-cell-id="7274-1646771576710-cell-1-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td><td data-cell-id="7274-1646771576710-cell-1-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td><td data-cell-id="7274-1646771576710-cell-1-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-2-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">Read commiited (Oracle 默认）</span></p></td><td data-cell-id="7274-1646771576710-cell-2-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-2-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td><td data-cell-id="7274-1646771576710-cell-2-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-3-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">Repeatable Read (MySQL 默认）</span></p></td><td data-cell-id="7274-1646771576710-cell-3-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-3-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-3-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">allow</span></p></td></tr><tr style="height: 40px;"><td data-cell-id="7274-1646771576710-cell-4-0" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">Serializable</span></p></td><td data-cell-id="7274-1646771576710-cell-4-1" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-4-2" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td><td data-cell-id="7274-1646771576710-cell-4-3" style="font-size: 14px;color: rgb(57, 57, 57);border-width: 1px;border-style: solid;border-color: rgb(167, 167, 167);overflow: hidden;overflow-wrap: break-word;white-space: pre-wrap;"><p><span style="font-size: 14px;font-family: Microsoft YaHei, STXihei;color: rgb(0, 0, 0);background-color: transparent;font-weight: normal;font-style: normal;text-decoration: none;">no</span></p></td></tr></tbody></table>
查看事务隔离级别：

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @<span class="keyword">@transaction_isolation</span>;</span><br></pre></td></tr></table></figure>

<p>设置事务隔离级别：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> [session<span class="operator">|</span><span class="keyword">global</span>] transaction isolation level</span><br><span class="line">&#123;read uncommitted <span class="operator">|</span> read committed <span class="operator">|</span> repeatable read <span class="operator">|</span> serializable&#125;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 设置事务隔离级别案例 </span></span><br><span class="line"><span class="comment">-- 演示脏读 </span></span><br><span class="line"><span class="keyword">set</span> session transaction isolation level read uncommitted;</span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- id = 1, money = 2000;</span></span><br><span class="line"><span class="comment">-- 新开个session，执行</span></span><br><span class="line"># <span class="keyword">start</span> transaction</span><br><span class="line"># <span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> <span class="number">2001</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 发现数据更新了 money = 2001</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 演示不可重复读 </span></span><br><span class="line"><span class="comment">-- 在一个事务里修改隔离级别是不会起作用的 </span></span><br><span class="line"><span class="keyword">set</span> session transaction isolation level read committed;</span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 发现数据是没有更新的 money = 2000;</span></span><br><span class="line"><span class="comment">-- 新开的session里执行</span></span><br><span class="line"># <span class="keyword">commit</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 发现数据更新了 money = 2001;</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 演示可重复读 </span></span><br><span class="line"><span class="keyword">set</span> session transaction isolation level repeatable read;</span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- id = 1, money = 2001</span></span><br><span class="line"><span class="comment">-- 新开的session里执行 </span></span><br><span class="line"># being</span><br><span class="line"># <span class="keyword">update</span> account <span class="keyword">set</span> money <span class="operator">=</span> <span class="number">2005</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"># <span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 发现数据没有更新 money = 2001</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account; <span class="comment">-- 这时候在上一个事务之外，读到了 money = 2005</span></span><br><span class="line"><span class="comment">-- 演示幻读 </span></span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 这时候只读到两条数据 </span></span><br><span class="line"><span class="comment">-- 在新session里执行 </span></span><br><span class="line"># <span class="keyword">begin</span>;</span><br><span class="line"># <span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"># <span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">2000</span>);  </span><br><span class="line"><span class="comment">-- 执行失败，原因是新session读已提交 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 依然读不到 id为3的数据，称之为幻读 </span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 演示串行化 </span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> account <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">set</span> session transaction isolation level serializable;</span><br><span class="line"><span class="keyword">begin</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> account;  <span class="comment">-- 这时候只读到两条数据 </span></span><br><span class="line"><span class="comment">-- 在新开session里执行 </span></span><br><span class="line"># <span class="keyword">begin</span>;</span><br><span class="line"># <span class="keyword">insert</span> <span class="keyword">into</span> account <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"># 发现新session卡住了，不能动弹 </span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"># 发现新session里的<span class="keyword">insert</span>执行完成了。</span><br></pre></td></tr></table></figure>

<p>注意：事务隔离级别越高，数据越安全，但是效率也越低。<br>总结：1. 事务简介事务是一组操作的集合，一荣俱荣，一损俱损2. 事务操作</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction; 或者 <span class="keyword">begin</span>; <span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">commit</span><span class="operator">/</span><span class="keyword">rollback</span>; <span class="comment">-- 提交/回滚</span></span><br></pre></td></tr></table></figure>

<p>事务3. 事务四大特性原子性A、一致性C、隔离性I、持久性D4. 并发事务问题脏读、不可重复读、幻读5. 事务隔离级别read uncommitted, read committed, repeatable read, serializable<br>基础篇总结MySQL概述 - SQL -函数 - 约束 - 多表查询 - 事务</p>

        
            <div id="toc-article">
                
  <div class="widget-wrap" id="toc-wrap">
    <h3 class="widget-title"><i class="fa fa-toc"></i> Contents</h3>
    <div class="widget">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">概述</span></a></li></ol>
    </div>
  </div>


            </div>
        
        
          <blockquote id="copyright">
              <p>Original link: <a href="https://xqtony.github.io/2023/05/23/MySQL_DB_basic/">https://xqtony.github.io/2023/05/23/MySQL_DB_basic/</a></p>
              <p>Copyright Notice: 转载请注明出处.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          
    <div class="social-share">
      <span>Share:</span>
    </div>



        </div>
      
      
        
      
      
        








      
    </footer>
  </div>
</article>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> Recent</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/05/23/MySQL_DB_basic/">MySQL数据库 - 基础篇</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> Archive</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023年</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> Blogroll</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="https://www.r2coding.com/">Road 2 Coding</a>
        </li>
      
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/sitemap.xml">Site Map</a>
        <span> | </span><a href="/atom.xml">Subscribe to this site</a>
        <span> | </span><a href="/about/">Contact the blogger</a>
      </p>
      
        <p>
          <i class="fa fa-visitors"></i>
          <i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>
          ，
          <i class="fa fa-views"></i>
          <i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>
        </p>
      
      <p>
        <span>Copyright &copy; 2023 Tony Kong.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
      </p>
    </div>
  </div>
</footer>

    </div>
  </div>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/search.json.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>






  
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  
    
<script src="/localshare/js/social-share.js"></script>

    
<script src="/localshare/js/qrcode.js"></script>

  
  



  

  

  

  

  

  

  

  
  





</body>
</html>